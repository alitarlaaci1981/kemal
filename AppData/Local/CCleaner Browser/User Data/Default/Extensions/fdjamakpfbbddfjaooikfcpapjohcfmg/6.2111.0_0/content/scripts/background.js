!function(e){function t(t){for(var r,a,s=t[0],u=t[1],c=t[2],d=0,f=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);f.length;)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([399,3,2,1]),n()}([,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionCode=void 0;var r,o=n(13),i=n(108),a=n(191),s={};!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(r=t.ExceptionCode||(t.ExceptionCode={})),t.default=function(e){var t=e.funcName,n=e.fileName,u=e.code,c=e.message,l=e.type,d=e.precisions,f=e.legacy;try{if(t&&Object.prototype.hasOwnProperty.call(s,t)&&s[t]>=10)return;t&&!Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=0);var p={action:"logOnline",code:u||r.Error,exceptiontype:l||"TYPE_KW_EX_NO_TYPE",file:n,functionName:t,legacy:void 0!==f&&f,message:c,stack:d||"",type:o.default().getExtension()+"_"+i.getSimplePlatformString(),version:o.default().getBuildVersions().extension,browser:o.default().getBrowserName(),browserVersion:o.default().getBrowserVersion(),os:o.default().getOSName(),osVersion:o.default().getOSVersion()};a.post("https://kck3hlb9.dashlane.com/1/softwarelog/create").type("form").send(p).end((function(e,n){t&&++s[t]}))}catch(e){}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exceptionLog=void 0;var r,o=n(13),i=n(1),a=n(11);t.exceptionLog=function(e){return r||(r=o.default().isStandalone()?function(e){a.carbon().exceptionLog(e)}:i.default),r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessage=t.isNativeOrder=t.sendNativeOrder=t.sendWebSocketOrder=void 0;var r=n(13),o=n(56),i=n(141),a=n(1),s=n(757),u=n(23);t.sendWebSocketOrder=function(e){var t=e.order,n=e.tabId,i=void 0===n?r.default().getDefaultTabId():n;o.default().sendOrderToCpp(t,i,"fromExtensionToCpp")},t.sendNativeOrder=function(e){i.isMessagingAvailable()?i.postMessage(e):u.nativeMessagingExceptionLog({funcName:"sendNativeOrder",fileName:"runtime/send.ts",code:a.ExceptionCode.Error,message:"NativeMessaging is not available but needed for ".concat(e.body.message," from ").concat(e.from," to ").concat(e.to)})},t.isNativeOrder=function(e){return e&&e.from&&e.to&&e.subject},t.sendMessage=function(e){var t=e.order,n=e.websocketHandler,r=void 0===n?function(){}:n,o=e.nativeMessagingHandler,i=void 0===o?function(){}:o,a=e.internalHandler,u=void 0===a?function(){}:a;switch(s.getCommunicationMode()){case s.CommunicationMode.WEB_SOCKETS:r(t);break;case s.CommunicationMode.NATIVE_MESSAGING:i(t);break;case s.CommunicationMode.INTERNAL:default:u(t)}}},,,function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),a=n(2),s=function(){throw new Error("Slot not connected")};t.defaultSlotConfig={noBuffer:!1};var u=function(e){return Object.assign((function(){return s()}),{config:e,lazy:function(){return s},on:function(){return s},slotName:"Not connected"})},c=function(e,t){return Object.keys(t).reduce((function(n,r){return n.concat(t[r][e]||[])}),[])},l=function(e){return Object.keys(e).reduce((function(t,n){var r=e[n],i=Object.keys(r).filter((function(e){return(r[e]||[]).length>0})),a=[].concat(o(t),o(i));return[].concat(o(new Set(a)))}),[])};t.slot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.defaultSlotConfig;return u(e)},t.connectSlot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t.reduce((function(e,t,n){return Object.assign({},e,r({},n,{}))}),r({},"LOCAL_TRANSPORT",{})),u=t.reduce((function(e,t,n){return Object.assign({},e,r({},n,{}))}),{}),d=function(e,t){var n=function(){},r=new Promise((function(e){return n=e}));u[e][t]={registered:r,onRegister:n}},f=[],p=[],g=function(e){return f.forEach((function(t){return t(e)}))},h=function(e){return p.forEach((function(t){return t(e)}))};function m(e,r){var l=2===arguments.length,f=l?r:e,p=l?e:a.DEFAULT_PARAM;if(n.noBuffer||0===t.length){var g=c(p,s);return i.callHandlers(f,g)}t.forEach((function(e,t){u[t][p]||d(String(t),p)}));var h=t.reduce((function(e,t,n){return[].concat(o(e),[u[n][p].registered])}),[]);return Promise.all(h).then((function(){var e=c(p,s);return i.callHandlers(f,e)}))}function v(e,t){return f.push(e),p.push(t),l(s).forEach(e),function(){l(s).forEach(t);var n=f.indexOf(e);n>-1&&f.splice(n,1);var r=p.indexOf(t);r>-1&&p.splice(r,1)}}function y(n,r){var o="",i=function(){return new Promise((function(e){return e()}))};return"string"==typeof n?(o=n,i=r||i):(o=a.DEFAULT_PARAM,i=n),t.forEach((function(t){return t.registerHandler(e,o,i)})),s.LOCAL_TRANSPORT[o]=(s.LOCAL_TRANSPORT[o]||[]).concat(i),1===c(o,s).length&&g(o),function(){t.forEach((function(t){return t.unregisterHandler(e,o,i)}));var n=(s.LOCAL_TRANSPORT[o]||[]).indexOf(i);-1!==n&&s.LOCAL_TRANSPORT[o].splice(n,1),0===c(o,s).length&&h(o)}}return t.forEach((function(t,n){t.addRemoteHandlerRegistrationCallback(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.DEFAULT_PARAM,t=arguments[1],r=s[n][e]||[];s[n][e]=r.concat(t),1===c(e,s).length&&g(e),u[n][e]||d(String(n),e),u[n][e].onRegister()})),t.addRemoteHandlerUnregistrationCallback(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.DEFAULT_PARAM,t=arguments[1],r=s[n][e]||[],o=r.indexOf(t);o>-1&&s[n][e].splice(o,1),0===c(e,s).length&&h(e),d(String(n),e)}))})),Object.assign(m,{on:y,lazy:v,config:n,slotName:e})}},function(e,t,n){"use strict";function r(e,t){var n=null;try{n=e(t)}catch(e){return Promise.reject(e)}return n&&n.then?n:Promise.resolve(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.callHandlers=function(e,t){return t&&0!==t.length?1===t.length?r(t[0],e):Promise.all(t.map((function(t){return r(t,e)}))):new Promise((function(e){}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PARAM="$_DEFAULT_$"},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;o(this,e),this._timeout=t,this._onMessageCallbacks=[],this._onConnectCallbacks=[],this._onDisconnectCallbacks=[],this._onErrorCallbacks=[],this._ready=!1}return r(e,[{key:"onData",value:function(e){-1===this._onMessageCallbacks.indexOf(e)&&this._onMessageCallbacks.push(e)}},{key:"onConnect",value:function(e){this._ready&&e(),this._onConnectCallbacks.push(e)}},{key:"onDisconnect",value:function(e){this._onDisconnectCallbacks.push(e)}},{key:"onError",value:function(e){this._onErrorCallbacks.push(e)}},{key:"_messageReceived",value:function(e){this._onMessageCallbacks.forEach((function(t){return t(e)}))}},{key:"_error",value:function(e){this._onErrorCallbacks.forEach((function(t){return t(e)}))}},{key:"_connected",value:function(){this._ready=!0,this._onConnectCallbacks.forEach((function(e){return e()}))}},{key:"_disconnected",value:function(){this._ready=!1,this._onDisconnectCallbacks.forEach((function(e){return e()}))}},{key:"timeout",get:function(){return this._timeout}}]),e}();t.GenericChannel=i},function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.slot=r.slot;var o=n(6);t.combineEvents=o.combineEvents,t.createEventBus=o.createEventBus;var i=n(3);t.GenericChannel=i.GenericChannel;var a=n(8);t.ChunkedChannel=a.ChunkedChannel;var s=n(2);t.DEFAULT_PARAM=s.DEFAULT_PARAM},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(7);t.combineEvents=function(e,t,n,o,i,a,s,u,c,l,d,f,p,g,h,m,v,y,b,_,w,S,O,P){var I=Array.from(arguments),C=I.reduce((function(e,t){return[].concat(r(e),r(Object.keys(t)))}),[]),k=[].concat(r(new Set(C)));if(C.length>k.length)throw new Error("ts-event-bus: duplicate slots encountered in combineEvents.");return Object.assign.apply(Object,[{}].concat(r(I)))},t.createEventBus=function(e){var t=(e.channels||[]).map((function(e){return new i.Transport(e)}));return Object.keys(e.events).reduce((function(n,r){var i=e.events[r].config;return n[r]=o.connectSlot(r,t,i),n}),{})}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=0,a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._channel=t,this._localHandlers={},this._localHandlerRegistrations={},this._remoteHandlers={},this._remoteHandlerRegistrationCallbacks={},this._remoteHandlerDeletionCallbacks={},this._pendingRequests={},this._channelReady=!1,this._channel.onData((function(e){switch(e.type){case"request":return n._requestReceived(e);case"response":return n._responseReceived(e);case"handler_registered":return n._registerRemoteHandler(e);case"handler_unregistered":return n._unregisterRemoteHandler(e);case"error":return n._errorReceived(e);default:!function(e){throw new Error("Should not happen: "+e)}(e)}})),this._channel.onConnect((function(){n._channelReady=!0,Object.keys(n._localHandlerRegistrations).forEach((function(e){n._localHandlerRegistrations[e].forEach((function(e){n._channel.send(e)}))}))})),this._channel.onDisconnect((function(){n._channelReady=!1,n._unregisterAllRemoteHandlers(),n._rejectAllPendingRequests(new Error("REMOTE_CONNECTION_CLOSED"))})),this._channel.onError((function(e){return n._rejectAllPendingRequests(e)}))}return r(e,[{key:"_requestReceived",value:function(e){var t=this,n=e.slotName,r=e.data,i=e.id,a=e.param,s=this._localHandlers[n];if(s){var u=s[a];u&&o.callHandlers(r,u).then((function(e){return t._channel.send({type:"response",slotName:n,id:i,data:e,param:a})})).catch((function(e){return t._channel.send({id:i,message:""+e,param:a,slotName:n,stack:e.stack||"",type:"error"})}))}}},{key:"_responseReceived",value:function(e){var t=e.slotName,n=e.data,r=e.id,o=e.param,i=this._pendingRequests[t];i&&i[o]&&i[o][r]&&(i[o][r].resolve(n),delete i[o][r])}},{key:"_errorReceived",value:function(e){var t=e.slotName,n=e.id,r=e.message,o=e.stack,i=e.param,a=this._pendingRequests[t];if(a&&a[i]&&a[i][n]){var s=new Error(r+" on "+t+" with param "+i);s.stack=o||s.stack,this._pendingRequests[t][i][n].reject(s),delete this._pendingRequests[t][i][n]}}},{key:"_registerRemoteHandler",value:function(e){var t=this,n=e.slotName,r=e.param,o=this._remoteHandlerRegistrationCallbacks[n];if(o){var a=this._remoteHandlers[n];if(!a||!a[r]){var s=function(e){return new Promise((function(o,a){if(!t._channelReady)return a(new Error("CHANNEL_NOT_READY on "+n));var s=""+i++;t._pendingRequests[n]=t._pendingRequests[n]||{},t._pendingRequests[n][r]=t._pendingRequests[n][r]||{},t._pendingRequests[n][r][s]={resolve:o,reject:a},t._channel.send({type:"request",id:s,slotName:n,param:r,data:e}),setTimeout((function(){var e=((t._pendingRequests[n]||{})[r]||{})[s];if(e){var o=new Error("TIMED_OUT on "+n+" with param "+r);e.reject(o),delete t._pendingRequests[n][r][s]}}),t._channel.timeout)}))};this._remoteHandlers[n]=this._remoteHandlers[n]||{},this._remoteHandlers[n][r]=s,o(r,s)}}}},{key:"_unregisterRemoteHandler",value:function(e){var t=e.slotName,n=e.param,r=this._remoteHandlerDeletionCallbacks[t],o=this._remoteHandlers[t];if(o){var i=o[n];i&&r&&(r(n,i),delete this._remoteHandlers[t][n])}}},{key:"_unregisterAllRemoteHandlers",value:function(){var e=this;Object.keys(this._remoteHandlerDeletionCallbacks).forEach((function(t){var n=e._remoteHandlers[t];n&&Object.keys(n).filter((function(e){return n[e]})).forEach((function(n){return e._unregisterRemoteHandler({slotName:t,param:n})}))}))}},{key:"_rejectAllPendingRequests",value:function(e){var t=this;Object.keys(this._pendingRequests).forEach((function(n){Object.keys(t._pendingRequests[n]).forEach((function(r){Object.keys(t._pendingRequests[n][r]).forEach((function(o){t._pendingRequests[n][r][o].reject(e)}))})),t._pendingRequests[n]={}}))}},{key:"addRemoteHandlerRegistrationCallback",value:function(e,t){this._remoteHandlerRegistrationCallbacks[e]||(this._remoteHandlerRegistrationCallbacks[e]=t)}},{key:"addRemoteHandlerUnregistrationCallback",value:function(e,t){this._remoteHandlerDeletionCallbacks[e]||(this._remoteHandlerDeletionCallbacks[e]=t)}},{key:"registerHandler",value:function(e,t,n){if(this._localHandlers[e]=this._localHandlers[e]||{},this._localHandlers[e][t]=this._localHandlers[e][t]||[],this._localHandlers[e][t].push(n),1===this._localHandlers[e][t].length){var r={type:"handler_registered",param:t,slotName:e};this._localHandlerRegistrations[t]=this._localHandlerRegistrations[t]||[],this._localHandlerRegistrations[t].push(r),this._channelReady&&this._channel.send(r)}}},{key:"unregisterHandler",value:function(e,t,n){var r=this._localHandlers[e];if(r&&r[t]){var o=r[t].indexOf(n);if(o>-1&&(r[t].splice(o,1),0===r[t].length)){var i={type:"handler_unregistered",param:t,slotName:e};this._channelReady&&this._channel.send(i)}}}}]),e}();t.Transport=a},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(9),s=function(e){if(!e.chunkId)throw new Error("ChunkedMessage did not have a chunkId: "+JSON.stringify(e))},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.timeout));return n._buffer={},n._chunkSize=e.chunkSize,n._sender=e.sender,n._maxStringAlloc=e.maxStringAlloc||-1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"send",value:function(e){var t=this,n=JSON.stringify(e);if(n.length<=this._chunkSize)this._sender(e);else{var r=function(e){for(var t=new Uint16Array(e.length),n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t}(n),o=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array(30))).map((function(){return Math.random().toString(36)[3]})).join("");this._sender({type:"chunk_start",chunkId:o,size:n.length}),!function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=r.slice(n,n+t._chunkSize);i.length&&(t._sender({type:"chunk_data",chunkId:o,data:Array.from(i)}),e(n+t._chunkSize))}(),this._sender({type:"chunk_end",chunkId:o})}}},{key:"_messageReceived",value:function(e){switch(e.type){case"chunk_start":this._receiveNewChunk(e);break;case"chunk_data":this._receiveChunkData(e);break;case"chunk_end":var n=this._mergeChunks(e);o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_messageReceived",this).call(this,n);break;default:o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_messageReceived",this).call(this,e)}}},{key:"_receiveNewChunk",value:function(e){if(s(e),this._buffer[e.chunkId])throw new Error("There was already an entry in the buffer for chunkId "+e.chunkId);this._buffer[e.chunkId]={id:e.chunkId,chunks:[],size:e.size}}},{key:"_receiveChunkData",value:function(e){if(s(e),!this._buffer[e.chunkId])throw new Error("ChunkId "+e.chunkId+" was not found in the buffer");this._buffer[e.chunkId].chunks.push(e.data)}},{key:"_mergeChunks",value:function(e){if(s(e),!this._buffer[e.chunkId])throw new Error("ChunkId "+e.chunkId+" was not found in the buffer");var t=this._buffer[e.chunkId].chunks.reduce((function(e,t,n){return t.forEach((function(t,n){return e.uintArray[e.currentIx+n]=t})),e.currentIx+=t.length,e}),{uintArray:new Uint16Array(this._buffer[e.chunkId].size),currentIx:0}),n=void 0,r=function(e,t){if(-1===t)return String.fromCharCode.apply(null,e);for(var n="",r=0;r<e.length;r+=t)r+t>e.length?n+=String.fromCharCode.apply(null,e.subarray(r)):n+=String.fromCharCode.apply(null,e.subarray(r,r+t));return n}(t.uintArray,this._maxStringAlloc);try{n=JSON.parse(r)}catch(e){throw new Error("Not a valid JSON string: "+r)}if(!a.isTransportMessage(n))throw new Error("Not a transport message: "+JSON.stringify(n));return n}}]),t}(i.GenericChannel);t.ChunkedChannel=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransportMessage=function(e){switch(e.type){case"request":case"response":case"error":case"handler_unregistered":case"handler_registered":return!0;default:return!1}}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDebugConnectorInstance=t.setPopupChannel=t.setLeelooWs=t.isMfaOrder=t.sendOrderToMaverick=t.setMaverickInstance=t.maverick=t.setCarbonInstance=t.extensionCarbonConnector=t.carbon=t.init=t.DebugWS=void 0;var r=n(626);Object.defineProperty(t,"init",{enumerable:!0,get:function(){return r.init}}),Object.defineProperty(t,"setLeelooWs",{enumerable:!0,get:function(){return r.setLeelooWs}}),Object.defineProperty(t,"setPopupChannel",{enumerable:!0,get:function(){return r.setPopupChannel}});var o=n(95);t.carbon=o.default,Object.defineProperty(t,"setCarbonInstance",{enumerable:!0,get:function(){return o.setInstance}});var i=n(285);t.maverick=i.default,Object.defineProperty(t,"isMfaOrder",{enumerable:!0,get:function(){return i.isMfaOrder}}),Object.defineProperty(t,"sendOrderToMaverick",{enumerable:!0,get:function(){return i.sendOrderToMaverick}}),Object.defineProperty(t,"setMaverickInstance",{enumerable:!0,get:function(){return i.setInstance}});var a=n(211);Object.defineProperty(t,"setDebugConnectorInstance",{enumerable:!0,get:function(){return a.setInstance}});var s=n(326);Object.defineProperty(t,"extensionCarbonConnector",{enumerable:!0,get:function(){return s.extensionCarbonConnector}});var u=n(877);Object.defineProperty(t,"DebugWS",{enumerable:!0,get:function(){return u.DebugWS}})},,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.Config=t.exceptionsToWatch=t.ApplicationType=void 0;var o=n(35),i=n(618);!function(e){e.Native="native",e.Standalone="standalone"}(t.ApplicationType||(t.ApplicationType={}));var a={},s={mfa:!1};t.exceptionsToWatch=i.intrusiveException;var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._standaloneStorageValue=null,this._marshmallowStorageValue=!1,this._extensionFeatures={},this._pluginFeatures={}}var t,n,i;return t=e,(n=[{key:"isStandalone",value:function(){if(this.currentBrowserOnlySupportsStandaloneMode())return!0;var e=this._standaloneStorageValue;if("boolean"==typeof e)return e;var t=o.getSyncStorageInstance().get("cppTalked"),n=o.getSyncStorageInstance().get("installerId");return!(!0===t||n)&&this.isStandaloneByDefault()}},{key:"currentBrowserOnlySupportsStandaloneMode",value:function(){return this.isEdge()||this.isLinux()||this.isChromebook()}},{key:"isStandaloneByDefault",value:function(){return this.isChrome()||this.isFirefoxWebExt()}},{key:"getExtensionFeatures",value:function(){return Object.assign(Object.assign({},a),this._extensionFeatures)}},{key:"setPluginFeatures",value:function(e){this._pluginFeatures=e}},{key:"getPluginFeatures",value:function(){return Object.assign(Object.assign({},s),this._pluginFeatures)}},{key:"getLoggingConfig",value:function(){return Object({asapEvents:!1})}},{key:"isDebug",value:function(){return!1}},{key:"isAlertExceptionEnabled",value:function(){return!1}},{key:"isChrome",value:function(){return"CHROME"===this.getBrowser()}},{key:"isFirefoxWebExt",value:function(){return"FIREFOX"===this.getBrowser()}},{key:"isEdge",value:function(){return"EDGE"===this.getBrowser()}},{key:"isLinux",value:function(){return Boolean(/\bLinux\b/.exec(navigator.userAgent))}},{key:"isChromebook",value:function(){return Boolean(/\bCrOS\b/.exec(navigator.userAgent))}},{key:"getSupportedLanguages",value:function(){return Object({en:!0,fr:!0,es:!0,ja:!0,de:!0,pt:!0,it:!0,ko:!0,zh:!0,nl:!0,sv:!0})}},{key:"getLatestCapabilitiesVersion",value:function(){return 5}},{key:"getPlatform",value:function(){return"extension"}},{key:"loggingEnabled",value:function(){return this.isDebug()||this.loggingEnabledThroughSettings()}},{key:"getDefaultTabId",value:function(){return-1}}])&&r(t.prototype,n),i&&r(t,i),e}();t.Config=u;var c=void 0;function l(){if(!c)throw"GetInstance of Config is called but instance is not initialized";return c}t.setInstance=function(e){c=e},t.getInstance=l,t.default=l},,,,,,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.TabsController=void 0;var i=n(56),a=n(13),s=n(30),u=n(139),c=n(212),l=n(6),d=n(1),f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registeredTabs=[]}var t,n,l;return t=e,(n=[{key:"getAllTabs",value:function(){return this.registeredTabs}},{key:"registerTab",value:function(e){if(this.registeredTabs.some((function(t){return t.tabId===e.tabId})))throw new Error("Trying to create a tabId for ".concat(e.tabId,", but already have one"));this.registeredTabs.push(e)}},{key:"unregisterTab",value:function(e){var t=this.registeredTabs.indexOf(e);t>-1&&this.registeredTabs.splice(t,1)}},{key:"closeAll",value:function(e){for(;this.registeredTabs.length>0;)this.registeredTabs[0].close(e)}},{key:"hideAllWebUIs",value:function(){for(var e=0;e<this.registeredTabs.length;e++)this.registeredTabs[e].forceHideWebUI()}},{key:"previousSelectedTabBecomeInactive",value:function(e){for(var t=0;t<this.registeredTabs.length;t++)this.registeredTabs[t].tabId!==e.tabId&&this.registeredTabs[t].unselected()}},{key:"newSelectedTabBecomeActive",value:function(e){e.selected()}},{key:"getControllerById",value:function(e){var t=this.registeredTabs.filter((function(t){return t.tabId===e}));return t.length>0?t[0]:null}},{key:"catchMessageFromCpp",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,l,d,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="string"==typeof(e=e||-1)?parseInt(e,10):e,o="string"==typeof t?c.treatMessage(t):t,"string"!=typeof t||!t.startsWith("action=testXPathListForBasket")){n.next=8;break}return s.Logger.getInstance().log("Dropping ordes testXPathListForBasket",1),l={action:"signalXPathListForBasket",meaningPageId:JSON.parse(o.content).MeaningPageId},i.getInstance().sendOrderToCpp(l,r),n.abrupt("return");case 8:if(r!==a.default().getDefaultTabId()){n.next=11;break}return u.dispatch(o,r),n.abrupt("return");case 11:if(!(d=this.getControllerById(r))){n.next=15;break}return u.dispatch(o,d.tabId),n.abrupt("return");case 15:if("changeLangage"!==o.action&&"signalAuthStatus"!==o.action&&"httpServerInfoResponse"!==o.action){n.next=25;break}return s.Logger.getInstance().log("KWTabsController.catchMessageFromCpp (tabId: "+r+"): tabController not found, message delivered to first tab",3),n.next=19,this.getCurrentTabController();case 19:if(!(f=n.sent)){n.next=23;break}return u.dispatch(o,f.tabId),n.abrupt("return");case 23:return s.Logger.getInstance().log("KWTabsController.catchMessageFromCpp (tabId: "+r+"): no tabController! [2]",1),n.abrupt("return");case 25:s.Logger.getInstance().log("KWTabsController.catchMessageFromCpp (tabId: "+r+"): tabController not found, message not delivered",3);case 26:case"end":return n.stop()}}),n,this)})))}}])&&r(t.prototype,n),l&&r(t,l),e}();t.TabsController=f;var p=null;function g(){if(!p)throw l.exceptionLog({code:d.ExceptionCode.Error,fileName:"common/background/tabs/index",funcName:"getInstance",message:"getInstance is called but instance is not initialized"}),"getInstance is called but instance is not initialized";return p}t.setInstance=function(e){p=e},t.getInstance=g,t.default=g},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseOrderSubject=t.BaseOrderTarget=void 0,function(e){e.UNSPECIFIED="Unspecified",e.BROADCAST="Broadcast",e.BACKGROUND="Background",e.INJECTED="Injected",e.LEELOO="Leeloo",e.PLUGIN="Plugin",e.POPUP="Popover",e.WEB_ANALYSIS="WebAnalysis",e.CARBON="Carbon"}(t.BaseOrderTarget||(t.BaseOrderTarget={})),function(e){e.MFA_RESPONSE="mfaResponse",e.POPOVER_REQUEST="popoverRequest",e.POPOVER_RESPONSE="popoverResponse",e.STATE_RESPONSE="stateResponse",e.LOGIN="login",e.SHARED_SESSION="sharedSession",e.REGISTER="register",e.LOGOUT="logout",e.COMMUNICATION="communication"}(t.BaseOrderSubject||(t.BaseOrderSubject={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeOrderMessage=void 0,function(e){e.OpenApplication="openApplication",e.LoginRequest="loginRequest",e.SharedSessionRequest="sharedSessionRequest",e.RegisterRequest="registerRequest",e.LogoutRequest="logoutRequest",e.LogoutResponse="logoutResponse",e.CommunicationInitResponse="communicationInitResponse",e.CommunicationPingRequest="communicationPingRequest",e.ChangeDashlaneSettings="changeDashlaneSettings",e.GetInitialData="getInitialData",e.SaveGeneratedPassword="saveGeneratedPassword",e.FillPassword="fillPassword",e.AutoLoginPassword="autoLoginPassword",e.GeneratePassword="generatePassword",e.SavePasswordGeneratorOptions="savePasswordGeneratorOptions",e.GetUserMessages="getUserMessages",e.GetWebsiteInfo="getWebsiteInfo",e.SendUsageLog="sendUsageLog",e.OpenSession="openSession"}(t.RuntimeOrderMessage||(t.RuntimeOrderMessage={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nativeMessagingExceptionLog=t.sendLogError=t.sendLog=t.LogMessage=t.stringifyOrder=void 0;var r=n(30),o=n(6);t.stringifyOrder=function(e){var t="{";for(var n in e)if("id"===n)t+='"'+n+'":'+e[n]+",";else if("message"===n){t+='"'+n+'":"'+e[n].replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\f/g,"\\f")+'"'}else t+='"'+n+'":"'+e[n]+'",';return t+="}"},function(e){e.CREATE_MESSAGE="Creating native messaging communication port",e.NOT_SUPPORTED="Native messaging is not supported"}(t.LogMessage||(t.LogMessage={})),t.sendLog=function(e){var t=e.message,n=e.level;r.Logger.getInstance().log(t,n,"CppToExtension")},t.sendLogError=function(e){var t=e.label,n=e.error,o=e.level;r.Logger.getInstance().logError(t,n,o,"CppToExtension")},t.nativeMessagingExceptionLog=function(e){var t="string"==typeof e.precisions?e.precisions:JSON.stringify(Object.assign(Object.assign({},e.precisions),{subType:"NativeMessaging"}));o.exceptionLog(Object.assign(Object.assign({},e),{precisions:t}))}},,,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.Controller=t.emptyData=void 0;var a=n(193),s=n(40),u=n(50),c=n(13),l=n(30),d=n(56),f=n(35),p=n(194),g=n(19),h=n(11),m=n(140),v=n(6),y=n(196),b=n(108),_=n(197),w=n(198),S=n(313),O=n(312),P=n(1),I=n(310),C=n(308),k=n(112),E=n(789),R=n(143),T=n(792),x=n(144);t.emptyData=function(){return{authCategories:[],authentifiants:[],accountFeatures:{},spaces:[],generatePassword:!1,websites:[],isStandalone:c.default().isStandalone(),generator:{length:12,digits:!0,letters:!0,symbols:!0,avoidAmbiguous:!0}}};var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userLoggedIn=!1,this.localAccountsList=[],this.authUsers=[],this.userLogin="",this.lastLogin="",this.waitForInitSocket=!0,this._userData=t.emptyData(),this._data=t.emptyData(),this._premiumStatus=null,this._installTimestamp=null,this._accountCreationBadgeTimeout=864e5,this._hasAccountCreationBadgeBeenSet=!1,this._isAccountCreationBadgeShowing=!1,this._initialData=null,this.migrationAlertController=new E.MigrationAlertController,this.migrationSwitchAlertController=new T.MigrationSwitchAlertController,this._subscriptionCode=null,this.markTryAutofillOnboardingStepComplete=function(){h.carbon().updateWebOnboardingMode({completedSteps:{tryAutofillOnWeb:!0}})}}var n,L,M;return n=e,(L=[{key:"init",value:function(e){return p.getAnonymousApplicationId()||p.setAnonymousApplicationId(a.v4()),Promise.resolve()}},{key:"setInitialData",value:function(e){this._initialData=e}},{key:"getInitialData",value:function(){return this._initialData}},{key:"setSubscriptionCode",value:function(e){this._subscriptionCode=e}},{key:"getSubscriptionCode",value:function(){return this._subscriptionCode}},{key:"setPremiumStatus",value:function(e){this._premiumStatus=e,this.postMessageToPopover(u.ExtensionPopupActions.PremiumStatusChanged,{premiumStatus:e})}},{key:"closePopup",value:function(){this.postMessageToPopover(u.ExtensionPopupActions.Close)}},{key:"getPremiumStatus",value:function(){return this._premiumStatus}},{key:"hasLocalAccountData",value:function(e){return Boolean(this.localAccountsList.find((function(t){return t.login===e})))}},{key:"getIsCurrentUser",value:function(){var e=Boolean(this.localAccountsList&&this.localAccountsList.length);return this.userLoggedIn||e}},{key:"getIsUserLoggedIn",value:function(e){return e===this.userLogin}},{key:"getShouldUserSeeAccountCreationBadge",value:function(){return!(this.getIsCurrentUser()||this._hasAccountCreationBadgeBeenSet||!this._installTimestamp||!(Date.now()-this._installTimestamp>this._accountCreationBadgeTimeout))}},{key:"getReferralUrl",value:function(){var e="".concat("https://www.dashlane.com","/referral"),t=this.getSubscriptionCode(),n=e;return t&&(n+="?subCode=".concat(t)),n}},{key:"getChurnedDiscountUrl",value:function(){var e=this.getSubscriptionCode();return"".concat("https://www.dashlane.com/getpremium?subCode=").concat(e,"&coupon=").concat("3SVM8YNI0F2B")}},{key:"initExternalModules",value:function(){return h.init(this.getPasswordChangeEnvironmentFactory())}},{key:"initErrorHandler",value:function(){_.getWindow().onerror=function(e,t,n,r,o){v.exceptionLog({funcName:"",fileName:"".concat(t,":").concat(n,":").concat(r),code:P.ExceptionCode.Error,message:e,precisions:o.stack?JSON.stringify(o.stack):void 0})}}},{key:"socketWorking",value:function(){f.getSyncStorageInstance().set("cppTalked",!0),this.waitForInitSocket?this.waitForInitSocket=!1:d.getInstance().useWebSockets()&&this.reinit()}},{key:"socketClosed",value:function(){d.getInstance().useWebSockets()&&!this.waitForInitSocket&&(this.uninit(!0),d.getInstance().msgId=0)}},{key:"setAccountData",value:function(e){var t={};e.credentials.forEach((function(e){t[e.Title]||(t[e.Title]=[]),t[e.Title].push(e)})),this._data.authCategories=e.credentialCategories,this._data.authentifiants=Object.keys(t).map((function(e){return{Authentifiants:t[e],Domain:e}})),this.postMessageToPopover(u.ExtensionPopupActions.PopoverV2SignalDataRefresh,{data:this._data}),k.performanceMethods.measure("Parsing credentials data from Carbon and saving them in the background",k.PerformanceMarker.RECEIVED_CARBON_DATA)}},{key:"getAccountFeatures",value:function(){return this._data.accountFeatures}},{key:"setAccountFeatures",value:function(e){this._data.accountFeatures=e?e.list:{}}},{key:"setLocalAccountsList",value:function(e){e.localAccounts.length>0&&(this.localAccountsList=e.localAccounts,this.updateToolbarButtonStyle({userLoggedIn:this.userLoggedIn}))}},{key:"setUserSpaces",value:function(e){this._data.spaces=e.map((function(e){var t=e.color,n=e.letter,r=e.info,o=e.teamId,i=e.isSSOUser,a=e.status;return{identifier:o,displayName:r.name,color:t,letter:n,isSSOUser:i,status:a}}))}},{key:"getUserData",value:function(){return{accountFeatures:this.getAccountFeatures(),authCategories:this._data.authCategories,authentifiants:this._data.authentifiants,generatePassword:!1,generator:this._data.generator,isStandalone:c.default().isStandalone(),spaces:this._data.spaces,websites:[]}}},{key:"getFeatureToggle",value:function(e){return Boolean(this.getAccountFeatures()[e])}},{key:"getSwitchToMlEngineFeatureToggle",value:function(){return this.getFeatureToggle("WA-useMarshmallow")||this.getFeatureToggle("autofill-saex-try-ML")}},{key:"clearData",value:function(){this._initialData=null,this._data=t.emptyData()}},{key:"uninit",value:function(e){l.Logger.getInstance().log("KWController.uninit()",3),this.treatAuthStatus(!1,"",""),g.default().hideAllWebUIs(),g.default().closeAll(!0),e||d.getInstance().sendOrderToCpp({action:"event",eventType:"UNINIT"},c.default().getDefaultTabId(),"fromExtensionToCpp")}},{key:"sendVersionInstallerLog",value:function(){Promise.all([this._sendUpdatedVersionInstallerLog(),this._sendLaunchInstallerLog()])}},{key:"sendAccountCreationBadgeInstallerLog",value:function(e){y.sendInstallerLog({step:"72",precisions:Object.assign({type:"badge",type_sub:"reactivation",userid:null},e)})}},{key:"deleteCookiesForOnboarding",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.removeCookiesForDomain(e);case 2:n=this.getWebOnboardingMode(),r=n&&n.flowSaveCredentialOnWeb,o=n&&n.flowLoginCredentialOnWeb,this.sendUsageLog({type:"onboarding",subtype:"clearCookies",action:r?"savePassword":o?"autologin":"",website:e.domain});case 6:case"end":return t.stop()}}),t,this)})))}},{key:"treatAuthStatus",value:function(e,t,n){var r=this.userLoggedIn!==e||this.userLogin!==t,o=!this.userLoggedIn&&e,i=!e;this.onAuthStatusChange(e),o?(k.performanceMethods.measure("Waiting for Carbon Login confirmation",k.PerformanceMarker.POPUP_LOGIN_REQUEST),k.performanceMethods.mark(k.PerformanceMarker.RECEIVED_CARBON_LOGIN_CONFIRMATION),x.default.reset(),I.getInitialData()):i&&(this.closePopup(),this.closeAllLeelooTabs(),g.default().hideAllWebUIs(),this.clearData(),this.clean(),this.migrationAlertController.reset(),c.default().isStandalone()&&this.reloadRuntime()),r&&(c.default().getPluginFeatures().mfa&&m.getMaverickBackendInstance().loginStatusChanged({loggedIn:e,login:t}),this.userLoggedIn=e,this.userLogin=t,this.lastLogin=n,this.updateToolbarButtonStyle({userLoggedIn:this.userLoggedIn}),this.sendLoginListToPopover())}},{key:"changeLanguage",value:function(){}},{key:"askForInitialData",value:function(){I.getInitialData()}},{key:"requestLogin",value:function(e){this.userLoggedIn||O.requestLogin(e)}},{key:"requestLogout",value:function(){S.requestLogout()}},{key:"autologinOnWebsite",value:function(e){this.openNewTabWithUrl(e)}},{key:"openApplication",value:function(e){w.openApplication(e)}},{key:"setUserData",value:function(e){this._userData=e,this._userDataChanged()}},{key:"_userDataChanged",value:function(){this.postMessageToPopover(u.ExtensionPopupActions.UserDataChanged,{data:this._userData})}},{key:"_getDiagnosisMetadata",value:function(){var e=this,t={cppTalked:f.getSyncStorageInstance().get("cppTalked"),firstInstallVersion:f.getSyncStorageInstance().get("firstInstallVersion"),kwCurrentVersion:f.getSyncStorageInstance().get("kwCurrentVersion"),installerId:f.getSyncStorageInstance().get("installerId"),web_InstallerId:f.getSyncStorageInstance().get("web_installerId"),anonymousApplicationId:f.getSyncStorageInstance().get("anonymousApplicationId")};return f.getAsyncStorageInstance().get("options.standalone").then((function(n){return{extension:{build:c.default().getBuildVersions().extension,mode:c.default().isStandalone()?"standalone":"desktop"},environment:{browser:c.default().getBrowser(),browserLanguage:b.getBrowserLanguage(),fullPlatform:b.getFullPlatformDetails()},communication:{useWebSockets:d.getInstance().useWebSockets(),mfa:c.default().getPluginFeatures().mfa},user:{localAccounts:e.localAccountsList,userLoggedIn:e.userLoggedIn,userLogin:e.userLogin,lastLogin:e.lastLogin},storage:Object.assign({},t,{"options.standalone":n})}}))}},{key:"allowInjectedScriptExecution",value:function(e){var t=g.default().getControllerById(e);t&&t.allowInjectedScriptExecution()}},{key:"triggerUserMessages",value:function(){C.getUserMessages()}},{key:"dismissUserMessage",value:function(e){var t=this.getUserMessageKey(e);f.getSyncStorageInstance().set(t,!0)}},{key:"isUserMessageDismissed",value:function(e){var t=this.getUserMessageKey(e);return Boolean(f.getSyncStorageInstance().get(t))}},{key:"sendUsageLog",value:function(e){if(c.default().isStandalone()){var t={type:e.type,subtype:e.subtype,action:e.action,subaction:e.subaction,website:e.website};h.carbon().usageLog({code:s.UsageLogCode.USAGE_BACKGROUND,content:t})}}},{key:"_checkExtensionModeSwitch",value:function(e){var t=this;return f.getAsyncStorageInstance().get("hasSwitchedExtensionMode").then((function(n){return e||!0===n?t.sendInstallerLog64({isFreshInstall:e,isStandalone:c.default().isStandalone()}):Promise.resolve()})).catch((function(n){return t.sendInstallerLog64({isFreshInstall:e,isStandalone:c.default().isStandalone(),error:"error_retrieving_has_switched_extension_mode"})}))}},{key:"getExtensionSwitchModeForUrls",value:function(e){var t=this;return c.default().isStandalone()&&!c.default().currentBrowserOnlySupportsStandaloneMode()&&e.some((function(e){return t._shouldSwitchToDesktop(e)}))?"desktop":null}},{key:"getStoredCurrentVersion",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="kwCurrentVersion",e.next=3,f.getAsyncStorageInstance().get(t);case 3:return n=e.sent,e.abrupt("return",null!=n?n:f.getSyncStorageInstance().get(t));case 5:case"end":return e.stop()}}),e)})))}},{key:"isFreshInstall",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getStoredCurrentVersion();case 2:return t=e.sent,e.abrupt("return",null==t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"isUpdatedVersion",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getStoredCurrentVersion();case 2:return t=e.sent,e.abrupt("return",t!==c.default().getBuildVersions().extension);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"storeExtensionVersion",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.default().getBuildVersions().extension,e&&f.getSyncStorageInstance().set("firstInstallVersion",n),t.next=4,f.getAsyncStorageInstance().set("kwCurrentVersion",n);case 4:case"end":return t.stop()}}),t)})))}},{key:"getVersionInfo",value:function(){return{versions:c.default().getBuildVersions(),mode:c.default().isStandalone()?"Standalone":c.default().getPluginFeatures().mfa?"Desktop MFA":"Desktop Legacy",browser:{name:c.default().getBrowserName(),version:c.default().getBrowserVersion()}}}},{key:"getMarshmallowInfo",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.default().getMarshmallowStorageInfo();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{key:"reportOptionsException",value:function(e,t){v.exceptionLog({code:P.ExceptionCode.Error,fileName:"options.js",funcName:t,message:e})}},{key:"isMarshmallowEnabled",value:function(){var e=this.getSwitchToMlEngineFeatureToggle();return c.default().getMarshmallowStorageInfo().then((function(t){return e&&t}))}},{key:"switchToMlAnalysisEngine",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.getAsyncStorageInstance().set("options.marshmallow",!0));case 2:case"end":return e.stop()}}),e)})))}},{key:"sendIsUserUsingMlEngineToPopover",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isMarshmallowEnabled();case 2:t=e.sent,this.postMessageToPopover(u.ExtensionPopupActions.IsUserUsingMlEngine,{data:t});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleTryAutofillOnboardingStep",value:function(e){var t,n=this.getWebOnboardingMode();e&&!(null===(t=null==n?void 0:n.completedSteps)||void 0===t?void 0:t.tryAutofillOnWeb)&&(null==n?void 0:n.flowTryAutofillOnWeb)&&this.isTryAutofillDemoPage(e)&&this.markTryAutofillOnboardingStepComplete()}},{key:"storeInstallTimestamp",value:function(){if(c.default().isStandalone()){var e=f.getSyncStorageInstance().get("installStartDate");if(e)this._installTimestamp=parseInt(e,10);else{var t=Date.now();f.getSyncStorageInstance().set("installStartDate",t),this._installTimestamp=t}}}},{key:"cacheAccountCreationBadgeSet",value:function(){if(c.default().isStandalone()){var e=f.getSyncStorageInstance().get("hasAccountCreationBadgeBeenSet");this._hasAccountCreationBadgeBeenSet=Boolean(e)}}},{key:"getPayload",value:function(e){return e.action,i(e,["action"])}},{key:"sendInstallerLog64",value:function(e){var t=e.isFreshInstall,n=e.isStandalone,r=e.error;return y.sendInstallerLog({step:"64",precisions:{action:n?"standalone":"desktop",firstTime:t,error:r}})}},{key:"_isCurrentUrlMatchingDashlanePage",value:function(e,t){return null!==new RegExp("https://(www.)?dashlane\\.com/([\\w-]+/)?".concat(t)).exec(e)}},{key:"_shouldSwitchToDesktop",value:function(e){var t=this;return!!e&&("true"!==R.getUrlQueryParam(e,"desktopmigration")&&["gettingstarted","chrome_cws_manage","gettingstarted-cws-install","firefox-manage","firefox-install"].some((function(n){return t._isCurrentUrlMatchingDashlanePage(e,n)})))}},{key:"isTryAutofillDemoPage",value:function(e){return this._isCurrentUrlMatchingDashlanePage(e,"try-autofill-demo")}},{key:"getUserMessageKey",value:function(e){var t=this.userLogin;return"".concat(t,":").concat(e)}},{key:"_sendLaunchInstallerLog",value:function(){var e={CHROME:"24.2.81",FIREFOX:"24.2.82",EDGE:"24.2.86",LEGACY_EDGE:"24.2.86",MOCK_BROWSER:"MOCK_BROWSER_INSTALLER_LOG"}[c.default().getBrowser()];return y.sendInstallerLog({step:e})}},{key:"_sendUpdatedVersionInstallerLog",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isUpdatedVersion();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return t={CHROME:"24.91",FIREFOX:"24.92",EDGE:"24.94",LEGACY_EDGE:"24.94",MOCK_BROWSER:""}[c.default().getBrowser()],e.abrupt("return",y.sendInstallerLog({step:t}));case 8:case"end":return e.stop()}}),e,this)})))}}])&&r(n.prototype,L),M&&r(n,M),e}();t.Controller=L;var M=void 0;function A(){if(!M)throw v.exceptionLog({code:P.ExceptionCode.Error,fileName:"common/background/controller/Controller.ts",funcName:"getInstance",message:"GetInstance is called but instance is not initialized"}),"GetInstance is called but instance is not initialized";return M}t.setInstance=function(e){M=e,_.getWindow().backgroundController=M},t.getInstance=A,t.default=A},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoLookupType=void 0,function(e){e.LoginRequest="loginPackage.LoginRequest",e.LoginResponse="loginPackage.LoginResponse",e.LogoutResponse="logoutPackage.LogoutResponse",e.LogoutRequest="logoutPackage.LogoutRequest",e.OpenApplication="openApplicationPackage.OpenApplication",e.RegisterRequest="registerPackage.RegisterRequest",e.RegisterResponse="registerPackage.RegisterResponse",e.SharedSessionRequest="sharedSessionPackage.SharedSessionRequest",e.SharedSessionResponse="sharedSessionPackage.SharedSessionResponse",e.CommunicationInitRequest="communicationInitPackage.CommunicationInitRequest",e.CommunicationInitResponse="communicationInitPackage.CommunicationInitResponse",e.CommunicationPingRequest="communicationPingPackage.CommunicationPingRequest",e.CommunicationPingResponse="communicationPingPackage.CommunicationPingResponse",e.ErrorResponse="errorPackage.ErrorResponse"}(t.ProtoLookupType||(t.ProtoLookupType={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.InstallerLog=void 0;var r=n(286);t.InstallerLog=r;var o=n(110);t.Logger=o},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAsyncStorageInstance=t.setAsyncStorageInstance=t.LocalStorage=t.getSyncStorageInstance=t.setSyncStorageInstance=void 0;var r=void 0;t.setSyncStorageInstance=function(e){r=e},t.getSyncStorageInstance=function(){if(!r)throw"getSyncStorageInstance is called but instance is not initialized";return r};var o={get:function(e){var t,n=localStorage.getItem(e);if(null===n)return null;try{t=JSON.parse(n)}catch(e){return"string"==typeof n?n:null}return t},set:function(e,t){null==t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t))},getRaw:function(e){return localStorage.getItem(e)},setRaw:function(e,t){localStorage.setItem(e,t)},deleteRaw:function(e){localStorage.removeItem(e)}};t.LocalStorage=o;var i=void 0;t.setAsyncStorageInstance=function(e){i=e},t.getAsyncStorageInstance=function(){if(!i)throw"getAsyncStorageInstance is called but instance is not initialized";return i}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyOrderMessage=void 0,function(e){e.AskForOpenApplication="popover_v2_askForOpenApplication",e.AskForActionOnObject="popover_v2_askForActionOnObject",e.AskLogout="askLogin",e.AskLogin="askLoginPopup",e.ToggleDashlaneSettings="popover_v2_askForDisableDashlane",e.GetInitialData="popover_v2_askForInitialData",e.SaveGeneratedPassword="popover_v2_askForCopyPassword",e.FillPassword="popover_v2_askForFillPassword",e.AutoLoginPassword="popover_askForAutologin",e.GeneratePassword="popover_v2_askForGeneratePassword",e.SavePasswordGeneratorOptions="popover_v2_askForGeneratorSaveDefaults",e.GetWebsiteInfo="popover_v2_askForWebsiteInfo",e.SendUsageLog="popover_v2_usageLog"}(t.LegacyOrderMessage||(t.LegacyOrderMessage={}))},,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(290),t),o(n(711),t),o(n(712),t)},,,,,,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.OrderSender=void 0;var o=n(70),i=n(30),a=n(19),s=n(6),u=n(1),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.msgId=0,this._useWebsockets=!0}var t,n,s;return t=e,(n=[{key:"useWebSockets",value:function(){return this._useWebsockets}},{key:"documentComplete",value:function(e,t){this.sendOrderToPluginOrMaverick(e,t)}},{key:"sendOrderToCpp",value:function(e,t,n){o.default().logOrder(e.action,e,n||"sendOrderToCPP"),this.sendOrderToPluginOrMaverick(e,t)}},{key:"sendDomInformationsOrder",value:function(e,t){var n=this;""===(e&&e.domStructure||"")&&i.Logger.getInstance().log("DOM Structure empty",0);var r=a.default().getControllerById(t);if(r){var s=r.getLocation();!function(){if(r.getLocation()===s){var a=r.getTitle(),u=e;u.pageTitle=a,n.sendOrderToPluginOrMaverick(u,t),"DOMInformations"===e.action?o.default().signalLoadEvent("DOM_INFORMATIONS",t):"signalNewDOMInformations"===e.action?o.default().signalLoadEvent("NEW_DOM_INFORMATIONS",t):"signalAjaxDOMInformations"===e.action&&o.default().signalLoadEvent("AJAX_DOM_INFORMATIONS",t),o.default().logOrderOk("fromInjectedJsToCpp")}else i.Logger.getInstance().log("Location has changed, discarding DOMInformations order",0)}()}}}])&&r(t.prototype,n),s&&r(t,s),e}();t.OrderSender=c;var l=void 0;function d(){if(!l)throw s.exceptionLog({code:u.ExceptionCode.Error,fileName:"common/background/communication/OrderSender.ts",funcName:"getInstance",message:"GetInstance is called but instance is not initialized"}),"GetInstance is called but instance is not initialized";return l}t.setInstance=function(e){l=e},t.getInstance=d,t.default=d},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NativeAppMessage=void 0,function(e){e.LoginResponse="loginResponse",e.SharedSessionResponse="sharedSessionResponse",e.LogoutResponse="logoutResponse",e.LogoutRequest="logoutRequest",e.RegisterResponse="registerResponse",e.CommunicationInitRequest="communicationInitRequest",e.CommunicationPingResponse="communicationPingResponse",e.ErrorResponse="errorResponse"}(t.NativeAppMessage||(t.NativeAppMessage={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerifiedOrder=void 0;var r=n(722),o=n(1);t.getVerifiedOrder=function(e){var t=e.protoLookupType,i=e.exceptionLog,a=e.order;try{var s,u=n(740);return r.Root.fromJSON(u).lookupType(t).verify(a)?(i({funcName:"getVerifiedOrder",fileName:"protoVerifiedOrder.ts",code:o.ExceptionCode.Error,message:"Order is not verified for package: ".concat(t)}),null):a}catch(s){return i({funcName:"getVerifiedOrder",fileName:"protoVerifiedOrder.ts",code:o.ExceptionCode.Error,message:"Error when trying to check order prototype: ".concat(s)}),null}}},,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;var l=n(138),d=n(13),f=n(35),p=n(6),g=n(1),h=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){return o(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"getInitialDataForInjected",value:function(e){var t=e.frameId,n=e.isUserLoggedIn,r=e.hasSecureWebUi,o=e.features,i=e.isMarshmallowEnabled,a=this.isStandalone();return{action:"initialData",applicationType:a?d.ApplicationType.Standalone:d.ApplicationType.Native,frameId:t,hasSecureWebUi:r,isUserLoggedIn:n,maverickStatus:a||this.getPluginFeatures().mfa,useMarshmallow:i,features:o}}},{key:"getBrowserName",value:function(){return l.browser.getBrowserName()}},{key:"getBrowserVersion",value:function(){return l.browser.getBrowserVersion()}},{key:"getBrowserCountry",value:function(){return l.browser.getBrowserCountry()}},{key:"getBrowserLanguage",value:function(){return l.browser.getBrowserLanguage()}},{key:"getOSName",value:function(){var e;return null!==(e=l.os.getOSName())&&void 0!==e?e:""}},{key:"getOSVersion",value:function(){return l.os.getOSVersion()}},{key:"getBrowser",value:function(){return"CHROME"}},{key:"getBuildVersions",value:function(){return Object.assign(Object.assign({},{extension:"6.2109.0",carbon:"109.101.0",injected:"7.4.1",leeloo:"57.168.3",maverick:"47.17.0",webui:"1.20.1"}),{extension:chrome.runtime.getManifest().version})}},{key:"loadExtensionModeFromStorage",value:function(){var e=this;return f.getAsyncStorageInstance().get("options.standalone").then((function(t){null!=t&&(e._standaloneStorageValue=t)}))}},{key:"getMarshmallowStorageInfo",value:function(){var e="options.marshmallow";return f.getAsyncStorageInstance().get(e).then((function(t){return void 0!==t&&("boolean"!=typeof t?(p.exceptionLog({code:g.ExceptionCode.Error,fileName:"background/config/index.ts",funcName:"getMarshmallowStorageInfo",message:"Storage value ".concat(e," should be a boolean, instead is ").concat(t)}),!1):t)}))}},{key:"getExtensionHostUrl",value:function(){return chrome.runtime.getURL("")}},{key:"getExtension",value:function(){return"extensionChrome"}},{key:"willWebUIControllerUsePopover",value:function(){return!1}},{key:"getPopupUrl",value:function(){return this.isStandalone()?"content/popup/index.html":"content/popup-desktop/index.html"}},{key:"isHiDPICapable",value:function(){return window&&window.devicePixelRatio>=2}},{key:"loggingEnabledThroughSettings",value:function(){return f.getSyncStorageInstance().get("options.loggingEnabled")}}])&&i(t.prototype,n),r&&i(t,r),c}(d.Config));function m(){return h}d.setInstance(h),t.getInstance=m,t.default=m},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.Debugger=void 0;var o=n(13);function i(e){return{fromInjectedJsToExtension:"[inject  --\x3e backgnd]",fromCppToExtension:"[desktop --\x3e backgnd]",CppToExtension:"[desktop --\x3e backgnd]",fromExtensionToCpp:"[backgnd --\x3e desktop]",popupToBackground:"[popup   --\x3e backgnd]",backgroundToPopup:"[backgnd --\x3e popup  ]",fromExtensionToJs:"[backgnd --\x3e inject ]",dashlaneMessageToWebPage:"[backgnd --\x3e inject ]",dashlaneMessageToWebPageForAllFrames:"[backgnd --\x3e inject (frames)]",dashlaneWebUIEvent:"[backgnd --\x3e Webui]"}[e]||"[".concat(e,"]")}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"signalLoadEvent",value:function(e,t){if(o.default().loggingEnabled()){var n="".concat(i("backgnd")," tab #").concat(t,': loadEvent "').concat(e,'"');console.debug(n)}}},{key:"logOrder",value:function(e,t,n){if(o.default().loggingEnabled()&&"tabBecomeKey"!==t.action&&n){var r="".concat(i(n),' order "').concat(e,'" ').concat(JSON.stringify(t));console.debug(r)}}},{key:"logOrderOk",value:function(e){}},{key:"logOrderFailed",value:function(e){if(o.default().loggingEnabled()){var t="".concat(i(e)," order failed!");console.error(t)}}},{key:"logError",value:function(e,t,n){if(o.default().loggingEnabled()&&!t.includes("DOMNodeInserted events activated")){var r=null;e>=3?(r="".concat(i(n)," info (lvl #").concat(e,') "').concat(t,'"'),console.debug(r)):e>=1?(r="".concat(i(n)," warning (lvl #").concat(e,') "').concat(t,'"'),console.warn(r)):(r="".concat(i(n)," error (lvl #").concat(e,') "').concat(t,'"'),console.error(r))}}},{key:"log",value:function(e,t,n){return this.logError(e,t,n)}}])&&r(t.prototype,n),a&&r(t,a),e}();t.Debugger=a;var s=new a;function u(){return s}t.setInstance=function(e){s=e},t.getInstance=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeVerifyOrder=void 0;var r=n(63);t.makeVerifyOrder=function(e){var t=e.protoLookupType,n=e.orderTypeGuard;return function(e){var o=e.order,i=e.exceptionLog,a=r.getVerifiedOrder({order:o,exceptionLog:i,protoLookupType:t});return n(a)?a:null}}},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setInstance=void 0;var r=n(26),o=n(6),i=n(1),a=n(112),s=n(144),u=n(11),c=n(50),l=null;function d(){if(!l)throw o.exceptionLog({code:i.ExceptionCode.Error,fileName:"common/background/ExternalModules/CarbonExtension.ts",funcName:"carbon",message:"carbon is called but instance is not initialized"}),"carbon is called but instance is not initialized";return l}t.setInstance=function(e){l=e,["openSessionProgressChanged","openSessionTokenSent","openSessionOTPForNewDeviceRequired","openSessionOTPSent","openSessionAskMasterPassword","openSessionTokenWarning","openSessionFailed"].forEach((function(e){d()[e].on((function(t){s.default.updateStep(e),r.default().postMessageToPopover(e,{data:t})}))})),u.extensionCarbonConnector.liveServiceProviderUrl.on((function(e){r.default().postMessageToPopover(c.ExtensionPopupActions.OpenSessionSSO,{data:e})})),l.loginStatusChanged.on((function(e){r.default().treatAuthStatus(e.loggedIn,e.login,""),r.default().askToResetAccountCreationBadge("hide")})),l.dataModelUpdated.on((function(e){a.performanceMethods.mark(a.PerformanceMarker.RECEIVED_CARBON_DATA),a.performanceMethods.measure("Receiving carbon data",a.PerformanceMarker.ASK_CARBON_DATA),r.default().setAccountData(e)})),l.accountInfoChanged.on((function(e){var t=e.premiumStatus,n=e.subscriptionCode;t&&(r.default().setPremiumStatus(t),t.spaces&&r.default().setUserSpaces(t.spaces)),n&&r.default().setSubscriptionCode(n)})),l.accountFeaturesChanged.on((function(e){r.default().setAccountFeatures(e)})),l.localAccountsListUpdated.on((function(e){r.default().setLocalAccountsList(e)})),l.openWebOnboardingTab.on((function(e){var t=e.url;r.default().openNewTabWithUrl(t)})),l.webOnboardingModeUpdated.on((function(e){r.default().updateWebOnboardingMode(e)}))},t.default=d},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=t.isOSX=t.getSimplePlatformString=t.getSimplePlatform=t.getFullPlatformDetails=t.getBrowserLanguage=void 0;var r,o=n(619);function i(){var e=navigator.userAgent||"";return o.parse(e).toJSON()}function a(){var e=i();return"linux"===e.os.family.toLowerCase()?r.LINUX:e.os.family.toLowerCase().includes("mac os x")?r.OSX:e.os.family.toLowerCase().includes("windows")?r.WINDOWS:e.os.family.toLowerCase().includes("ubuntu")?r.LINUX:e.os.family.toLowerCase().includes("cros")?r.CHROME_OS:r.UNKNOWN}!function(e){e[e.LINUX=0]="LINUX",e[e.OSX=1]="OSX",e[e.UNKNOWN=2]="UNKNOWN",e[e.WINDOWS=3]="WINDOWS",e[e.CHROME_OS=4]="CHROME_OS"}(r||(r={})),t.getBrowserLanguage=function(){return navigator&&navigator.language||""},t.getFullPlatformDetails=i,t.getSimplePlatform=a,t.getSimplePlatformString=function(){return r[a()]},t.isOSX=function(){return a()===r.OSX},t.isWindows=function(){return a()===r.WINDOWS}},,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.Logger=void 0;var o=n(13),i=n(70);function a(e){return e?"Message : "+e.message+"\nFile : "+e.fileName+"\nLine : "+e.lineNumber+"\nName : "+e.name:""}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,(n=[{key:"log",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"???";e=e.replace(/(\n|\r)/g,"--endl--"),i.default().logError(t,e,n)}},{key:"logAsapEvent",value:function(e,t){o.default().getLoggingConfig().asapEvents&&this.log(e,t)}},{key:"logError",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"???";this.log(["Error",e,"\n",a(t)].join(""),n,r)}}])&&r(t.prototype,n),s&&r(t,s),e}();t.Logger=s;var u=new s;function c(){return u}t.setInstance=function(e){u=e},t.getInstance=c,t.default=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceMethods=t.PerformanceMarker=void 0,function(e){e.POPUP_INITIAL_DATA_REQUEST="POPUP_INITIAL_DATA_REQUEST",e.POPUP_LOGIN_REQUEST="POPUP_LOGIN_REQUEST",e.RECEIVED_CARBON_DATA="RECEIVED_CARBON_DATA",e.ASK_CARBON_DATA="ASK_CARBON_DATA",e.RECEIVED_CARBON_LOGIN_CONFIRMATION="RECEIVED_CARBON_LOGIN_CONFIRMATION"}(t.PerformanceMarker||(t.PerformanceMarker={})),t.performanceMethods={mark:function(){},measure:function(){}}},,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var d=n(69),f=n(19),p=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){return o(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"getCurrentTabController",value:function(){var e=this;return new Promise((function(t){e.registeredTabs.length>0?chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(n){var r=n[0];if(r)for(var o=0,i=e.registeredTabs.length;o<i;o++)if(r.id===e.registeredTabs[o].tabId)return void t(e.registeredTabs[o]);t(null)})):t(null)}))}},{key:"isCurrentTabController",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getCurrentTabController();case 2:r=n.sent,t(r===e);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"isCurrentTabId",value:function(e,t){this.isCurrentTabController(this.getControllerById(e),t)}},{key:"getCurrentTabId",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentTabController();case 2:return t=e.sent,e.abrupt("return",t?t.tabId:d.default().getDefaultTabId());case 4:case"end":return e.stop()}}),e,this)})))}},{key:"canonizeTabId",value:function(e){return e}},{key:"tabControllerIsRegistered",value:function(e){for(var t=0,n=this.registeredTabs.length;t<n;t++)if(this.registeredTabs[t].tabPanel===e)return!0;return!1}}])&&i(t.prototype,n),r&&i(t,r),c}(f.TabsController));f.setInstance(p),t.default=function(){return p}},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.dispatch=t.hasHeardFromCpp=void 0;var i,a=n(192),s=n(40),u=n(13),c=n(26),l=n(70),d=n(30),f=n(56),p=n(19),g=n(145),h=n(793),m=n(6),v=n(323),y=n(140),b=n(195),_=n(211),w=n(50),S=n(814),O=n(1),P=n(315),I=n(314),C=n(209),k=n(95),E=function(e,t){f.getInstance().sendOrderToCpp(e,t,"fromInjectedJsToCpp")},R=function(e,t){f.getInstance().sendOrderToAllFrames(e,t,"fromCppToInjectedJs")},T=function(e,t){f.getInstance().sendOrderToJs(e,t,"fromCppToInjectedJs")},x=function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.default().isMarshmallowEnabled();case 2:if(!e.sent){e.next=5;break}return e.abrupt("return","ml");case 5:if(!u.default().getPluginFeatures().mfa){e.next=7;break}return e.abrupt("return","mfa");case 7:return e.abrupt("return","standalone");case 8:case"end":return e.stop()}}),e)})))},L={logException:function(e,t){m.exceptionLog({funcName:e.funcName,fileName:e.fileName,code:e.code,message:e.message,type:e.type,precisions:e.precisions,legacy:e.legacy})},logOnline:function(e,t){},oneClickDebuggerOrder:function(e,t){},signalWebUIHidden:(i=function(e,t,n){n.signalWebUIHidden(e.type,e.webUiId,e.actionLog,e.step)},function(e,t){var n=p.default().getControllerById(t);n?i(e,t,n):d.Logger.getInstance().log("Tab controller is null, it should not be!",1)}),checkVisibilityResponse:function(e,t){var n=p.default().getControllerById(t);if(!n)throw new Error("Should not happen, non-existent tab controller");n.forwardVisibilityResponseToWebUI(e.requestId,e.isVisible)},signalTimeToWebcard:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:n=t.sent,r={type:s.PerfLogType.WA_PERFORMANCE,content:{subtype:"timeToWebcard",duration:e.timeToWebcard,action:e.showOrHide,subaction:e.webcardType,analysisMode:n}},k.default().perfLog(r);case 5:case"end":return t.stop()}}),t)})))},sendAutofillLog:function(e){var t={code:s.UsageLogCode.USAGE_AUTOFILL,content:e.autofillLog};u.default().isStandalone()?k.default().usageLog(t):u.default().getPluginFeatures().mfa&&b.getMfaControllerInstance().requestAndDontExpectResponse({type:"usageLog",code:s.UsageLogCode.USAGE_AUTOFILL,precisions:e.autofillLog})}},M=function(e,t,n,r){E(t,n)},A=function(e,t,n,r){l.default().logOrder(e,t,"fromInjectedJsToExtension"),r&&t.domStructure?(r.signalNewDOMInformationsSent(),r._bufferedDOMInformations=t.domStructure,r.sendNewDOMInformationsWithFrame(t)):d.Logger.getInstance().log("DOMInformations or signalNewDOMInformations received but not forwarded: domStructure (empty) = "+t.domStructure,3)},D=function(e,t,n,r){l.default().logOrder(e,t,"fromInjectedJsToExtension"),r&&t.domStructure&&(r._bufferedDOMInformations=t.domStructure),r.injectedScriptExecutionAllowed?r.sendNewDOMInformationsWithFrame(t):d.Logger.getInstance().log("signalAjaxDOMInformations or signalCssDOMInformations received but not forwarded: injectedScriptExecutionAllowed = "+r.injectedScriptExecutionAllowed,3)},N={documentComplete:function(e,t,n,r){throw new Error("The JS should not send this anymore")},DOMInformations:A,signalNewDOMInformations:A,signalAjaxDOMInformations:D,signalCssDOMInformations:D,mlResults:M,domNodeInserted:function(e,t,n,r){r.injectedScriptExecutionAllowed?r.sendLoadEventToCpp("DOM_NODE_INSERTED",!1):d.Logger.getInstance().log("domNodeInserted received but not forwarded: injectedScriptExecutionAllowed = "+r.injectedScriptExecutionAllowed,3)},getDescriptionsForAutoFill:M,autoFillForm:M,changeDefaultAndAutoFillForm:M,focusDescriptionsForAutoFill:function(e,t,n,r){r.cacheInputPosition(t),r.shouldBlockFocusOrder(t)||E(t,n)},blurDescriptionsForAutoFill:function(e,t,n,r){r.sendWebcardLog(t.type,t.actionLog,t.step),E(t,n)},valueDescriptionsForAutoFill:M,eventOnOutFired:M,eventOnLogoutFired:M,signalXPathListForBasket:M,askWebAppAuthStatus:M,signalStructurePerformance:M,signalContextDebugInfo:M,signalAutofillDone:M,signalPutputClickedForLog:M,signalSearchQueryForLog:M,browserMessage:M,DashlaneAPIRequest_getClientVersion:M,DashlaneAPIRequest_getApplicationType:M,DashlaneAPIRequest_isUserLoggedin:M,DashlaneAPIRequest_openDashlaneApplication:M,DashlaneAPIRequest_userWantsToSaveData:M,DashlaneAPIRequest_saveDataObjectsResponse:M,DashlaneAPIRequest_userWantsToSignup:M,DashlaneAPIRequest_signupRequiredDetailsResponse:M,DashlaneAPIRequest_signupFullDataErrorResponse:M,DashlaneAPIRequest_signupFullDataSuccessResponse:M,DashlaneAPIRequest_userWantsToCheckout:M,DashlaneAPIRequest_getUserOnboardingSites:M,DashlaneAPIRequest_doOnboardingSiteStep:function(e,t,n,r){var o=null;try{o=JSON.parse(t.content)}catch(e){return void d.Logger.getInstance().logError("DashlaneAPIRequest_doOnboardingSiteStep",new Error("Could not parse the order"),0)}var i=o.site.match(/^https?:\/\/([.-a-z0-9_^/]+)/i);if(i&&i.length>1){var a=i[1].replace("www.","");c.default().deleteCookiesForOnboarding(a).then((function(){E(t,n)}))}},DashlaneAPIRequest_endWebOnboarding:M,DashlaneAPIRequest_signalOnboardingStep:M,DashlaneAPIRequest_getCardData:M,DashlaneAPIRequest_subscribeCard:M,DashlaneAPIRequest_signalCardEvent:M,signalTimeToImpalas:function(e,t,n,r){if(u.default().isStandalone()||u.default().getPluginFeatures().mfa)return u.default().isDebug()&&_.default().signalTti(parseInt(t.tti,10)),M(0,t,n)}},j={DashlaneAPIResponse_getCardData:R,DashlaneAPIResponse_getClientVersion:R,DashlaneAPIResponse_getUserOnboardingSites:R,DashlaneAPIResponse_getApplicationType:R,DashlaneAPIResponse_isUserLoggedin:R,DashlaneAPIResponse_saveDataObjectsRequest:R,DashlaneAPIResponse_saveDataResponseRequest:R,DashlaneAPIResponse_signupFullDataRequest:R,DashlaneAPIResponse_signupRequiredDetailsRequest:R,DashlaneAPIResponse_subscribeCard:R,askForNewDOMInformations:function(e,t){var n=p.default().getControllerById(t);n&&(n.signalWaitForNewDOMInformations(),R(e,t))},autoLoginStatus:T,autofillChoiceLayer:T,displayOnboardingSuccessOverlay:T,fillElements:function(e,t){R(e,t)},hideOnboardingSuccessOverlay:T,highlightInputsForAutoComplete:R,autofillVirtualKeyboard:R,putEventHandlers:R,putEventHandlersOnIns:R,putEventHandlersOnOutsToWatchForLogout:R,showInput:R,signalElementsToWatchValue:R,testXPathListForBasket:T,watchPutputForLog:R,webAppAuthStatus:T,maverickStatus:T};var U={},B=function(e,t,n){var r=JSON.parse(t.content,(function(e,t){return"string"==typeof t?t.replace(/--endl--/g,"\n").replace(/--dbsl--/g,"//").replace(/--equ--/g,"="):t})),o=n?n.toString():"default";if(U[o]||(U[o]=0),r.error)U[o]<10?(U[o]++,setTimeout((function(){c.default().askForInitialData(),P.getWebsiteInfo()}),50)):d.Logger.getInstance().log("Dispatcher.popoverSignalDataRefresh FAILED ["+U[o]+"]: "+r.error,0);else{U[o]=0,c.default().setInitialData(r);var i=r.websites||[],s=a.uniq(i.map((function(e){return e.Domain})).filter((function(e){return!!e}))).sort(),l=function(e){var n=function(e){return Object.assign({accountFeatures:c.default().getAccountFeatures()},e)}(e);c.default().postMessageToPopover(t.action,{data:n})};if(l(a.assign({},r,{isStandalone:u.default().isStandalone()})),s&&s.length)!function(e,t){if(h.isDomainIconMapEmpty()){[e.slice(0,50),e.slice(50)].forEach((function(e){h.default(e).then(t)}))}else h.default(e).then(t)}(s.filter((function(e){return"string"==typeof e&&e.length})).filter((function(e){return!e.includes(":")})),(function(e){var t=a.assign({},r,{websites:i.map((function(t){return a.assign({},t,{CrawlerIcon:e[t.Domain]})}))});c.default().setInitialData(t),l(t)}))}},F=function(e){return JSON.parse(e,(function(e,t){return"string"==typeof t?t.replace(/--endl--/g,"\n"):t}))},W=function(e,t,n){t.website&&(t.website.mavanalysis=u.default().isStandalone()),c.default().postMessageToPopover(e,{data:t})},q=function(e,t,n){var r=F(t.content);W(e,r)},H={openApplication:function(e,t,n){if(u.default().isStandalone()){var r=t.route||"current";c.default().openLeelooTab(r)}else{if(!u.default().getPluginFeatures().mfa)return m.exceptionLog({funcName:"openApplication",fileName:"Dispatcher.ts",code:O.ExceptionCode.Error,message:"Dispatcher.openApplication() called, !standalone && !mfa"});c.default().userLoggedIn?c.default().openApplication({origin:"Maverick"}):c.default().requestLogin({})}},requestLogin:function(e,t,n){c.default().requestLogin({forceLogin:t.forceLogin})},basicAuthAnswer:function(e,t,n){v.getInstance().credentialCallback(t.username,t.password)},signalAuthStatusLoggedin:function(e,t,n){c.default().treatAuthStatus(!0,t.login,t.lastLogin)},signalAuthStatusLoggedout:function(e,t,n){c.default().treatAuthStatus(!1,t.login,t.lastLogin)},askForAutologinOnWebsite:function(e,t,n){c.default().autologinOnWebsite(t.Url)},changeNavStyle:function(e,t,n){},forwardMessageFromPluginToPlugin:function(e,t,n){f.getInstance().sendOrderToCpp(t,n,"fromExtensionToCpp")},changeLanguage:function(e,t,n){var r=t.code;g.default().setLanguage(r),c.default().changeLanguage()},popover_signalDataRefresh:B,popover_v2_signalDataRefresh:B,popover_signalPasswordGenerated:q,popover_v2_signalPasswordGenerated:q,popover_v2_signalWebsiteInfo:function(e,t,n){var r=w.ExtensionPopupActions.PopoverV2SignalCurrentTabInfo,o=a.assign({},t,{action:r}),i=F(o.content);i.disabledAutofillOnDomain="true"===i.disabledAutofillOnDomain,i.disabledAutofillOnPage="true"===i.disabledAutofillOnPage,i.disabledAutologinOnDomain="true"===i.disabledAutologinOnDomain,i.disabledAutologinOnPage="true"===i.disabledAutologinOnPage,i.disabledFromSpaces="true"===i.disabledFromSpaces,I.toggleDashlaneSettingsLegacyController.setSettings(C.ChangeDashlaneSettingsType.Domain,{autoFill:!i.disabledAutofillOnDomain,autoLogin:!i.disabledAutologinOnDomain}),I.toggleDashlaneSettingsLegacyController.setSettings(C.ChangeDashlaneSettingsType.Page,{autoFill:!i.disabledAutofillOnPage,autoLogin:!i.disabledAutologinOnPage}),W(r,i)},signalInstallerId:function(e,t,n){d.InstallerLog.getInstance().setInstallerId(t.installerId)},showWebUI:function(e,t,n){var r=p.default().getControllerById(n);r&&r.showWebUI(t.pageId,t.content.uiInfos)},hideWebUI:function(e,t,n){var r=p.default().getControllerById(n);r&&r.hideWebUI(t.webUIType||t.content.type)},updateWebUI:function(e,t,n){var r=p.default().getControllerById(n);r&&r.updateWebUI(t.content.uiInfos)},loadUrl:function(e,t,n){c.default().openTabWithUrl(n,t.url)},allowInjectedScriptExecution:function(e,t,n){c.default().allowInjectedScriptExecution(n)},openAddObjectWindows:function(e,t,n){if(u.default().getPluginFeatures().mfa){var r=y.dataModelTypeToInformationNeeded[t.objectType];b.getMfaControllerInstance().request({type:"openAddObjectWindows",objectType:r})}},openPasswordHistory:function(e,t,n){if(u.default().getPluginFeatures().mfa){var r=t.domain;b.getMfaControllerInstance().request({type:"openPasswordHistory",domain:r})}},seePassword:function(e,t,n){if(u.default().getPluginFeatures().mfa){var r=t.domain;b.getMfaControllerInstance().request({type:"seePassword",domain:r})}},loginStatusDetected:function(e,t,n){var r=p.default().getControllerById(n);null==r||r.setGuessedLoginStatus(t.guessedLoginStatus,t.loginStatusHints)},accountCapabilitiesChanged:function(e,t){if(u.default().getPluginFeatures().mfa){var n=null;try{n=JSON.parse(t.content)}catch(e){return void d.Logger.getInstance().logError("accountCapabilitiesChanged",new Error("Could not parse the order"),0)}var r={premiumStatus:{capabilities:{passwordsLimit:n&&JSON.parse(n.passwordsLimit)}}};y.getMaverickBackendInstance().accountInfoChanged(r)}},accountFeaturesChanged:function(e,t){var n=JSON.parse(t.content),r={list:void 0!==n.list?JSON.parse(n.list):null,pluginCapacitiesList:void 0!==n.pluginCapacitiesList?JSON.parse(n.pluginCapacitiesList):null};c.default().setAccountFeatures(r),"true"!==r.list.testMigration&&"true"!==r.list.migrationSAEX||c.default().signalExtensionMigration(),u.default().getPluginFeatures().mfa?"false"!==r.list.mfa&&r.list.mfa?y.getMaverickBackendInstance().accountFeaturesChanged(r):(y.getMaverickBackendInstance().loginStatusChanged({loggedIn:!1,login:""}),u.default().setPluginFeatures(Object.assign(Object.assign({},u.default().getPluginFeatures()),{mfa:!1}))):"true"===r.list.mfa&&(u.default().setPluginFeatures(Object.assign(Object.assign({},u.default().getPluginFeatures()),{mfa:!0})),y.setMfaHooksForPlugin(),c.default().reinit().then((function(){y.getMaverickBackendInstance().loginStatusChanged({loggedIn:c.default().userLoggedIn,login:c.default().userLogin}),y.getMaverickBackendInstance().accountFeaturesChanged(r)})))},biometryStatus:function(e,t){y.getMaverickBackendInstance().biometryStatus({requestId:t.forwardedTabId,passed:t.passed,canceled:t.canceled})}},G=!1;t.hasHeardFromCpp=function(){return G};var V=function(e){return Number.isInteger(e)},K=function(e){var t={elements:[]};return Object.keys(e).forEach((function(n){"_originalMessage"!==n&&0!==n.length&&(function(e){return"object"===r(e)&&null!==e}(e[n])&&function(e){return Object.keys(e).map((function(e){return parseInt(e,10)})).every(V)}(e[n])?Object.keys(e[n]).forEach((function(r){t.elements[r]||(t.elements[r]={}),t.elements[r][n]=e[n][r]})):t[n]=e[n])})),t},z={fillElements:function(e,t){return{action:e.action,tabId:t,elements:[{elementType:e.DOMType.toUpperCase(),displayValue:e.DisplayValue,dontFillIfHidden:!!e.DontFillIfHidden,elementId:e.ElementId,frame:+e.Frame,hashId:e.HashId,informationNeeded:e.InformationNeeded,noFocus:e.NoFocus,position:+e.Position,type:e.Type,value:e.Value,valueKnown:e.ValueKnown,valueObligatory:e.ValueObligatory}]}},highlightInputsForAutoComplete:function(e,t){var n=K(e);return 0===n.elements.length?{action:n.action,tabId:t,showImpalas:n.showImpalas}:{action:n.action,meaningPageId:n.elements[0].MeaningPageId,tabId:t,showImpalas:n.showImpalas,elements:n.elements.map((function(e){return{elementType:e.DOMType.toUpperCase(),frame:+e.Frame,hashId:e.HashId,identifier:e.ElementId,informationNeeded:e.InformationNeeded,invisible:e.Invisible,knownValue:e.KnownValue,meaningPageId:e.MeaningPageId,mustDestroy:e.MustDestroy,position:+e.Position,precision:e.PrecisionType,sendLiveValue:e.SendLiveValue,showInput:e.ShowPutput}}))}},putEventHandlersOnOutsToWatchForLogout:function(e,t){return{action:e.action,meaningPageId:e.content.MeaningPageId,tabId:t,elements:e.content.ElementsToPutEventOn.map((function(e){return{elementType:e.DOMType.toUpperCase(),frame:+e.Frame,hashId:e.HashId,identifier:e.Identifier,position:+e.Position}}))}},putEventHandlers:function(e,t){return{action:e.action,meaningPageId:e.content.MeaningPageId,tabId:t,elements:e.content.ElementsToPutEventOn.map((function(e){return{elementType:e.DOMType.toUpperCase(),frame:+e.Frame,hashId:e.HashId,identifier:e.Identifier,position:+e.Position}}))}},signalElementsToWatchValue:function(e,t){return{action:e.action,meaningPageId:e.content.MeaningPageId,tabId:t,elements:e.content.ElementsToWatchValue.map((function(e){return{elementType:e.DOMType.toUpperCase(),frame:+e.Frame,hashId:e.HashId,identifier:e.Identifier,position:+e.Position}}))}}};t.dispatch=function(e,t){var n=e.action;if(n){var r=!(u.default().getPluginFeatures().mfa||u.default().isStandalone());if(L[n])return"logOnline"!==n&&l.default().logOrder(n,e,"fromInjectedJsToExtension"),void L[n](e,t);if(j[n])return r&&(["putEventHandlers","signalElementsToWatchValue","putEventHandlersOnOutsToWatchForLogout"].some((function(t){return t===e.action}))&&(e.content=JSON.parse(e.content)),e=z[n]?z[n](e,t):e),G=!0,void j[n](e,t);if(N[n]){var o=p.default().getControllerById(t);return o?void N[n](n,e,t,o):void d.Logger.getInstance().log("Tab controller is null, it should not be!",1)}if(H[n]){r&&["showWebUI","hideWebUI","updateWebUI"].some((function(t){return t===e.action}))&&(e.content=JSON.parse(e.content)),G=!0,"httpServerInfoResponse"!==n&&"changeLangage"!==n&&l.default().logOrder(n,e,"fromCppToExtension");var i=S.fixOrderEncoding(e);H[n](n,i,t)}else{if("mfaResponse"===n||"mfaResponseFromApp"===n){var a=null;try{a=JSON.parse(e.content)}catch(e){throw new Error("Order is malformed, order.content is not JSON")}var s=null;return a.error&&((s=new Error).name=a.error),void b.getMfaControllerInstance().onMfaResponse({error:s,requestId:a.id,responseData:a})}d.Logger.getInstance().log("Nothing to do, unknown action - "+n,1)}}else d.Logger.getInstance().log("Nothing to do, undefined action - "+n,1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataModelTypeToInformationNeeded=t.setMfaHooksForPlugin=t.setMaverickBackendInstance=t.getMaverickBackendInstance=void 0;var r=n(40),o=n(26),i=n(13),a=n(195),s=n(6),u=n(714),c=n(1),l=null;t.getMaverickBackendInstance=function(){if(!l)throw s.exceptionLog({code:c.ExceptionCode.Error,fileName:"common/background/ExternalModules/maverick/MaverickBackend.ts",funcName:"maverickBackendConnector",message:"maverickBackendConnector is called but instance is not initialized"}),"maverickBackendConnector is called but instance is not initialized";return l};t.setMaverickBackendInstance=function(e){return l=e};var d={KWAuthentifiant:"AUTHENTICATION",KWIdentity:"IDENTITY",KWPaymentMean_creditCard:"PAYMENT_MEAN_CREDITCARD",KWEmail:"EMAIL",KWDriverLicence:"DRIVER_LICENCE",KWPassport:"PASSPORT",KWIDCard:"ID_CARD",KWPaymentMean_paypal:"PAYMENT_MEAN_PAYPAL",KWFiscalStatement:"FISCAL",KWPersonalWebsite:"WEBSITE",KWCompany:"COMPANY",KWAddress:"ADDRESS",KWPhone:"PHONE",KWBankStatement:"BANK_STATEMENT",KWSocialSecurityStatement:"SOCIAL_SECURITY"},f=["AutoLogin","AutoProtected","Checked","SharedObject","SubdomainOnly","UseFixedUrl"],p=["LastBackupTime","LastUse","ModificationDatetime","NumberUse","Strength"];t.setMfaHooksForPlugin=function(){if(!l)throw"mfaHooks is called but MAVERICK CONNECTOR is not initialized";if(!a.isMfaControllerInstanceSet()){var e=new a.MaverickForAllController;a.setMfaControllerInstance(e),l.checkMasterPassword.on((function(e){return a.getMfaControllerInstance().request({type:"checkMasterPassword",password:e},(function(e){return e.masterPasswordIsValid}))})),l.queryDataModel.on((function(e){var t=e.id,n=e.url,o=e.content,i=e.shouldReturnSpaces;return a.getMfaControllerInstance().request({type:"dataRequest",url:n,dataTypes:o,shouldReturnSpaces:i},(function(e){var n={userData:{},spacesInfos:[]};return e.objects&&(e.objects.spacesInfos&&(n.spacesInfos=e.objects.spacesInfos.spaces),e.objects.userData?n.userData=e.objects.userData:n.userData=e.objects,Object.keys(n.userData).forEach((function(e){n.userData[e].forEach((function(t){t.kwType=r.getDataModelTypeFromTransactionType(e),"AUTHENTIFIANT"===e&&(f.forEach((function(e){return t[e]="true"===t[e]})),p.forEach((function(e){return t[e]=t[e]?parseInt(t[e],10):null})))}))}))),{id:t,type:"all",content:n}}))})),l.generatedPassword.on((function(e){var t=e.length,n=e.digits,r=e.symbols,o=e.domain;return a.getMfaControllerInstance().request({type:"generatePassword",domain:o,length:t,numbers:n,symbols:r},(function(e){return e.password}))})),l.analysisDisabled.on((function(e){return a.getMfaControllerInstance().request({type:"analysisDisabled",url:e.url},(function(e){return{disabled:"true"===e.disabled,onlyFillLoginInfo:"true"===e.onlyFillLoginInfo}}))})),l.usageLog.on((function(e){var t=e.content;return t.browser=i.default().getBrowserName(),t.browserVersion=i.default().getBrowserVersion(),t.os=i.default().getOSName(),a.getMfaControllerInstance().requestAndDontExpectResponse({type:"usageLog",code:e.code,precisions:t}),Promise.resolve()})),l.perfLog.on((function(e){(function(e){return e.type===r.PerfLogType.ANALYSIS_PERFORMANCE})(e)&&a.getMfaControllerInstance().requestAndDontExpectResponse({type:"perfLog",content:{type:"AnalysisReport",info:{loggedin:o.default().userLoggedIn,cpp5_1an:e.info.firstAnalysis,cpp6_2an:e.info.secondAnalysis,cpp9_form:e.info.formAnalysis,cpp10_7an:e.info.seventhAnalysis,timeToImpalas:e.info.timeToImpalas,totalAnalysisTime:e.info.totalAnalysisTime,timeSinceLaunch:e.info.timeSinceLaunch,browser:i.default().getBrowserName(),browserVersion:i.default().getBrowserVersion(),analysisMode:e.info.analysisMode||"mfa"}}})})),l.installerLog.on((function(e){var t=e.precisions,n=e.step;return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"installerLog",step:n,precisions:t}),Promise.resolve()})),l.exceptionLog.on((function(e){if(i.default().isDebug()&&i.default().isAlertExceptionEnabled()){i.exceptionsToWatch.exceptions.forEach((function(t){var n,r;e.message.includes(t.name)&&(chrome.browserAction.setIcon({path:{19:"skin/icon/icon_exceptions.png",38:"skin/icon/icon_exceptions@2x.png"}}),alert((r=e,"Tracking Message: ".concat((n=t).message,"\n\n")+"Please contact ".concat(n.contact,"\n\n")+"File Name: ".concat(r.fileName,"\n\n")+"Function Name: ".concat(r.funcName,"\n\n")+"Precisions: ".concat(r.precisions))))}))}return s.exceptionLog({code:e.code||c.ExceptionCode.Error,fileName:e.fileName||"common/background/ExternalModules/maverick/MaverickCarbon.ts",funcName:e.funcName||"Maverick Function",legacy:e.legacy,message:e.message,precisions:e.precisions,type:e.type||"maverickException"}),Promise.resolve()})),l.savePersonalDataItem.on((function(e){return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"saveRequest",content:u.transformForPlugin(e)}),Promise.resolve()})),l.filledDataItem.on((function(e){var t=e.id,n=e.dataType,r=e.url;return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"objectsAutofilled",objectId:t,url:r,informationNeeded:d[n]}),Promise.resolve()})),l.evaluatePasswordStrength.on((function(e){return a.getMfaControllerInstance().request({password:e,type:"evaluatePasswordStrength"},(function(e){return e.strength}))})),l.saveCredentialDisabled.on((function(e){var t=e.rootDomain;return a.getMfaControllerInstance().request({type:"saveCredentialDisabled",domain:t},(function(e){return e.isSaveCredentialDisabled}))})),l.fetchSpacesInfo.on((function(){return[]})),l.signalSaveCredentialDisabled.on((function(e){var t=e.rootDomain;return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"signalSaveCredentialDisabled",domain:t})})),l.autofillIsPasswordProtected.on((function(e){var t=function(e){return{isProtected:Boolean(e.isProtected),dataBackendHasBiometry:Boolean(e.dataBackendHasBiometry),isSSOUser:!1}};return"credential"===e.dataType?a.getMfaControllerInstance().request({type:"isAutofillPasswordProtected",dataType:e.dataType||"",credentialId:e.id||""},t):a.getMfaControllerInstance().request({type:"isAutofillPasswordProtected",dataType:e.dataType||""},t)})),l.getSaveCapabilities.on((function(){return["KWIdentity","KWEmail","KWPhone","KWAddress","KWCompany","KWPersonalWebsite","KWPaymentMean_creditCard"]})),l.canUserCreateNewCredential.on((function(){return a.getMfaControllerInstance().request({type:"isPwLimitReached"},(function(e){return!e.isPwLimitReached}))})),l.isReactivationEnabled.on((function(){return a.getMfaControllerInstance().request({type:"isReactivationEnabled"},(function(e){return e.showReactivation}))})),l.disableReactivation.on((function(){return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"disableReactivation"})})),l.askForBiometry.on((function(e){return a.getMfaControllerInstance().requestAndDontExpectResponse({type:"askForBiometry",tabId:e})})),l.fetchSpacesInfoForPopup.on((function(){return a.getMfaControllerInstance().request({type:"getSpacesForPopup"},(function(e){return e.spaces||[]}))}))}},t.dataModelTypeToInformationNeeded={KWIdentity:"IDENTITY",KWPaymentMean_creditCard:"PAYMENTMEANS_CREDITCARD",KWEmail:"EMAIL",KWDriverLicence:"DRIVERLICENCE",KWPassport:"PASSPORT",KWIDCard:"IDCARD",KWPaymentMean_paypal:"PAYMENTMEAN_PAYPAL",KWFiscalStatement:"FISCALSTATEMENT",KWPersonalWebsite:"PERSONALWEBSITE",KWCompany:"COMPANY",KWAddress:"ADDRESS",KWPhone:"PHONE",KWBankStatement:"BANKSTATEMENT",KWSocialSecurityStatement:"SOCIALSECURITYSTATEMENT"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postMessage=t.isNativeAppAvailable=t.isMessagingAvailable=t.killNativeMessagingHost=t.isBaseOrder=t.onNativeAppConnection=t.makeCommunication=void 0;var r=n(56),o=n(19),i=n(718),a=n(35),s=n(23),u=n(6),c=n(13),l=n(719),d=n(1),f=n(306),p=n(305),g=n(208),h=null,m=null,v=1e3,y=-1,b=-1,_=!1,w=f.nativeAppConnectionManager,S=w.setNativeAppConnected,O=w.setNativeAppDisconnected,P=w.getIsNativeAppConnected;function I(e){var t=e.isStandalone;if(!h){if(s.sendLog({message:s.LogMessage.CREATE_MESSAGE,level:2}),!chrome.runtime.connectNative)return void s.sendLog({message:s.LogMessage.NOT_SUPPORTED,level:2});var n=function(e){return e?"com.dashlane.nativemessaging":"com.dashlane.dashlane"}(t);(h=chrome.runtime.connectNative(n)).onMessage.addListener(R),h.onDisconnect.addListener(T)}}t.makeCommunication=I,t.onNativeAppConnection=function(){S(),p.startPingSequence({sendCommunicationPingRequest:g.sendCommunicationPingRequest,startPingSequenceFunc:p.startPingSequence})};var C={"Failed to start native messaging host.":!0,"Invalid native messaging host name specified.":!1,"Native host has exited.":!0,"Specified native messaging host not found.":!1,"Access to the specified native messaging host is forbidden.":!1,"Error when communicating with the native messaging host.":!0};function k(){m=null,(v=Math.max(1e3,v/2))>1e3&&(m=setTimeout(k,v))}function E(e){return e&&e.from&&e.to&&e.subject&&e.body}function R(e){if(E(e))return l.handleNativeOrder(e);!function(e){var t=e.message,n=e.tabId;if(!t)return void s.sendLogError({label:"makeCommunication - onMessage",error:new Error("Received a message without a message property"),level:0});_&&(_=!0,a.getSyncStorageInstance().set("cppTalked",!0));s.sendLog({message:t,level:2}),b=t.length;for(var r=t.length-1,i=t.length-1;i>=0;i--)if("B"!==t[i]){r=i;break}var u=t.substring(0,r+1);o.default().catchMessageFromCpp(n,u)}(e)}function T(e){var t=null;if(chrome.runtime.lastError&&(t=chrome.runtime.lastError.message),e.error&&(t=e.error.message),O(),t&&s.sendLogError({label:"makeCommunication - onDisconnect",error:new Error(t),level:0}),!r.getInstance().useWebSockets()){var n,o,i,a=y+", "+b+", "+v/1e3;s.nativeMessagingExceptionLog({funcName:"_makeCommunication",fileName:"KWCommunication.chrome.native.js",code:d.ExceptionCode.Error,message:t||"Unknown Error",precisions:a,legacy:!1}),h=null,(void 0===(i=(o=t)&&C[o])||i)&&(n=c.default().isStandalone(),setTimeout((function(){return I({isStandalone:n})}),v),m&&clearTimeout(m),m=setTimeout(k,v+5e3),v*=2)}}t.isBaseOrder=E,t.killNativeMessagingHost=function(){if(m&&(clearTimeout(m),m=null),h&&h.disconnect)try{h.disconnect()}catch(e){}},t.isMessagingAvailable=function(){var e=h&&h.error&&h.error.message;return Boolean(h&&!e)};t.isNativeAppAvailable=function(){return P()},t.postMessage=function(e){var t=c.default().isStandalone()&&E(e)?JSON.stringify(e):s.stringifyOrder(e),n=i.default(t);h?n>=1048576?(r.getInstance().msgId-=1,u.exceptionLog({funcName:"postMessage",fileName:"NativeMessagingController.ts",code:d.ExceptionCode.Error,message:"Message to be sent is too big",precisions:""+n,legacy:!1})):(y=n,h.postMessage(e)):u.exceptionLog({funcName:"postMessage",fileName:"common/background/communication/NativeMessagingController/index.ts",code:d.ExceptionCode.Error,message:"Port is null",legacy:!1})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlQueryParam=t.getUrlGivenQuery=t.getDomain=void 0;var r=n(317);t.getDomain=function(e){var t=/^https?:\/\/((?:[a-z0-9\-_]{1,63}\.)*)([a-z0-9\-_]{1,63}\.)([a-z0-9]{1,63})(?:\/.*)?$/i;e=String(e);var n="default",r="*",o=t.exec(e);return o&&o.length>=4?(void 0!==o[3]&&(r=o[3]),void 0!==o[2]&&(n=o[2]),void 0!==o[1]&&o[1],("co."===n||"com."===n||"fr."===n)&&(o=(t=/^https?:\/\/((?:[a-z0-9\-_]{1,63}\.)*)([a-z0-9\-_]{1,63}\.)([a-z0-9\-_]{1,63}\.)([a-z0-9]{1,63})(?:\/.*)?$/i).exec(e))&&o.length>=5?o[2]+n+r:n+r):n},t.getUrlGivenQuery=function(e,t){return[e,"?",r.stringify(t)].join("")},t.getUrlQueryParam=function(e,t){if(!e)return null;var n=new URL(e).search;return new URLSearchParams(n).get(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginStepController=void 0;var r=n(50),o=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.login="",this.step=void 0,this.validated=!1,this.sendOnGoingStepToPopup=function(){return t.validated&&t.step?{login:t.login,step:t.step}:void 0},this.updateStep=function(e){switch(e){case r.ExtensionPopupActions.OpenSessionAskMasterPassword:t.step=r.LoginStep.Password;break;case r.ExtensionPopupActions.OpenSessionTokenSent:t.step=r.LoginStep.OTPToken,t.validated=Boolean(t.login);break;case r.ExtensionPopupActions.OpenSessionOTPForNewDeviceRequired:case r.ExtensionPopupActions.OpenSessionOTPSent:t.validated=!1;break;default:return}},this.reset=function(){t.step=void 0,t.validated=!1},this.updateLogin=function(e){t.login=e}};t.LoginStepController=o;var i=new o;t.default=i},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.Translations=void 0;var o=n(13),i=n(6),a=n(1),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selectedLanguage=this.getDefaultLanguage()}var t,n,i;return t=e,(n=[{key:"parseLanguageFromLocale",value:function(e){return e.substr(0,2)}},{key:"getLang",value:function(){var e=o.default().isStandalone(),t=void 0!==this._selectedLanguage;if(e||!t){var n=this.getDefaultLanguage();return this.setLanguage(n),this.parseLanguageFromLocale(n)}return this.parseLanguageFromLocale(this._selectedLanguage)}},{key:"setLanguage",value:function(e){this._selectedLanguage=e}},{key:"isSupportedLanguage",value:function(e){var t=e.split("-")[0];return o.default().getSupportedLanguages()[t]}}])&&r(t.prototype,n),i&&r(t,i),e}();t.Translations=s;var u=void 0;function c(){if(!u)throw i.exceptionLog({code:a.ExceptionCode.Error,fileName:"common/background/translations/index.ts",funcName:"getInstance",message:"getInstance is called but instance is not initialized"}),"getInstance is called but instance is not initialized";return u}t.setInstance=function(e){u=e},t.getInstance=c,t.default=c},,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;var c=n(70),l=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=a(n);function n(){return o(this,n),t.apply(this,arguments)}return n}(c.Debugger));c.setInstance(l),t.getInstance=function(){return l}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SpecificController=void 0;var g=n(192),h=n(113),m=n(40),v=n(138),y=n(26),b=n(112),_=n(69),w=n(152),S=n(339),O=n(30),P=n(35),I=n(159),C=n(1005),k=n(394),E=n(1008),R=n(118),T=n(11),x=n(108),L=n(150),M=n(1009),A=n(1012),D=n(10),N=n(396),j=n(50),U=n(141),B=n(1013),F=n(198),W=n(1015),q=n(144),H=n(1017),G=n(316),V=n(397),K=n(1018),z=n(1024),J=n(6),X=n(1),Y=n(1025),Q="NO_POPUP_COMMUNICATION_PORT";function $(e){return e.sender&&e.sender.tab&&e.sender.tab.id?e.sender.tab.id:null}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(d,e);var t,n,r,i=l(d);function d(){var e;return a(this,d),(e=i.apply(this,arguments))._popoverState=null,e._webOnboardingMode=null,e._edgeChromiumMigrationStorageCleared="edgeChromiumMigrationStorageCleared",e.logoutUserOnInactivity=function(t){"idle"===t&&e.userLoggedIn&&e.requestLogout()},e.addInactivityListener=function(t){var n=60*t;chrome.idle.setDetectionInterval(n),chrome.idle.onStateChanged.addListener((function(t){return e.logoutUserOnInactivity(t)}))},e.removeInactivityListener=function(){chrome.idle.onStateChanged.removeListener(e.logoutUserOnInactivity)},e._onPopupDisconnect=function(){delete e._popupPort},e}return t=d,(n=[{key:"setInitialData",value:function(e){u(f(d.prototype),"setInitialData",this).call(this,e)}},{key:"clearCorruptedStorageLocal",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=O.Logger.getInstance(),v.browser.isChromiumEdge()){e.next=3;break}return e.abrupt("return");case 3:return n=P.getAsyncStorageInstance(),e.prev=4,e.next=7,n.get(this._edgeChromiumMigrationStorageCleared);case 7:r=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),t.logError("Error getting _edgeChromiumMigrationStorageCleared key from storage",e.t0,0),e.abrupt("return");case 14:if(!r){e.next=16;break}return e.abrupt("return");case 16:if(e.prev=16,n.getAll){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,n.getAll();case 21:o=e.sent,e.next=28;break;case 24:return e.prev=24,e.t1=e.catch(16),t.logError("Error getting all keys from storage to check for corrupted data",e.t1,0),e.abrupt("return");case 28:if(!(i=Object.keys(o)).some((function(e){return"string"==typeof o[e]&&String(o[e]).includes(".dat")}))){e.next=49;break}return e.prev=31,e.next=34,n.remove(i);case 34:e.next=40;break;case 36:return e.prev=36,e.t2=e.catch(31),t.logError("Error removing all keys from corrupted storage",e.t2,0),e.abrupt("return");case 40:return e.prev=40,e.next=43,n.set(this._edgeChromiumMigrationStorageCleared,!0);case 43:e.next=49;break;case 45:return e.prev=45,e.t3=e.catch(40),t.logError("Error setting the storage as already cleared from corrupted data",e.t3,0),e.abrupt("return");case 49:case"end":return e.stop()}}),e,this,[[4,10],[16,24],[31,36],[40,45]])})))}},{key:"init",value:function(){var e=this;return u(f(d.prototype),"init",this).call(this).then((function(){return e.clearCorruptedStorageLocal()})).then((function(){return e._switchExtensionModeIfNeededForOpenTabs()})).then((function(){return e._initializeRequestInterceptors()})).then((function(){if(_.default().isDebug()){var t=new T.DebugWS(4009,"extension"),n=D.createEventBus({events:m.ExtensionDebugConnector,channels:[t]});T.setDebugConnectorInstance(n)}return T.setLeelooWs(M.makeLeelooChannel()),T.setPopupChannel(M.makePopupChannel()),e.initExternalModules()})).then((function(){return e.initErrorHandler()})).then((function(){_.default().isStandalone()||S.default().addReadyToSendHandler((function(){e.activateOnboardingTab()}))})).then((function(){return p(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isFreshInstall();case 2:return t=e.sent,n=_.default().isStandalone(),t&&n&&this.openLeelooTab("current"),_.default().isStandalone()||w.getInstance().init(),w.getInstance().sendOrderToCpp({action:"event",eventType:"INIT"},_.default().getDefaultTabId(),"fromExtensionToCpp"),_.default().isStandalone()||(O.InstallerLog.getInstance().loadInstallerId(),x.isOSX()&&w.getInstance().onWebSocketWorking()),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e,this)})))})).then((function(t){return e._checkExtensionModeSwitch(t),t})).then((function(t){return e.checkIfExtensionMigratedToStandalone(),t})).then((function(t){return e.sendVersionInstallerLog(),t})).then((function(t){return p(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.default().isStandalone()){e.next=13;break}return e.prev=1,e.next=4,P.getAsyncStorageInstance().set("options.standalone",!1);case 4:e.next=13;break;case 6:throw e.prev=6,e.t0=e.catch(1),n=e.t0.message,r="Initialization error: ".concat("string"==typeof n?n:"Unknown error"),J.exceptionLog({code:X.ExceptionCode.Error,fileName:"ChromeExtension/background/Controller.ts",funcName:"init",message:r}),new Error(r);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,null,[[1,6]])})))})).then((function(t){return e.processWebAccountCreation(),e.initToolbarButtonHandlers(),e.initOriginalsTabs(),e.initCommunication(),e.initializeTabOpenCloseChangeHandlers(),e.initSetUninstallURLHandler(),e.disableBrowserPasswordManager(),e.updateToolbarButtonStyle({userLoggedIn:e.userLoggedIn}),A.default(),t})).then((function(t){return e.storeInstallTimestamp(),e.cacheAccountCreationBadgeSet(),t})).then((function(t){return e.storeExtensionVersion(t)}))}},{key:"reinit",value:function(){var e=this;return this._switchExtensionModeIfNeededForOpenTabs().then((function(){S.default().clearOrderMessageBuffer(),R.default().hideAllWebUIs(),R.default().closeAll(!0),e.initOriginalsTabs(),w.getInstance().sendOrderToCpp({action:"event",eventType:"INIT"},_.default().getDefaultTabId(),"fromExtensionToCpp")}))}},{key:"onAuthStatusChange",value:function(e){var t;if(!this.userLoggedIn&&e){var n=null===(t=this._premiumStatus)||void 0===t?void 0:t.spaces;if(n){var r=n.find((function(e){return"accepted"===e.status})),o=null==r?void 0:r.info.forceAutomaticLogout;o&&this.addInactivityListener(o)}}else this.removeInactivityListener()}},{key:"getExtensionId",value:function(){return chrome.runtime.id}},{key:"getExtensionDetailUrl",value:function(){return v.browser.isChrome()?"chrome://extensions/?id=".concat(this.getExtensionId()):v.browser.isChromiumEdge()?"edge://extensions/?id=".concat(this.getExtensionId()):v.browser.isOpera()?"opera://extensions/?id=".concat(this.getExtensionId()):""}},{key:"signalExtensionMigration",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.getAsyncStorageInstance().get("options.standalone");case 3:if(!e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,P.getAsyncStorageInstance().set("isMigrationToStandaloneSwitch",!0);case 8:return e.next=10,P.getAsyncStorageInstance().set("isExtensionMigratedToSAEX",!0);case 10:return e.next=12,this.signalExtensionModeSwitch("standalone");case 12:O.InstallerLog.getInstance().sendInstallerLog("79.2",{action:"switch_request"}),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(0),t="[SAEXMigration] - signalExtensionMigration: ".concat(e.t0),J.exceptionLog({code:X.ExceptionCode.Error,fileName:"ChromeExtension/background/Controller.ts",funcName:"signalExtensionMigration",message:t}),O.InstallerLog.getInstance().sendInstallerLog("79.4",{action:"switch_failed",error_type:t});case 20:case"end":return e.stop()}}),e,this,[[0,15]])})))}},{key:"checkIfExtensionMigratedToStandalone",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.getAsyncStorageInstance().get("isMigrationToStandaloneSwitch");case 3:if(t=e.sent,n=_.default().isStandalone(),!t||n){e.next=10;break}return r="[SAEXMigration] - checkIfExtensionMigratedToStandalone: isMigrationToStandaloneSwitch set to true though extension is in desktop mode",J.exceptionLog({code:X.ExceptionCode.Error,fileName:"ChromeExtension/background/Controller.ts",funcName:"checkIfExtensionMigratedToStandalone",message:r}),O.InstallerLog.getInstance().sendInstallerLog("79.4",{action:"switch_failed",error_type:r}),e.abrupt("return");case 10:if(!t||!n){e.next=15;break}return this.openNewTabWithUrl("https://www.dashlane.com/extension/migration"),e.next=14,P.getAsyncStorageInstance().remove("isMigrationToStandaloneSwitch");case 14:O.InstallerLog.getInstance().sendInstallerLog("79.3",{action:"switch_confirm"});case 15:e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),o="[SAEXMigration] - checkIfExtensionMigratedToStandalone: ".concat(e.t0),J.exceptionLog({code:X.ExceptionCode.Error,fileName:"ChromeExtension/background/Controller.ts",funcName:"checkIfExtensionMigratedToStandalone",message:o}),O.InstallerLog.getInstance().sendInstallerLog("79.4",{action:"switch_failed",error_type:o});case 22:case"end":return e.stop()}}),e,this,[[0,17]])})))}},{key:"signalExtensionModeSwitch",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.getAsyncStorageInstance().set("hasSwitchedExtensionMode",!0);case 2:return t.next=4,P.getAsyncStorageInstance().set("options.standalone","standalone"===e);case 4:case"end":return t.stop()}}),t)})))}},{key:"switchExtensionModeIfNeeded",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=_.default().isStandalone()?"standalone":"desktop",e){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.signalExtensionModeSwitch(e);case 5:if(n!==e){t.next=7;break}return t.abrupt("return");case 7:return this.reloadRuntime(),t.abrupt("return");case 9:case"end":return t.stop()}}),t,this)})))}},{key:"reloadRuntime",value:function(){chrome.runtime.reload()}},{key:"openLeelooTab",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=function(e,t){chrome.windows.getCurrent((function(r){var o=e.filter((function(e){return e.active})),a=o.find((function(e){return e.windowId===r.id}))||o[o.length-1]||e[e.length-1];if(a.windowId!==r.id&&chrome.windows.update(a.windowId,{focused:!0}),a.id){var s=n?null:{url:i};chrome.tabs.update(a.id,Object.assign({active:!0},s),t)}}))},r=function(e){return"#".concat(e)},o=(n="current"===e)?"":r(e),i="".concat("../index.html").concat(o),t.next=8,this.getLeelooTabs();case 8:return s=t.sent,t.abrupt("return",new Promise((function(e,t){var n=function(){chrome.runtime.lastError?t(chrome.runtime.lastError):e()};s&&s.length?a(s,n):chrome.tabs.create({url:i},n)})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"closeAllLeelooTabs",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLeelooTabs();case 2:if((t=e.sent)&&t.length){e.next=5;break}return e.abrupt("return");case 5:return n=t.reduce((function(e,t){return t.id&&t.id!==chrome.tabs.TAB_ID_NONE?[].concat(o(e),[t.id]):e}),[]),e.abrupt("return",new Promise((function(e,t){chrome.tabs.remove(n,(function(){chrome.runtime.lastError?t(chrome.runtime.lastError):e()}))})));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getLeelooTabs",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=chrome.runtime.getURL(""),n=function(e){return e.url!==_.default().getPopupUrl()},e.abrupt("return",new Promise((function(e,r){chrome.tabs.query({url:"".concat(t,"*")},(function(o){chrome.runtime.lastError?r(chrome.runtime.lastError):o.length?e(o.filter(n)):chrome.tabs.query({},(function(o){if(chrome.runtime.lastError)r(chrome.runtime.lastError);else{var i=o.filter((function(e){return"string"==typeof e.url&&e.url.startsWith(t)})).filter(n);e(i)}}))}))})));case 3:case"end":return e.stop()}}),e)})))}},{key:"clean",value:function(){this._popoverState=null}},{key:"activateOnboardingTab",value:function(){chrome.tabs.query({url:["https://www.dashlane.com/*","https://dashlane.com/*"]},(function(e){e.forEach((function(e){if(e.url&&e.id&&/^https:\/\/[www.]*\.dashlane\.com\/(\w{2}\/)?(gettingstarted)/.test(e.url)){chrome.tabs.update(e.id,{selected:!0});var t=e.windowId;e.windowId!==chrome.windows.WINDOW_ID_CURRENT&&chrome.windows.update(t,{focused:!0})}}))}))}},{key:"socketWorking",value:function(){x.isWindows()&&w.getInstance().onWebSocketWorking();var e=this.waitForInitSocket;u(f(d.prototype),"socketWorking",this).call(this),x.isWindows()&&e&&this.reinit()}},{key:"processWebAccountCreation",value:function(){var e=this,t=function(e){chrome.tabs.query({url:"*://*.dashlane.com/*?*postinstall-focus*"},(function(t){if(0===t.length)return e();!function(e,t){0!==e.length&&chrome.windows.getCurrent((function(n){var r=n.id,o=e.filter((function(e){return e.windowId===r}));t(o[0]||e[0])}))}(t,e)}))};chrome.runtime.onInstalled&&chrome.runtime.onInstalled.addListener((function(n){"install"===n.reason&&t((function(t){var n;t&&(function(t){t.id&&e.executeScriptInTab(t,"window.dashlaneExtensionInstalled = true;typeof window.onDashlaneExtensionInstall === 'function' && window.onDashlaneExtensionInstall();")}(t),n="https://chrome.google.com/webstore/*/"+chrome.runtime.id,chrome.tabs.query({url:n},(function(e){0!==e.length&&(e.length>1||e[0].id&&chrome.tabs.remove(e[0].id))})),function(e){e.id&&(chrome.tabs.update(e.id,{active:!0}),chrome.windows.update(e.windowId,{focused:!0}))}(t))}))}))}},{key:"initializeTabOpenCloseChangeHandlers",value:function(){var e=this;chrome.tabs.onCreated.addListener((function(t){t.active?e.onTabOpen(t):O.Logger.getInstance().log("chrome.tabs.onCreated: tab ".concat(t.id," created but it is not active, not doing anything"),2)})),chrome.tabs.onRemoved.addListener((function(t){e.onTabClose(R.default().getControllerById(t))})),chrome.tabs.onActivated.addListener((function(t){e._getOrCreateTabController(t.tabId,(function(t){e.onTabSelect(t)}))})),chrome.tabs.onUpdated.addListener((function(t,n,r){e._getOrCreateTabController(t,(function(e){e&&e.updateTab(r)})),e.handleTryAutofillOnboardingStep(r.url);var o="string"==typeof r.url&&(r.url.startsWith("http://")||r.url.startsWith("https://"));chrome.tabs.insertCSS&&o&&n.status&&"loading"===n.status&&chrome.tabs.insertCSS(t,{cssOrigin:"user",file:"./styles/webui-frame.css",runAt:"document_start"})}))}},{key:"initSetUninstallURLHandler",value:function(){_.default().isStandalone()&&T.carbon().getAnonymousLogsMetadata(null).then((function(e){var t=e.anonymouscomputerid,n="https://www.dashlane.com/feedback?platform=server_standalone&aci=".concat(t);chrome.runtime.setUninstallURL&&chrome.runtime.setUninstallURL(n)}))}},{key:"initToolbarButtonHandlers",value:function(){chrome.browserAction.onClicked.addListener(g.throttle(this._extensionClickedHandler.bind(this),3e3))}},{key:"askToResetAccountCreationBadge",value:function(e){this._isAccountCreationBadgeShowing&&(this._isAccountCreationBadgeShowing=!1,"click"===e&&this.updateToolbarButtonStyle({userLoggedIn:!1}),this.sendAccountCreationBadgeInstallerLog({action:e}))}},{key:"onTabOpen",value:function(e){if(_.default().isStandalone()){this.getShouldUserSeeAccountCreationBadge()&&(P.getSyncStorageInstance().set("hasAccountCreationBadgeBeenSet",!0),this._hasAccountCreationBadgeBeenSet=!0,this._isAccountCreationBadgeShowing=!0,this.updateToolbarButtonStyle({userLoggedIn:!1,showBadge:!0}),this.sendAccountCreationBadgeInstallerLog({action:"show"}));var t=this.getWebOnboardingMode();t&&(t.flowLoginCredentialOnWeb||t.flowSaveCredentialOnWeb)&&this._deleteCookiesForOnboarding(e)}}},{key:"onTabClose",value:function(e){null!==e&&e.close()}},{key:"onTabSelect",value:function(e){null!==e&&(R.default().previousSelectedTabBecomeInactive(e),R.default().newSelectedTabBecomeActive(e))}},{key:"initOriginalsTabs",value:function(){chrome.tabs.query({active:!0,url:["http://*/*","https://*/*"]},(function(e){e.forEach((function(e){var t=e.id;if(t){var n,r=R.default().getControllerById(t)||new k.ChromeTabController(t,e);O.Logger.getInstance().log("tab #".concat(t," - Manually injecting script since it was not done on launch"),1,"backgnd"),("string"!=typeof(n=r.tabPanel.url)||!n.startsWith("https://chrome.google.com/webstore")&&!n.startsWith("https://microsoftedge.microsoft.com/addons/"))&&chrome.tabs.executeScript(t,{allFrames:!0,file:"/content/contentScripts/".concat("kwift.CHROME.min.js"),runAt:"document_end"},(function(){chrome.runtime.lastError&&J.exceptionLog({funcName:"initOriginalsTabs",fileName:"ChromeExtension/background/controller/Controller.ts",code:X.ExceptionCode.Error,message:"Can't inject content script in tab: ".concat(chrome.runtime.lastError.message),type:"extensionException"})}))}}))}))}},{key:"getOnboardingDomainFromUrl",value:function(e){var t=["netflix.com","facebook.com","twitter.com","live.com","spotify.com","google.com","linkedin.com","paypal.com","instagram.com","amazon.com"].filter((function(t){return e.includes(t)}));return t&&t.length?t[0]:null}},{key:"removeCookiesForDomain",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=V,t.next=3,V.getCookiesForDomain(e);case 3:return t.t1=t.sent,t.next=6,t.t0.removeCookiesForDomain.call(t.t0,t.t1);case 6:case"end":return t.stop()}}),t)})))}},{key:"getGeneratedPasswords",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.extensionCarbonConnector.getGeneratedPasswords({sortToken:{sortCriteria:[{field:"generatedDate",direction:"descend"}],uniqField:"id"},filterToken:{filterCriteria:[]},limit:20});case 2:t=e.sent,this.postMessageToPopover(j.ExtensionPopupActions.GeneratedPasswords,{data:t});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"changeLanguage",value:function(){L.getInstance().log(4,"changeLanguage","backgroundToPopup");var e=E.getInstance().getLang();this.postMessageToPopover(j.ExtensionPopupActions.ChangeLangage,{lang:e})}},{key:"postMessageToPopover",value:function(e,t){this.tryPostMessageToPopover(e,t,0)}},{key:"shouldDisplayNotificationBadge",value:function(){var e;return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_.default().isStandalone()){t.next=2;break}return t.abrupt("return",!1);case 2:return n=V.getPremiumStatusCode(this._premiumStatus),r=V.getPremiumEndDate(this._premiumStatus),t.next=6,H.shouldDisplayChurnedPremiumDiscountNotification({premiumStatusCode:n,premiumEndDate:r});case 6:if(!t.sent){t.next=8;break}return t.abrupt("return",!0);case 8:return o=Boolean(null===(e=this._premiumStatus)||void 0===e?void 0:e.autoRenewalFailed),t.next=11,P.getAsyncStorageInstance().get("PremiumChurningAlertDismissDate");case 11:return i=t.sent,t.next=14,z.shouldDisplayPaymentFailureNotification({paymentFailureChurningAlertDismissDate:i,hasPaymentFailure:o,premiumStatusCode:n,premiumEndDate:r});case 14:if(!t.sent){t.next=17;break}return this.sendUsageLog({type:"paymentFailureRedDot",action:"displayed"}),t.abrupt("return",!0);case 17:return t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this)})))}},{key:"getIconName",value:function(e){var t=e.userLoggedIn,n=e.showBadge;return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=window.matchMedia("(prefers-color-scheme: dark)").matches,o=r?"dark":"light",i=chrome.runtime.getManifest().name.includes("Nightly"),a=i?"icon_nightly":"icon",!t){e.next=12;break}if(void 0!==n){e.next=9;break}return e.next=8,this.shouldDisplayNotificationBadge();case 8:n=e.sent;case 9:if(!n){e.next=11;break}return e.abrupt("return","".concat(o,"/").concat(a,"_notifications"));case 11:return e.abrupt("return","".concat(o,"/").concat(a,"_active"));case 12:if(!n){e.next=14;break}return e.abrupt("return","".concat(o,"/").concat(a,"_notifications"));case 14:return e.abrupt("return","".concat(o,"/icon_inactive"));case 15:case"end":return e.stop()}}),e,this)})))}},{key:"updateToolbarButtonStyle",value:function(e){var t=e.userLoggedIn,n=e.showBadge;if(this._popupPort)try{L.getInstance().log(4,"init...","backgroundToPopup"),this.sendLoginListToPopover()}catch(e){J.exceptionLog({funcName:"updateToolbarButtonStyle",fileName:"ChromeExtension/background/controller/Controller.ts",code:X.ExceptionCode.Error,message:"Error calling sendLoginListToPopover: ".concat(e.message),type:"extensionException"})}chrome.browserAction.setBadgeText({text:""}),chrome.browserAction.setTitle({title:"Dashlane"}),chrome.browserAction.setPopup({popup:t||_.default().isStandalone()?_.default().getPopupUrl():""}),this.getIconName({userLoggedIn:t,showBadge:n}).then((function(e){chrome.browserAction.setIcon({path:{19:"skin/icon/".concat(e,".png"),38:"skin/icon/".concat(e,"@2x.png")}})}))}},{key:"updateWebOnboardingMode",value:function(e){this._webOnboardingMode=e,T.maverick().updateWebOnboardingMode({type:"updateWebOnboardingMode",webOnboardingMode:e})}},{key:"getWebOnboardingMode",value:function(){return this._webOnboardingMode}},{key:"openNewTabWithUrl",value:function(e){chrome.windows.getAll({windowTypes:["normal"]},(function(t){0===t.length?chrome.windows.create({url:e}):chrome.tabs.create({url:e})}))}},{key:"openNewTabWithInternalPage",value:function(e){var t=chrome.runtime.getURL(e);this.openNewTabWithUrl(t)}},{key:"openCurrentTabWithUrl",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.default().getCurrentTabController();case 2:if(!(n=t.sent)){t.next=8;break}if((r=n.getTab()).id){t.next=7;break}return t.abrupt("return");case 7:chrome.tabs.update(r.id,{url:e});case 8:case"end":return t.stop()}}),t)})))}},{key:"openTabWithUrl",value:function(e,t){var n=R.default().getControllerById(e);if(n){var r=n.getTab();r.id&&chrome.tabs.update(r.id,{url:t})}}},{key:"removeTab",value:function(e){chrome.tabs.remove(e)}},{key:"removeTabWithInternalUrl",value:function(e){var t=chrome.runtime.getURL(e),n="".concat(t,"*");chrome.tabs.query({url:n},(function(e){e&&1===e.length&&e[0].id&&chrome.tabs.remove(e[0].id)}))}},{key:"disableBrowserPrivacyFeature",value:function(e){chrome.privacy&&chrome.privacy.services&&chrome.privacy.services[e]&&chrome.privacy.services[e].get({},(function(t){["controlled_by_this_extension","controllable_by_this_extension"].includes(t.levelOfControl)?chrome.privacy.services[e].set({value:!1},(function(){if(chrome.runtime.lastError){var t=chrome.runtime.lastError,n=(void 0===t?{}:t).message,r=void 0===n?"Unknown error":n;O.Logger.getInstance().log("Error while disabling ".concat(e,": ").concat(r),0)}})):O.Logger.getInstance().log("Insufficient control level to change ".concat(e," setting: ").concat(t.levelOfControl),0)}))}},{key:"disableBrowserPasswordManager",value:function(){this.disableBrowserPrivacyFeature("autofillAddressEnabled"),this.disableBrowserPrivacyFeature("autofillCreditCardEnabled"),this.disableBrowserPrivacyFeature("passwordSavingEnabled"),this.disableBrowserPrivacyFeature("autofillEnabled")}},{key:"executeScriptInTab",value:function(e,t){var n,r,o;if(!e.id)throw new Error("A tab with an id expected");chrome.tabs.executeScript(e.id,{code:"var s = document.createElement('script');s.textContent = '"+(n=t,r={"\\":"\\\\",'"':'\\"',"'":"\\'","\n":"\\n","\r":"\\r","\u2028":"\\u2028","\u2029":"\\u2029"},o=new RegExp("["+Object.keys(r).join("")+"]","g"),n.replace(o,(function(e){return r[e]}))+"';document.head.appendChild(s);")})}},{key:"initCommunication",value:function(){var e=this;chrome.runtime.onConnect.addListener((function(t){var n=t.name;if(!["Popup","leeloo","PasswordChangerContentScriptChromeChannel"].includes(n)){var r=I.getSenderUrl(t);if(I.isConnectionAllowed({originUrl:r,portName:t.name})){var o=I.makePortIdentifier(n);switch(o){case"popup":e._setupPopupCommunication(t);break;case"fromInjectedTo":e._setupInjectedCommunicationChannelForMainFrame(t);break;case"fromInjectedFrame":e._setupInjectedCommunicationChannelForFrame(t);break;case"webui":e._setupWebuiCommunication(t);break;default:J.exceptionLog({funcName:"initCommunication",fileName:"ChromeExtension/background/controller/Controller.ts",code:X.ExceptionCode.Error,message:"Untreated port identifier: ".concat(o),type:"extensionException"})}}}}))}},{key:"askForInitialData",value:function(){var e=this.getInitialData();e&&(this.postMessageToPopover(j.ExtensionPopupActions.PopoverV2SignalDataRefresh,{data:e}),b.performanceMethods.measure("sending cached initial data to the Popup",b.PerformanceMarker.POPUP_INITIAL_DATA_REQUEST)),F.getInitialData()}},{key:"sendLoginListToPopover",value:function(){this._popupPort&&this.postMessageToPopover(j.ExtensionPopupActions.LoginsLists,{userLoggedIn:this.userLoggedIn,logins:this.authUsers,userLogin:this.userLogin,lastLogin:this.lastLogin,localAccountsList:this.localAccountsList,currentLoginStep:q.default.sendOnGoingStepToPopup()})}},{key:"sendSUSSurveyInfoToPopover",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.getSyncStorageInstance().get("installStartDate"),e.next=3,T.extensionCarbonConnector.getSurveyUrl({type:h.NotificationName.SUSSurvey,osName:_.default().getOSName(),browser:_.default().getBrowser(),country:_.default().getBrowserCountry(),language:_.default().getBrowserLanguage(),isStandalone:_.default().isStandalone(),extensionInstallDate:t});case 3:n=e.sent,this.postMessageToPopover(j.ExtensionPopupActions.SUSSurveyInfoChanged,{data:n});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"sendVaultChurnedDiscountToPopover",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=V.getPremiumStatusCode(this._premiumStatus),n=V.getPremiumEndDate(this._premiumStatus),e.next=4,H.shouldDisplayVaultChurnedDiscount({premiumEndDate:n,premiumStatusCode:t});case 4:r=e.sent,this.postMessageToPopover(j.ExtensionPopupActions.ShouldDisplayVaultChurnedDiscount,{data:r});case 6:case"end":return e.stop()}}),e,this)})))}},{key:"sendMoreToolsChurnedDiscountToPopover",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=V.getPremiumStatusCode(this._premiumStatus),n=V.getPremiumEndDate(this._premiumStatus),e.next=4,H.shouldDisplayMoreToolsChurnedDiscount({premiumEndDate:n,premiumStatusCode:t});case 4:r=e.sent,this.postMessageToPopover(j.ExtensionPopupActions.ShouldDisplayMoreToolsChurnedDiscount,{data:r});case 6:case"end":return e.stop()}}),e,this)})))}},{key:"sendActiveTabInfoToPopover",value:function(){var e;return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.default().getCurrentTabController();case 2:n=t.sent,r=null!==(e=null==n?void 0:n.getLocation())&&void 0!==e?e:"",o=G.getValidWebsiteDomainFromFullUrl(r),this.postMessageToPopover(j.ExtensionPopupActions.ActiveTabInfo,{data:{url:o}});case 6:case"end":return t.stop()}}),t,this)})))}},{key:"sendChurnedPremiumSurveyInfoToPopover",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.extensionCarbonConnector.getSurveyUrl({type:h.NotificationName.ChurnedPremiumSurvey,osName:_.default().getOSName(),browser:_.default().getBrowser(),country:_.default().getBrowserCountry(),language:_.default().getBrowserLanguage()});case 2:t=e.sent,this.postMessageToPopover(j.ExtensionPopupActions.ChurnedPremiumSurveyInfoChanged,{data:t});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"sendIsPaymentFailureChurningDismissedForOneDay",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getAsyncStorageInstance().get("PremiumChurningAlertDismissDate");case 2:t=e.sent,n=void 0!==t&&"number"==typeof t&&z.isDismissedForOneDay(t),this.postMessageToPopover(j.ExtensionPopupActions.IsPaymentFailureChurningDismissedForOneDay,{data:n});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"savePaymentFailureChurningDismissDate",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getAsyncStorageInstance().set("PremiumChurningAlertDismissDate",Date.now());case 2:case"end":return e.stop()}}),e)})))}},{key:"sendMigrationNotificationToPopover",value:function(){var e=this.migrationAlertController.shouldDisplayAlert(this.getAccountFeatures());this.postMessageToPopover(j.ExtensionPopupActions.ShouldDisplayMigrationAlert,{data:e})}},{key:"sendMigrationSwitchNotificationToPopover",value:function(){var e=this.migrationSwitchAlertController.shouldDisplayAlert(this.getAccountFeatures());this.postMessageToPopover(j.ExtensionPopupActions.ShouldDisplayMigrationSwitchAlert,{data:e})}},{key:"isPopoverOpen",value:function(){return void 0!==this._popupPort}},{key:"getPasswordChangeEnvironmentFactory",value:function(){return{create:K.createChromeTabEnvironment}}},{key:"tryPostMessageToPopover",value:function(e,t,n){var r=this,o=void 0===n?0:n;o>10?O.Logger.getInstance().log("Controller.postMessageToPopover FAILED ["+o+"]: "+e,0):this.postMessageToPopoverOnce(e,t,(function(n){n?n.message===Q&&setTimeout((function(){r.tryPostMessageToPopover(e,t,++o)}),50):L.getInstance().log(4,e,"backgroundToPopup")}))}},{key:"postMessageToPopoverOnce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},r=Object.assign(Object.assign({},t),{action:e});if(this._popupPort)try{r.type=e,this._popupPort.postMessage(JSON.stringify(r)),n()}catch(e){n(e)}else n(new Error(Q))}},{key:"_setupWebuiCommunication",value:function(e){var t=$(e);if(!t)throw new Error("There was no tab for this port");var n=R.default().getControllerById(t);if(!n)throw new Error("No tab controller for tab id");n.initWebUICommunication(e)}},{key:"_setupPopupCommunication",value:function(e){var t=this;this._popupPort&&(this._popupPort.onDisconnect.removeListener(this._onPopupDisconnect),delete this._popupPort),this._popupPort=e,this._popupPort.onDisconnect.addListener(this._onPopupDisconnect),L.getInstance().log(4,"init...","backgroundToPopup"),this._popupPort.onMessage.addListener((function(e){return p(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i,a,s,u,c,l,d,f,p,g,h=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:L.getInstance().log(4,e.action,"popupToBackground"),t.t0=e.action,t.next=t.t0===j.PopupExtensionActions.GetLanguage?4:t.t0===j.PopupExtensionActions.GetLastState?6:t.t0===j.PopupExtensionActions.GetGeneratedPasswords?8:t.t0===j.PopupExtensionActions.OpenApplication?10:t.t0===j.PopupExtensionActions.Login?12:t.t0===j.PopupExtensionActions.Logout?15:t.t0===j.PopupExtensionActions.Reload?19:t.t0===j.PopupExtensionActions.Support?21:t.t0===j.PopupExtensionActions.WhatsNew?24:t.t0===j.PopupExtensionActions.MlEngineInfo?27:t.t0===j.PopupExtensionActions.Referral?29:t.t0===j.PopupExtensionActions.GetExtensionInfo?32:t.t0===j.PopupExtensionActions.OpenExtensionInfo?36:t.t0===j.PopupExtensionActions.OpenChurnedDiscount?39:t.t0===j.PopupExtensionActions.Refresh?42:t.t0===j.PopupExtensionActions.SaveState?45:t.t0===j.PopupExtensionActions.UsageLog?48:t.t0===j.PopupExtensionActions.GetUserMessages?51:t.t0===j.PopupExtensionActions.DismissUserMessage?53:t.t0===j.PopupExtensionActions.InstallerLog?55:t.t0===j.PopupExtensionActions.InitialData?57:t.t0===j.PopupExtensionActions.AutologinCredential?60:t.t0===j.PopupExtensionActions.OpenUrl?62:t.t0===j.PopupExtensionActions.GeneratePassword?64:t.t0===j.PopupExtensionActions.CopyPassword?66:t.t0===j.PopupExtensionActions.FillPassword?68:t.t0===j.PopupExtensionActions.SaveDefaults?70:t.t0===j.PopupExtensionActions.ChangeDashlaneSettings?72:t.t0===j.PopupExtensionActions.GetPasswordGenerationSettings?74:t.t0===j.PopupExtensionActions.GetSubscriptionCode?76:t.t0===j.PopupExtensionActions.GetWebOnboardingMode?78:t.t0===j.PopupExtensionActions.SetWebOnboarding?80:t.t0===j.PopupExtensionActions.GetCurrentTabInfo?82:t.t0===j.PopupExtensionActions.GetActiveTabInfo?84:t.t0===j.PopupExtensionActions.OpenSession?86:t.t0===j.PopupExtensionActions.CloseSession?88:t.t0===j.PopupExtensionActions.GetPremiumStatus?90:t.t0===j.PopupExtensionActions.DismissSUSSurvey?92:t.t0===j.PopupExtensionActions.GetSurveyInfo?97:t.t0===j.PopupExtensionActions.GetShouldDisplayVaultChurnedDiscount?100:t.t0===j.PopupExtensionActions.GetShouldDisplayMoreToolsChurnedDiscount?103:t.t0===j.PopupExtensionActions.GetChurnedPremiumSurveyInfo?105:t.t0===j.PopupExtensionActions.DismissChurnedPremiumDiscountNotification?108:t.t0===j.PopupExtensionActions.DismissChurnedPremiumSurvey?111:t.t0===j.PopupExtensionActions.GetIsPaymentFailureChurningDismissedForOneDay?116:t.t0===j.PopupExtensionActions.SavePaymentFailureChurningDismissDate?119:t.t0===j.PopupExtensionActions.GetShouldDisplayMigrationNotification?122:t.t0===j.PopupExtensionActions.DismissMigrationNotification?124:t.t0===j.PopupExtensionActions.GetShouldDisplayMigrationSwitchNotification?126:t.t0===j.PopupExtensionActions.GetIsUserUsingMlEngine?128:t.t0===j.PopupExtensionActions.SwitchToMlAnalysisEngine?131:134;break;case 4:return this.changeLanguage(),t.abrupt("break",135);case 6:return this.postMessageToPopover(j.ExtensionPopupActions.RestoreState,{data:this._popoverState}),t.abrupt("break",135);case 8:return this.getGeneratedPasswords(),t.abrupt("break",135);case 10:return this.openApplication({origin:"Popup",link:e.link,identifier:e.subPath}),t.abrupt("break",135);case 12:return this.setUserData(y.emptyData()),this.requestLogin({}),t.abrupt("break",135);case 15:return this.setUserData(y.emptyData()),R.default().hideAllWebUIs(),this.requestLogout(),t.abrupt("break",135);case 19:return this.reloadRuntime(),t.abrupt("break",135);case 21:return this.openNewTabWithUrl("https://support.dashlane.com/hc/?utm_source=extension"),t.abrupt("break",135);case 24:return this.openNewTabWithUrl("https://support.dashlane.com/hc/articles/360014075119?utm_source=extension"),t.abrupt("break",135);case 27:return this.openNewTabWithUrl("https://support.dashlane.com/hc/en-us/articles/360006828759"),t.abrupt("break",135);case 29:return n=this.getReferralUrl(),this.openNewTabWithUrl(n),t.abrupt("break",135);case 32:return r=""!==this.getExtensionDetailUrl(),o=_.default().getBuildVersions().extension,this.postMessageToPopover(j.ExtensionPopupActions.ExtensionInfo,{data:{version:o,canOpenDetailPage:r}}),t.abrupt("break",135);case 36:return""!==(i=this.getExtensionDetailUrl())&&this.openNewTabWithUrl(i),t.abrupt("break",135);case 39:return a=this.getChurnedDiscountUrl(),this.openNewTabWithUrl(a),t.abrupt("break",135);case 42:return U.isNativeAppAvailable()&&this.requestLogin({}),this.sendLoginListToPopover(),t.abrupt("break",135);case 45:return s=e.key,u=e.data,s?(this._popoverState||(this._popoverState={}),this._popoverState[s]=u):this._popoverState=u,t.abrupt("break",135);case 48:return c=this.getPayload(e),l=c.logAction,d=c.logDetails,f=c.logType,F.sendUsageLog({type:f,action:l,details:d}),t.abrupt("break",135);case 51:return this.triggerUserMessages(),t.abrupt("break",135);case 53:return this.dismissUserMessage(e.type),t.abrupt("break",135);case 55:return O.InstallerLog.getInstance().sendInstallerLog(e.step,e.precisions),t.abrupt("break",135);case 57:return b.performanceMethods.mark(b.PerformanceMarker.POPUP_INITIAL_DATA_REQUEST),this.askForInitialData(),t.abrupt("break",135);case 60:return F.autoLoginPassword({identifier:e.identifier}),t.abrupt("break",135);case 62:return e.url&&this.openNewTabWithUrl(e.url),t.abrupt("break",135);case 64:return F.generatePassword(e),t.abrupt("break",135);case 66:return F.saveGeneratedPassword({password:e.password}),t.abrupt("break",135);case 68:return F.fillPassword({password:e.password}),t.abrupt("break",135);case 70:return F.savePasswordGeneratorOptions(e),t.abrupt("break",135);case 72:return F.changeDashlaneSettings(e),t.abrupt("break",135);case 74:return _.default().isStandalone()&&T.carbon().getPasswordGenerationSettings(null).then((function(e){h.postMessageToPopover(j.ExtensionPopupActions.PasswordGenerationSettings,{data:{avoidAmbiguous:e.avoidAmbiguous,digits:e.digits,length:e.length,letters:e.letters,symbols:e.symbols}})})),t.abrupt("break",135);case 76:return _.default().isStandalone()&&this.postMessageToPopover(j.ExtensionPopupActions.SubscriptionCodeChanged,{data:this.getSubscriptionCode()}),t.abrupt("break",135);case 78:return _.default().isStandalone()&&this.postMessageToPopover(j.ExtensionPopupActions.WebOnboardingModeChanged,{data:this.getWebOnboardingMode()}),t.abrupt("break",135);case 80:return _.default().isStandalone()&&(p=this.getWebOnboardingMode(),g={flowCredentialInApp:!1,flowLoginCredentialOnWeb:!0,flowSaveCredentialOnWeb:!1,popoverStep:e.popoverStep||void 0,leelooStep:null,completedSteps:p&&p.completedSteps||void 0},T.carbon().updateWebOnboardingMode(g),this.postMessageToPopover(j.ExtensionPopupActions.WebOnboardingModeChanged,{data:g})),t.abrupt("break",135);case 82:return F.getWebsiteInfo(),t.abrupt("break",135);case 84:return this.sendActiveTabInfoToPopover(),t.abrupt("break",135);case 86:return W.openSession(e),t.abrupt("break",135);case 88:return _.default().isStandalone()&&T.carbon().closeSession({}),t.abrupt("break",135);case 90:return this.postMessageToPopover(j.ExtensionPopupActions.PremiumStatusChanged,{premiumStatus:this.getPremiumStatus()}),t.abrupt("break",135);case 92:return t.next=94,B.dismissSUSSurvey();case 94:return t.next=96,this.sendSUSSurveyInfoToPopover();case 96:return t.abrupt("break",135);case 97:return t.next=99,this.sendSUSSurveyInfoToPopover();case 99:return t.abrupt("break",135);case 100:return t.next=102,this.sendVaultChurnedDiscountToPopover();case 102:return t.abrupt("break",135);case 103:return this.sendMoreToolsChurnedDiscountToPopover(),t.abrupt("break",135);case 105:return t.next=107,this.sendChurnedPremiumSurveyInfoToPopover();case 107:return t.abrupt("break",135);case 108:return t.next=110,H.dismissChurnedPremiumDiscountNotification();case 110:return t.abrupt("break",135);case 111:return t.next=113,H.dismissChurnedPremiumSurvey();case 113:return t.next=115,this.sendChurnedPremiumSurveyInfoToPopover();case 115:return t.abrupt("break",135);case 116:return t.next=118,this.sendIsPaymentFailureChurningDismissedForOneDay();case 118:return t.abrupt("break",135);case 119:return t.next=121,this.savePaymentFailureChurningDismissDate();case 121:return t.abrupt("break",135);case 122:return this.sendMigrationNotificationToPopover(),t.abrupt("break",135);case 124:return this.migrationAlertController.dismiss(),t.abrupt("break",135);case 126:return this.sendMigrationSwitchNotificationToPopover(),t.abrupt("break",135);case 128:return t.next=130,this.sendIsUserUsingMlEngineToPopover();case 130:return t.abrupt("break",135);case 131:return t.next=133,this.switchToMlAnalysisEngine();case 133:case 134:return t.abrupt("break",135);case 135:case"end":return t.stop()}}),t,this)})))}))}},{key:"_shouldFocusOnTab",value:function(e){return v.browser.isChrome()&&e.highlighted||!v.browser.isChrome()&&(e.highlighted||e.selected)}},{key:"_setupInjectedCommunicationChannelForFrame",value:function(e){var t=this;if(!e.sender)throw new Error("There was no sender in the port");if(void 0===e.sender.frameId)throw new Error("There was no frameId in the sender");var n=e.sender.frameId,r=e.name.split("_kw_");if(r.length<3)console.error("Incorrect port name");else{var o={frameUniqueId:r[0],frameUrl:r[1],frameName:r[2]},i=$(e);if(!i)throw new Error("There was no tab for this port, should not happen");var a=R.default().getControllerById(i);if(a){var s,u=a.getFrameControllerByFrameUniqueId(o.frameUniqueId)||(s=new C.ChromeFrameController(a,null),a.addFrame(s),s),c=new N.PortInstanceChannel(e),l=D.createEventBus({events:N.events,channels:[c]});c.onDisconnect((function(){a.removeFrameControllerByFrameUniqueId(o.frameUniqueId)})),u.setInformations(o),u.initCommunicationChannel(l,n).then((function(){var n;a.injectedScriptExecutionAllowed&&u.postMessage({action:"controlMessageToWebpage",demand:"analysisAllowed"}),(null===(n=e.sender)||void 0===n?void 0:n.tab)&&t._shouldFocusOnTab(e.sender.tab)&&a.signalTabFocused()})).catch((function(e){J.exceptionLog({funcName:"initCommunicationChannel",fileName:"Controller.ts",code:X.ExceptionCode.Error,message:"Could not init communication channel with frame: ".concat(e.message),type:"extensionException"})}))}}}},{key:"_setupInjectedCommunicationChannelForMainFrame",value:function(e){var t=this,n=D.createEventBus({events:N.events,channels:[new N.PortInstanceChannel(e)]}),r=$(e);if(!r)throw new Error("There was no tabId in the port");if(!e.sender||!e.sender.tab)throw new Error("There was no sender in the port");if(void 0===e.sender.frameId)throw new Error("There was no frameId in the sender");var o=e.sender.frameId,i=e.sender.tab,a=function(e,t){var n=R.default().getControllerById(e);return n?(n.tabPanel=t,n):new k.ChromeTabController(e,t)}(r,i);a.initCommunicationChannel(n,o).then((function(){a.sendDocumentComplete(),t._shouldFocusOnTab(i)&&a.signalTabFocused(),a.injectedScriptExecutionAllowed&&a.signalInjectedScriptExecutionAllowed()})).catch((function(e){J.exceptionLog({funcName:"initCommunicationChannel",fileName:"Controller.ts",code:X.ExceptionCode.Error,message:"Could not init communication channel with main frame: ".concat(e.message),type:"extensionException"})}))}},{key:"_switchExtensionModeIfNeededForOpenTabs",value:function(){var e=this;return new Promise((function(t,n){chrome.tabs.query({},(function(r){var o=r.map((function(e){return e.url})).filter((function(e){return void 0!==e})),i=e.getExtensionSwitchModeForUrls(o);e.switchExtensionModeIfNeeded(i).then((function(){t()})).catch((function(){n()}))}))}))}},{key:"_handlePairingWebRequest",value:function(){var e;(null===(e=chrome.webRequest)||void 0===e?void 0:e.onBeforeRequest)&&chrome.webRequest.onBeforeRequest.addListener((function(e){if(!chrome.runtime.lastError){var t=/https:\/\/www\.dashlane\.com\/extension\/pairingVerification\.html\?code=(\d{6})/.exec(e.url);if(!t||!t[1]){var n=new Error("Can't get code from pairing URL");return O.Logger.getInstance().logError(n.message,n,0),{}}return chrome.tabs.update(e.tabId,{active:!0,url:chrome.runtime.getURL("pairingVerification.html?code=".concat(t[1]))}),{}}var r=chrome.runtime.lastError,o=(void 0===r?{}:r).message,i=void 0===o?"Unknown error":o;J.exceptionLog({code:X.ExceptionCode.Error,fileName:"ChromeExtension/background/controller/Controller.ts",funcName:"_initializeRequestInterceptors",message:"Problem setting webRequest.onBeforeRequest listener: ".concat(i)})}),{urls:["https://www.dashlane.com/extension/pairingVerification.html?code=*"],types:["main_frame"]},["blocking"])}},{key:"_handleLeelooRedirection",value:function(){var e;(null===(e=chrome.webRequest)||void 0===e?void 0:e.onBeforeRequest)&&[Y.makeInternalLeelooPatterns(),Y.makeExternalLeelooPatterns()].forEach((function(e){var t={urls:e,types:["main_frame"]};chrome.webRequest.onBeforeRequest.addListener(Y.makeLeelooRedirectionHandler(),t,["blocking"])}))}},{key:"_initializeRequestInterceptors",value:function(){if(chrome.webRequest&&chrome.webRequest.onBeforeSendHeaders){var e=chrome.runtime.getURL("");chrome.webRequest.onBeforeSendHeaders.addListener((function(t){return{requestHeaders:t.requestHeaders&&t.requestHeaders.some((function(t){return"origin"===t.name.toLowerCase()&&!!t.value&&e.startsWith(t.value)}))&&t.requestHeaders?t.requestHeaders.filter((function(e){return"cookie"!==e.name.toLowerCase()})):t.requestHeaders}}),{urls:["*://ws1.dashlane.com/*","*://logs.dashlane.com/*","*://kck3hlb9.dashlane.com/*"]},["blocking","requestHeaders"])}_.default().isStandalone()?this._handleLeelooRedirection():this._handlePairingWebRequest()}},{key:"_deleteCookiesForOnboarding",value:function(e){var t=this,n=e.url||e.pendingUrl,r=n&&this.getOnboardingDomainFromUrl(n);r&&n&&this.deleteCookiesForOnboarding({domain:r,url:n}).then((function(){t.openCurrentTabWithUrl(n)}))}},{key:"_getOrCreateTabController",value:function(e,t){var n=this,r=R.default().getControllerById(e);if(r)return t(r);chrome.tabs.get(e,(function(r){n.onTabOpen(r);var o=new k.ChromeTabController(e,r);return t(o)}))}},{key:"_extensionClickedHandler",value:function(e){if(!_.default().isStandalone()){var t=S.default();if(!t.isReadyToSend())return void t.resetCommunication()}this.askToResetAccountCreationBadge("click"),this.userLoggedIn||this.requestLogin({forceLogin:!0})}}])&&s(t.prototype,n),r&&s(t,r),d}(y.Controller);t.SpecificController=Z;var ee=new Z;y.setInstance(ee),t.default=function(){return ee}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;var d=n(56),f=n(70),p=n(212),g=n(118),h=n(108),m=n(141),v=n(339),y=n(11),b=n(69),_=n(151),w=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){var e;return o(this,c),(e=u.apply(this,arguments))._useWebsockets=!1,e._pluginOrMaverickMessageBuffer=[],e}return t=c,(n=[{key:"init",value:function(){var e=this;v.default().init(),v.default().addReadyToSendHandler((function(){e._flushPluginOrMaverickMessageBuffer()})),h.isWindows()&&!b.default().isFirefoxWebExt()?m.makeCommunication({isStandalone:!1}):this._useWebsockets=!0}},{key:"onWebSocketWorking",value:function(){this._useWebsockets=!0,h.isWindows()&&m.killNativeMessagingHost()}},{key:"onWebSocketNotWorking",value:function(){h.isWindows()&&(this._useWebsockets=!1,m.makeCommunication({isStandalone:!1}))}},{key:"sendOrderToJs",value:function(e,t,n){f.default().logOrder(e.action,e,n);var r=g.default().getControllerById(t);r&&r.postMessage(e)}},{key:"sendOrderToAllFrames",value:function(e,t,n){return l(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,i,a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=e,f.default().logOrder(e.action,o,n),r.next=4,_.default().isMarshmallowEnabled();case 4:if(i=r.sent,a=function(t,n){return t._isMeaning||"controlMessageToWebpage"===e.action||n},s=g.default().getControllerById(t)){r.next=9;break}return r.abrupt("return");case 9:try{s.postMessage(o),s.getFrames().filter((function(e){return a(e,i)})).forEach((function(e){return e.postMessage(o)}))}catch(e){}case 10:case"end":return r.stop()}}),r)})))}},{key:"sendOrderToPluginOrMaverick",value:function(e,t){this.isReadyToSendOrders()?this._sendOrderToPluginOrMaverickWithoutBuffer(e,t.toString()):this._pluginOrMaverickMessageBuffer.push({message:e,tabId:t.toString()})}},{key:"isReadyToSendOrders",value:function(){return b.default().isStandalone()||this._useWebsockets&&v.default().isReadyToSend()||!this._useWebsockets&&m.isMessagingAvailable()}},{key:"_sendOrderToPluginOrMaverickWithoutBuffer",value:function(e,t){var n={message:e,tabId:t.toString()},r=b.default().isStandalone()&&y.isMfaOrder(n.message),o=b.default().getPluginFeatures().mfa&&y.isMfaOrder(n.message);r||o?this._sendOrderToMaverick(n):this._sendOrderToPlugin(n)}},{key:"_sendOrderToMaverick",value:function(e){var t={id:-1,message:e.message,tabId:e.tabId};y.sendOrderToMaverick(t)}},{key:"_sendOrderToPlugin",value:function(e){var t={id:this.msgId++,tabId:e.tabId,message:p.treatOrder(e.message)};this._useWebsockets?v.default().send(t,!0):m.isMessagingAvailable()&&m.postMessage(t)}},{key:"_flushPluginOrMaverickMessageBuffer",value:function(){var e=this,t=this._pluginOrMaverickMessageBuffer.slice();this._pluginOrMaverickMessageBuffer=[],t.forEach((function(t){e._sendOrderToPluginOrMaverickWithoutBuffer(t.message,t.tabId)}))}}])&&i(t.prototype,n),r&&i(t,r),c}(d.OrderSender));d.setInstance(w),t.getInstance=function(){return w}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.persistPairingDataIfAllPartiesConfirmed=void 0;var r=n(30);t.persistPairingDataIfAllPartiesConfirmed=function(e,t){r.Logger.getInstance().log("[persistPairingDataIfAllPartiesConfirmed] Checking if confirmed",3),t.isConfirmed()&&(r.Logger.getInstance().log("[persistPairingDataIfAllPartiesConfirmed] CONFIRMED",3),e.persistPairingDataToStorage())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeExtensionUrl=t.makePortIdentifier=t.isConnectionAllowed=t.isConnectionPreAuthorized=t.isFromInjectedFrame=t.getSenderUrl=void 0;var r=n(6),o=n(150),i=n(1);t.getSenderUrl=function(e){var t,n,r=(null===(t=e.sender)||void 0===t?void 0:t.url)?e.sender:null===(n=e.sender)||void 0===n?void 0:n.tab;return"string"==typeof(null==r?void 0:r.url)?r.url:""};t.isFromInjectedFrame=function(e){return e.startsWith("fromInjectedFrame")};function a(e){var n=e.portName;return t.isFromInjectedFrame(n)||function(e){return e.startsWith("fromInjectedTo")}(n)}t.isConnectionPreAuthorized=a,t.isConnectionAllowed=function(e){var t=e.originUrl,n=e.portName;if(a({portName:n}))return!0;var s=chrome.runtime.getURL("");if(t.startsWith(s))return!0;var u="A script outside of the extension (origin: ".concat(t,") is trying to connect to port ").concat(n);return o.getInstance().log(0,u,"isConnectionTrusted"),r.exceptionLog({funcName:"isConnectionTrusted",fileName:"ChromeExtension/helpers.ts",code:i.ExceptionCode.Error,message:u,type:"extensionException"}),!1};t.makePortIdentifier=function(e){return function(e){return e.startsWith("wui_")}(e)?"webui":t.isFromInjectedFrame(e)?"fromInjectedFrame":e},t.makeExtensionUrl=function(e){var t=new URL(e),n=t.search,r=t.hash,o="".concat("index.html").concat(n).concat(r);return chrome.runtime.getURL(o)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAnonymousApplicationId=t.getAnonymousApplicationId=void 0;var r=n(35);t.getAnonymousApplicationId=function(){return r.getSyncStorageInstance().get("anonymousApplicationId")},t.setAnonymousApplicationId=function(e){r.getSyncStorageInstance().set("anonymousApplicationId",e)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.getMfaControllerInstance=t.setMfaControllerInstance=t.isMfaControllerInstanceSet=t.MaverickForAllController=void 0;var d=n(193),f=n(56),p=n(713),g=n(6),h=n(1),m=function(){function e(){u(this,e),this._cache={},this._startCacheGarbageCollect()}return l(e,[{key:"_getCacheEntry",value:function(e,t){var n=e&&this._cache[e];return e&&n&&!this._isCacheEntryStale(e,t)?n.entry:null}},{key:"_addToCache",value:function(e,t){this._cache[e]={entry:t,entryDate:+new Date}}},{key:"_canCache",value:function(t){if(void 0!==e._cacheTimes[t.type]){var n=p.jenkinsOneAtATimeHash(JSON.stringify(t));return Promise.resolve({canCache:!0,cacheKey:n})}return Promise.resolve({canCache:!1})}},{key:"_isCacheEntryStale",value:function(e,t){var n=this._cache[e];if(!n)return!1;var r=n.entryDate;return+new Date-r>v._cacheTimes[t]&&(delete this._cache[e],this._cache[e]=null,!0)}},{key:"_startCacheGarbageCollect",value:function(){var e=this;setInterval((function(){e._cache={}}),3e5)}}]),e}();m._cacheTimes={isReactivationEnabled:1e4,evaluatePasswordStrength:1e4,analysisDisabled:1e4,saveCredentialDisabled:1e4,isPwLimitReached:500,dataRequest:500};var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,e);var t=i(n);function n(){var e;return u(this,n),(e=t.call(this))._pendingRequests={},e}return l(n,[{key:"requestAndDontExpectResponse",value:function(e){return f.default().sendOrderToCpp({action:"mfaRequest",request:JSON.stringify(e)},-1),Promise.resolve()}},{key:"request",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.id,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=d.v4();return new Promise((function(a,s){t._pendingRequests[i]={resolve:a,reject:s,transform:n,cacheKey:o,request:e,nbRetries:r};var u=Object.assign({id:i},e);f.default().sendOrderToCpp({action:"mfaRequest",request:JSON.stringify(u)},-1)}))};return this._canCache(e).then((function(n){var r=n.canCache,i=n.cacheKey;if(r){var a=t._getCacheEntry(i,e.type);return a?p.id(a):o(i)}return o()}))}},{key:"onMfaResponse",value:function(e){var t=e.error,n=e.requestId,r=e.responseData;if(!this._pendingRequests[n])throw new Error("There are no pending resolver for id: ".concat(n));var o=this._pendingRequests[n],i=o.cacheKey,a=o.reject,s=o.resolve,u=o.transform;if(t)"dataIsNotReady"===t.name?this.retryRequest(this._pendingRequests[n]):a(t);else{var c=u(r);i&&this._addToCache(i,c),s(c)}delete this._pendingRequests[n]}},{key:"retryRequest",value:function(e){var t=this,r=e.nbRetries,o=e.request,i=e.reject,a=e.resolve,s=e.transform;r<n.MAX_RETRY?setTimeout((function(){t.request(o,s,r+1).then((function(e){return a(e)}))}),n.RETRY_TIMEOUT):i(new Error("Data was never ready for ".concat(o.type)))}}]),n}(m);t.MaverickForAllController=v,v.RETRY_TIMEOUT=100,v.MAX_RETRY=5;var y=null;t.isMfaControllerInstanceSet=function(){return!!y};t.setMfaControllerInstance=function(e){return y=e},t.getMfaControllerInstance=function(){if(!y){var e="getMfaControllerInstance is called but instance is not initialized";throw g.exceptionLog({code:h.ExceptionCode.Error,fileName:"common/background/communication/MaverickForAllController.ts",funcName:"getMfaControllerInstance",message:e}),new Error(e)}return y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setReadyAndSendPendingLogs=t.sendInstallerLog=void 0;var r,o=n(13),i=[],a=!1,s=!1;t.sendInstallerLog=function(e){return a?r(e):new Promise((function(t){i.push({log:e,resolve:t})}))};t.setReadyAndSendPendingLogs=function(){s||function(){if(o.default().isStandalone()){var e=n(11).carbon;r=function(t){return e().installerLog(t)}}else{var t=n(715);r=t.default}s=!0}(),a=!0;var e=i.slice();return i=[],Promise.all(e.map((function(e){return r(e.log).then(e.resolve)}))).then((function(){}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindow=void 0;t.getWindow=function(){return window}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWebsiteInfo=t.sendUsageLog=t.changeDashlaneSettings=t.requestSharedSession=t.requestRegister=t.savePasswordGeneratorOptions=t.saveGeneratedPassword=t.generatePassword=t.fillPassword=t.autoLoginPassword=t.respondLogout=t.requestLogout=t.requestLogin=t.getInitialData=t.getUserMessages=t.sendCommunicationPingRequest=t.sendCommunicationInitResponse=t.openApplication=void 0;var r=n(716);Object.defineProperty(t,"openApplication",{enumerable:!0,get:function(){return r.openApplication}});var o=n(304);Object.defineProperty(t,"sendCommunicationInitResponse",{enumerable:!0,get:function(){return o.sendCommunicationInitResponse}});var i=n(208);Object.defineProperty(t,"sendCommunicationPingRequest",{enumerable:!0,get:function(){return i.sendCommunicationPingRequest}});var a=n(308);Object.defineProperty(t,"getUserMessages",{enumerable:!0,get:function(){return a.getUserMessages}});var s=n(310);Object.defineProperty(t,"getInitialData",{enumerable:!0,get:function(){return s.getInitialData}});var u=n(312);Object.defineProperty(t,"requestLogin",{enumerable:!0,get:function(){return u.requestLogin}});var c=n(313);Object.defineProperty(t,"requestLogout",{enumerable:!0,get:function(){return c.requestLogout}});var l=n(302);Object.defineProperty(t,"respondLogout",{enumerable:!0,get:function(){return l.respondLogout}});var d=n(768);Object.defineProperty(t,"autoLoginPassword",{enumerable:!0,get:function(){return d.autoLoginPassword}});var f=n(770);Object.defineProperty(t,"fillPassword",{enumerable:!0,get:function(){return f.fillPassword}});var p=n(772);Object.defineProperty(t,"generatePassword",{enumerable:!0,get:function(){return p.generatePassword}});var g=n(775);Object.defineProperty(t,"saveGeneratedPassword",{enumerable:!0,get:function(){return g.saveGeneratedPassword}});var h=n(778);Object.defineProperty(t,"savePasswordGeneratorOptions",{enumerable:!0,get:function(){return h.savePasswordGeneratorOptions}});var m=n(301);Object.defineProperty(t,"requestRegister",{enumerable:!0,get:function(){return m.requestRegister}});var v=n(207);Object.defineProperty(t,"requestSharedSession",{enumerable:!0,get:function(){return v.requestSharedSession}});var y=n(781);Object.defineProperty(t,"changeDashlaneSettings",{enumerable:!0,get:function(){return y.changeDashlaneSettings}});var b=n(785);Object.defineProperty(t,"sendUsageLog",{enumerable:!0,get:function(){return b.sendUsageLog}});var _=n(315);Object.defineProperty(t,"getWebsiteInfo",{enumerable:!0,get:function(){return _.getWebsiteInfo}})},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestSharedSession=t.makeVerifiedRequestSharedSessionOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(63),s=n(28),u=n(1),c=n(23);function l(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.SHARED_SESSION,body:{message:r.RuntimeOrderMessage.SharedSessionRequest}};return a.getVerifiedOrder({protoLookupType:s.ProtoLookupType.SharedSessionRequest,exceptionLog:t,order:n})}t.makeVerifiedRequestSharedSessionOrder=l,t.requestSharedSession=function(){var e=l({exceptionLog:c.nativeMessagingExceptionLog});e?o.sendNativeOrder(e):c.nativeMessagingExceptionLog({funcName:"requestSharedSession",fileName:"common/background/runtime/requestSharedSession/index.ts",code:u.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendCommunicationPingRequest=t.makeVerifiedCommunicationPingRequestOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(63),s=n(28),u=n(1),c=n(23);function l(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.COMMUNICATION,body:{message:r.RuntimeOrderMessage.CommunicationPingRequest}};return a.getVerifiedOrder({protoLookupType:s.ProtoLookupType.CommunicationPingRequest,exceptionLog:t,order:n})}t.makeVerifiedCommunicationPingRequestOrder=l,t.sendCommunicationPingRequest=function(){var e=l({exceptionLog:c.nativeMessagingExceptionLog});e?o.sendNativeOrder(e):c.nativeMessagingExceptionLog({funcName:"sendCommunicationPingRequest",fileName:"common/backgound/runtime/communication/ping/request/index.ts",code:u.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeDashlaneSettingsType=t.DashlaneSettings=void 0;var r=n(50);Object.defineProperty(t,"ChangeDashlaneSettingsType",{enumerable:!0,get:function(){return r.ChangeDashlaneSettingsType}}),Object.defineProperty(t,"DashlaneSettings",{enumerable:!0,get:function(){return r.DashlaneSettings}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setInstance=void 0;var r=n(26),o=n(139),i=n(6),a=n(1),s=null;t.setInstance=function(e){(s=e).getExtensionId.on((function(){return r.default().getExtensionId()})),s.switchExtensionToStandalone.on((function(){return r.default().switchExtensionModeIfNeeded("standalone")})),s.showInput.on((function(e){o.dispatch(Object.assign({action:e.action},e.data),e.tabId)})),s.showFormOnPage.on((function(e){o.dispatch(Object.assign({action:e.action},e.data),e.tabId)}))},t.default=function(){if(!s)throw i.exceptionLog({code:a.ExceptionCode.Error,fileName:"common/background/ExternalModules/DebugConnector.ts",funcName:"debugConnector",message:"debugConnector is called but instance is not initialized"}),"debugConnector is called but instance is not initialized";return s}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.treatOrder=t.treatMessage=void 0;var a=n(815);t.treatMessage=function(e){var t={_originalMessage:e,action:"UNDEFINED_ACTION"};return""!==e&&e.split("&").forEach((function(e,n){var r=o((e=e.replace(/--amp--/g,"&").replace(/--dbsl--/g,"//")).split("="),2),i=r[0],s=r[1];!function(e,n){var r=/^([^[]*)(\[.*\])$/.exec(e),o=a.treatVar(n);if(r){var i=r[1];t[i]||(t[i]={});var s=t[i],u=/\[([^\]]*)\]/g,c=u.exec(r[2]);if(!c)return void(s=o);for(var l=u.exec(r[2]);null!==c;){if(!l)return void(s[c[1]]=o);s[c[1]]||(s[c[1]]={}),s=s[c[1]],c=l,l=u.exec(r[2])}}else t[e]=o}(i,s&&s.replace(/--equ--/g,"=")||"")})),t},t.treatOrder=function(e){var t="",n=function e(t,n){var o="";if(n instanceof Array)for(var i=0,a=n.length;i<a;i++)o+=e(t+"["+i+"]",n[i]);else if("object"===r(n))if(null!==n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o+=e(t+"["+s+"]",n[s]));else o+=t+"=&";else if("string"==typeof n||"number"==typeof n){o+=t+"="+n.toString().replace(/&/g,"--amp--").replace(/\/\//g,"--dbsl--").replace(/=/g,"--equ--")+"&"}else o+="boolean"==typeof n?t+"="+(n?"true":"false")+"&":t+"=&";return o};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&o&&"_originalMessage"!==o&&(t+=n(o,e[o]));return t+="//"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.sendOrderToMaverick=t.isMfaOrder=t.setInstance=void 0;var o=n(40),i=n(19),a=n(95),s=n(13),u=n(26),c=n(143),l=n(816),d=n(195),f=n(1),p=n(6),g=null;function h(){if(!g)throw p.exceptionLog({code:f.ExceptionCode.Error,fileName:"background/ExternalModules/maverick/MaverickExtension.ts",funcName:"maverick",message:"maverick is called but maverick instance is not initialized"}),"maverick is called but maverick instance is not initialized";return g}t.setInstance=function(e){var t;g=e;var n={AUTOFILL_VIRTUAL_KEYBOARD:"autofillVirtualKeyboard",FILL_ELEMENTS:"fillElements",PUT_EVENT_HANDLERS:"putEventHandlers",SHOW_IMPALAS:"highlightInputsForAutoComplete",WATCH_ELEMENT:"signalElementsToWatchValue",WEB_UI_HIDE:"hideWebUI",WEB_UI_SHOW:"showWebUI",BASIC_AUTH_ANSWER:"basicAuthAnswer",WEB_UI_UPDATE:"updateWebUI",ALLOW_INJECTED_SCRIPT_EXECUTION:"allowInjectedScriptExecution",OPEN_APPLICATION:"openApplication",REQUEST_LOGIN:"requestLogin",OPEN_ADD_OBJECT_WINDOWS:"openAddObjectWindows",OPEN_PASSWORD_HISTORY:"openPasswordHistory",SEE_PASSWORD:"seePassword",LOGIN_STATUS_DETECTED:"loginStatusDetected"},a=function(e){var t=Object.assign({action:n[e.type]||"UNDEFINED_ACTION"},e);delete t.type,i.default().catchMessageFromCpp(t.tabId,t)},f=(r(t={},o.ExtensionMaverickEventType.AUTOFILL_VIRTUAL_KEYBOARD,g.autofillVirtualKeyboard),r(t,o.ExtensionMaverickEventType.AUTOLOGIN,g.autologin),r(t,o.ExtensionMaverickEventType.FILL_ELEMENTS,g.fillElements),r(t,o.ExtensionMaverickEventType.PUT_EVENT_HANDLERS,g.putEventHandlers),r(t,o.ExtensionMaverickEventType.SAVE_PASSWORD,g.savePassword),r(t,o.ExtensionMaverickEventType.SHOW_IMPALAS,g.showImpalas),r(t,o.ExtensionMaverickEventType.WATCH_ELEMENT,g.watchElement),r(t,o.ExtensionMaverickEventType.WEB_UI_HIDE,g.webUIHide),r(t,o.ExtensionMaverickEventType.WEB_UI_SHOW,g.webUIShow),r(t,o.ExtensionMaverickEventType.BASIC_AUTH_ANSWER,g.basicAuthAnswer),r(t,o.ExtensionMaverickEventType.WEB_UI_UPDATE,g.webUIUpdate),r(t,o.ExtensionMaverickEventType.ALLOW_INJECTED_SCRIPT_EXECUTION,g.allowInjectedScriptExecution),r(t,o.ExtensionMaverickEventType.OPEN_APPLICATION,g.openApplication),r(t,o.ExtensionMaverickEventType.REQUEST_LOGIN,g.requestLogin),r(t,o.ExtensionMaverickEventType.OPEN_ADD_OBJECT_WINDOWS,g.openAddObjectWindows),r(t,o.ExtensionMaverickEventType.OPEN_PASSWORD_HISTORY,g.openPasswordHistory),r(t,o.ExtensionMaverickEventType.SEE_PASSWORD,g.seePassword),r(t,o.ExtensionMaverickEventType.LOGIN_STATUS_DETECTED,g.loginStatusDetected),t);for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&f[p].on((function(e){a(e)}));g.showUpSellScreen.on((function(){if(s.default().getPluginFeatures().mfa)d.getMfaControllerInstance().requestAndDontExpectResponse({type:"openGetPremiumWindows"});else{var e=u.default().getSubscriptionCode(),t=c.getUrlGivenQuery(l.GET_PREMIUM_URL,{subCode:e,utm_source:"webapp"});u.default().openNewTabWithUrl(t)}}))},t.default=h;var m=["signalWebUIHidden","DOMInformations","signalAjaxDOMInformations","DOMInformationsFromSAEXT","mlResults","documentComplete","focusDescriptionsForAutoFill","blurDescriptionsForAutoFill","valueDescriptionsForAutoFill","eventOnOutFired","dataResponse","signalTimeToImpalas","basicAuthRequest","isAnalysisDisabledChecked","userDataInit","refreshAnalysis","analyseDom","webUIStateUpdate","event&eventType=INIT","event&eventType=TAB_OPENED","event&eventType=TAB_CLOSED","event&eventType=UNLOAD","event&eventType=BEFORE_UNLOAD","event&eventType=DOM_NODE_INSERTED","webUIAction","setAutofilledDataTypes","popover_usageLog","signalStructurePerformance","signalSearchQueryForLog","domNodeInserted","finishedHighlightingInputs"];t.isMfaOrder=function(e){return m.some((function(t){return"event"===e.action?"event&eventType=".concat(e.eventType)===t:e.action===t}))},t.sendOrderToMaverick=function(e){h().orderFromJs(e).catch((function(t){var n="".concat(t.message," | Order: ").concat(e.action);a.default().exceptionLog({funcName:"extCom.orderFromJs.trigger",fileName:"Maverick/index.ts",code:f.ExceptionCode.Error,message:n,type:"extensionException",precisions:t.stack}),s.default().isDebug()&&console.error("Error sent by Maverick",t)}))}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.InstallerLog=void 0;var o=n(13),i=n(287),a=n(56),s=n(35),u=n(196),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,(n=[{key:"loadInstallerId",value:function(){o.default().isStandalone()||function e(){i.Dispatcher.hasHeardFromCpp()||setTimeout(e,1e3),a.getInstance().sendOrderToCpp({action:"getInstallerId"},o.default().getDefaultTabId(),"fromExtensionToCpp")}()}},{key:"setInstallerId",value:function(e){s.getSyncStorageInstance().set("installerId",e),u.setReadyAndSendPendingLogs()}},{key:"sendInstallerLog",value:function(e,t){return u.sendInstallerLog({step:e,precisions:t})}}])&&r(t.prototype,n),c&&r(t,c),e}();t.InstallerLog=c;var l=new c;function d(){return l}t.getInstance=d,t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Orders=t.Dispatcher=void 0;var r=n(139);t.Dispatcher=r;var o=n(212);t.Orders=o},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionPopupActions=t.PopupExtensionActions=void 0,function(e){e.GetLastState="getLastState",e.OpenApplication="openApplication",e.CopyPassword="copyPassword",e.AutologinCredential="autologinCredential",e.GetCurrentTabInfo="getCurrentTabInfo",e.Support="support",e.WhatsNew="whatsNew",e.MlEngineInfo="mlEngineInfo",e.Referral="referral",e.Refresh="refresh",e.GetUserMessages="getUserMessages",e.GetWebOnboardingMode="getWebOnboardingMode",e.GetSubscriptionCode="getSubscriptionCode",e.GetLanguage="getLanguage",e.GetExtensionInfo="getExtensionInfo",e.OpenExtensionInfo="openExtensionInfo",e.InitialData="initialData",e.GetPasswordGenerationSettings="getPasswordGenerationSettings",e.GetPremiumStatus="getPremiumStatus",e.CloseSession="closeSession",e.SaveState="saveState",e.InstallerLog="installerLog",e.UsageLog="usageLog",e.OpenUrl="openUrl",e.Logout="logout",e.Login="login",e.OpenSession="openSession",e.DismissUserMessage="dismissUserMessage",e.SetWebOnboarding="setWebOnboarding",e.FillPassword="fillPassword",e.ChangeDashlaneSettings="changeDashlaneSettings",e.SaveDefaults="saveDefaults",e.GeneratePassword="generatePassword",e.CheckIfMasterPasswordIsValid="checkIfMasterPasswordIsValid",e.DismissSUSSurvey="dismissSUSSurvey",e.GetSurveyInfo="getSurveyInfo",e.GetGeneratedPasswords="getGeneratedPasswords",e.DismissChurnedPremiumDiscountNotification="dismissChurnedPremiumDiscountNotification",e.OpenChurnedDiscount="openChurnedDiscount",e.GetShouldDisplayVaultChurnedDiscount="getVaultChurnedDiscount",e.GetShouldDisplayMoreToolsChurnedDiscount="getMoreToolsChurnedDiscount",e.GetActiveTabInfo="getActiveTabInfo",e.GetChurnedPremiumSurveyInfo="getChurnedPremiumSurveyInfo",e.DismissChurnedPremiumSurvey="dismissChurnedPremiumSurvey",e.GetIsPaymentFailureChurningDismissedForOneDay="getIsPaymentFailureChurningDismissedForOneDay",e.SavePaymentFailureChurningDismissDate="SavePaymentFailureChurningDismissDate",e.GetShouldDisplayMigrationNotification="getShouldDisplayMigrationNotification",e.DismissMigrationNotification="dismissMigrationNotification",e.GetShouldDisplayMigrationSwitchNotification="getShouldDisplayMigrationSwitchNotification",e.Reload="reload",e.SwitchToMlAnalysisEngine="switchToMlAnalysisEngine",e.GetIsUserUsingMlEngine="getIsUserUsingMlEngine"}(t.PopupExtensionActions||(t.PopupExtensionActions={})),function(e){e.ChangeLangage="changeLangage",e.ExtensionInfo="extensionInfo",e.PopoverSignalDataRefresh="popover_signalDataRefresh",e.PopoverV2SignalDataRefresh="popover_v2_signalDataRefresh",e.LoginsLists="loginsLists",e.RestoreState="restoreState",e.PasswordGenerationSettings="passwordGenerationSettings",e.SubscriptionCodeChanged="subscriptionCodeChanged",e.WebOnboardingModeChanged="webOnboardingModeChanged",e.PremiumStatusChanged="premiumStatusChanged",e.Close="close",e.UserDataChanged="userDataChanged",e.SignalUserMessages="signalUserMessages",e.PopoverV2SignalCurrentTabInfo="popover_v2_signalCurrentTabInfo",e.PopoverSignalPasswordGenerated="popover_signalPasswordGenerated",e.PopoverV2SignalPasswordGenerated="popover_v2_signalPasswordGenerated",e.OpenSessionFailed="openSessionFailed",e.OpenSessionOTPSent="openSessionOTPSent",e.OpenSessionTokenSent="openSessionTokenSent",e.OpenSessionOTPForNewDeviceRequired="openSessionOTPForNewDeviceRequired",e.OpenSessionAskMasterPassword="openSessionAskMasterPassword",e.OpenSessionSSO="openSessionSSO",e.LoginStatusChanged="loginStatusChanged",e.SUSSurveyInfoChanged="SUSSurveyInfoChanged",e.GeneratedPasswords="generatedPasswords",e.ShouldDisplayVaultChurnedDiscount="shouldDisplayVaultChurnedDiscount",e.ShouldDisplayMoreToolsChurnedDiscount="shouldDisplayMoreToolsChurnedDiscount",e.ActiveTabInfo="activeTabInfo",e.ChurnedPremiumSurveyInfoChanged="churnedPremiumSurveyInfoChanged",e.IsPaymentFailureChurningDismissedForOneDay="isPaymentFailureChurningDismissedForOneDay",e.ShouldDisplayMigrationAlert="shouldDisplayMigrationAlert",e.ShouldDisplayMigrationSwitchAlert="shouldDisplayMigrationSwitchAlert",e.IsUserUsingMlEngine="isUserUsingMlEngine"}(t.ExtensionPopupActions||(t.ExtensionPopupActions={}))},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestRegister=t.makeVerifiedRequestRegisterOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(63),s=n(28),u=n(1),c=n(23);function l(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.REGISTER,body:{message:r.RuntimeOrderMessage.RegisterRequest}};return a.getVerifiedOrder({protoLookupType:s.ProtoLookupType.RegisterRequest,exceptionLog:t,order:n})}t.makeVerifiedRequestRegisterOrder=l,t.requestRegister=function(){var e=l({exceptionLog:c.nativeMessagingExceptionLog});e?o.sendNativeOrder(e):c.nativeMessagingExceptionLog({funcName:"requestRegister",fileName:"common/background/runtime/requestRegister/index.ts",code:u.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.respondLogout=t.makeVerifiedLogoutResponseOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(63),s=n(28),u=n(745),c=n(746),l=n(1),d=n(23),f=function(){};function p(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.LOGOUT,body:{message:r.RuntimeOrderMessage.LogoutResponse}};return a.getVerifiedOrder({protoLookupType:s.ProtoLookupType.LogoutResponse,exceptionLog:t,order:n})}t.makeVerifiedLogoutResponseOrder=p,t.respondLogout=function(){var e=p({exceptionLog:d.nativeMessagingExceptionLog});e?o.sendMessage({order:e,internalHandler:u.sendLogoutResponseInternalOrder,nativeMessagingHandler:c.sendLogoutResponseNativeOrder,websocketHandler:f}):d.nativeMessagingExceptionLog({funcName:"respondLogout",fileName:"common/background/runtime/logout/response/index.ts",code:l.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogoutRequestInternalOrder=void 0;var r=n(11);t.sendLogoutRequestInternalOrder=function(){r.carbon().closeSession({})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendCommunicationInitResponse=t.makeVerifiedCommunicationInitResponseOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(6),s=n(63),u=n(28),c=n(1);function l(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.COMMUNICATION,body:{message:r.RuntimeOrderMessage.CommunicationInitResponse}};return s.getVerifiedOrder({protoLookupType:u.ProtoLookupType.CommunicationInitResponse,exceptionLog:t,order:n})}t.makeVerifiedCommunicationInitResponseOrder=l,t.sendCommunicationInitResponse=function(){var e=l({exceptionLog:a.exceptionLog});e?o.sendNativeOrder(e):a.exceptionLog({funcName:"sendCommunicationInitResponse",fileName:"common/background/runtime/communicationResponse/index.ts",code:c.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePingResponse=t.onPingTimeout=t.startPingSequence=t.setMaxRemainingPotentialPingAttempts=t.remainingPotentialPingAttempts=t.PING_WAIT_TIMEOUT_MILLISECONDS=t.MAX_REPING_ATTEMPTS=void 0;var r=n(208),o=n(306).nativeAppConnectionManager,i=o.setNativeAppConnected,a=o.setNativeAppDisconnected;t.MAX_REPING_ATTEMPTS=5;t.PING_WAIT_TIMEOUT_MILLISECONDS=5e3;var s=null,u=null;function c(){t.remainingPotentialPingAttempts=t.MAX_REPING_ATTEMPTS}function l(e){if(u&&clearTimeout(u),t.remainingPotentialPingAttempts)return t.remainingPotentialPingAttempts--,a(),void e({sendCommunicationPingRequest:r.sendCommunicationPingRequest,startPingSequenceFunc:e});c()}t.remainingPotentialPingAttempts=t.MAX_REPING_ATTEMPTS,t.setMaxRemainingPotentialPingAttempts=c,t.startPingSequence=function(e){var n=e.sendCommunicationPingRequest,r=e.startPingSequenceFunc;s&&clearTimeout(s),n(),u=setTimeout((function(){l(r)}),t.PING_WAIT_TIMEOUT_MILLISECONDS)},t.onPingTimeout=l,t.handlePingResponse=function(e){u&&clearTimeout(u),c(),i(),s=setTimeout((function(){e({sendCommunicationPingRequest:r.sendCommunicationPingRequest,startPingSequenceFunc:e})}),2e3)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nativeAppConnectionManager=void 0;var r,o,i,a=(r=!1,o=[],i=[],{setNativeAppConnected:function(){r||(r=!0,o.forEach((function(e){return e()})))},setNativeAppDisconnected:function(){r&&(r=!1,i.forEach((function(e){return e()})))},getIsNativeAppConnected:function(){return r},onNativeAppConnect:function(e){o.push(e)},onNativeAppDisconnect:function(e){i.push(e)}});t.nativeAppConnectionManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CURRENT_TAB_PATH=void 0,t.CURRENT_TAB_PATH="current"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserMessages=t.makeGetUserMessagesOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(759),s=r.BaseOrderTarget,u=s.BACKGROUND,c=s.POPUP;function l(){return{from:u,to:c,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.GetUserMessages}}}t.makeGetUserMessagesOrder=l,t.getUserMessages=function(){var e=l();i.sendMessage({order:e,internalHandler:a.sendGetUserMessagesInternalOrder,nativeMessagingHandler:a.sendGetUserMessagesInternalOrder})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.UserMessageType=void 0,o(n(760),t),function(e){e.TrialExpired="TRIAL_EXPIRED"}(t.UserMessageType||(t.UserMessageType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialData=t.makeGetInitialDataOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(761),s=n(762),u=r.BaseOrderTarget,c=u.BACKGROUND,l=u.UNSPECIFIED;function d(){return{from:c,to:l,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.GetInitialData}}}t.makeGetInitialDataOrder=d;var f=s.sendGetInitialDataInternalOrder;t.getInitialData=function(){var e=d();i.sendMessage({order:e,websocketHandler:a.sendGetInitialDataLegacyOrder,internalHandler:s.sendGetInitialDataInternalOrder,nativeMessagingHandler:f})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getABTest=t.ABTestKeys=void 0;var r=n(763);Object.defineProperty(t,"ABTestKeys",{enumerable:!0,get:function(){return r.ABTestKeys}}),Object.defineProperty(t,"getABTest",{enumerable:!0,get:function(){return r.getABTest}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestLogin=t.makeVerifiedRequestLoginOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(764),s=n(765),u=n(63),c=n(28),l=n(1),d=n(23);function f(e){var t=e.forceLogin,n=e.exceptionLog,o={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.LOGIN,body:{message:r.RuntimeOrderMessage.LoginRequest,data:{forceLogin:t}}};return u.getVerifiedOrder({protoLookupType:c.ProtoLookupType.LoginRequest,exceptionLog:n,order:o})}t.makeVerifiedRequestLoginOrder=f,t.requestLogin=function(e){var t=f({forceLogin:e.forceLogin||!1,exceptionLog:d.nativeMessagingExceptionLog});t?o.sendMessage({order:t,nativeMessagingHandler:o.sendNativeOrder,websocketHandler:a.sendRequestLoginLegacyOrder,internalHandler:s.sendRequestLoginInternalOrder}):d.nativeMessagingExceptionLog({funcName:"requestLogin",fileName:"common/background/runtime/requestLogin/index.ts",code:l.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestLogout=t.makeVerifiedLogoutRequestOrder=void 0;var r=n(22),o=n(7),i=n(21),a=n(303),s=n(766),u=n(63),c=n(28),l=n(767),d=n(1),f=n(23);function p(e){var t=e.exceptionLog,n={from:i.BaseOrderTarget.BACKGROUND,to:i.BaseOrderTarget.PLUGIN,subject:i.BaseOrderSubject.LOGOUT,body:{message:r.RuntimeOrderMessage.LogoutRequest}};return u.getVerifiedOrder({protoLookupType:c.ProtoLookupType.LogoutRequest,exceptionLog:t,order:n})}t.makeVerifiedLogoutRequestOrder=p,t.requestLogout=function(){var e=p({exceptionLog:f.nativeMessagingExceptionLog});e?o.sendMessage({order:e,internalHandler:a.sendLogoutRequestInternalOrder,nativeMessagingHandler:l.sendLogoutRequestNativeOrder,websocketHandler:s.sendLogoutRequestLegacyOrder}):f.nativeMessagingExceptionLog({funcName:"requestLogout",fileName:"common/background/runtime/logout/request/index.ts",code:d.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleDashlaneSettingsLegacyController=void 0;var r,o,i=n(783),a=n(209);t.toggleDashlaneSettingsLegacyController=(r={domain:{autoFill:!0,autoLogin:!0},page:{autoFill:!0,autoLogin:!0}},o=new i.default(1e3,500),{getSettings:function(e){return e===a.ChangeDashlaneSettingsType.Domain?r.domain:r.page},setSettings:function(e,t){r[e]=t},getQueue:function(){return o},ifQueueIsEmpty:function(e){return o.isEmpty()?e():null}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getWebsiteInfo=t.makeGetWebsiteInfoOrder=void 0;var o=n(21),i=n(22),a=n(7),s=n(788),u=n(316),c=n(19),l=o.BaseOrderTarget,d=l.BACKGROUND,f=l.UNSPECIFIED;function p(e){var t=e.fullUrl;return{from:d,to:f,subject:o.BaseOrderSubject.POPOVER_REQUEST,body:{message:i.RuntimeOrderMessage.GetWebsiteInfo,data:{fullUrl:t}}}}t.makeGetWebsiteInfoOrder=p,t.getWebsiteInfo=function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.default().getCurrentTabController();case 2:t=e.sent,n=(null==t?void 0:t.getLocation())||"",r=p({fullUrl:n}),a.sendMessage({order:r,websocketHandler:s.sendGetWebsiteInfoLegacyOrder,internalHandler:u.sendGetWebsiteInfoInternalOrder,nativeMessagingHandler:u.sendGetWebsiteInfoInternalOrder});case 6:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetWebsiteInfoInternalOrder=t.getValidWebsiteDomainFromFullUrl=t.isValidProtocol=t.isValidDomain=void 0;var o=n(190),i=n(11),a=n(50),s=n(26);function u(e){return!(!e||"string"!=typeof e)&&(e.includes(".")||"localhost"===e||e.startsWith("localhost:"))}function c(e){return!!e&&["http://","https://"].includes(e)}function l(e){var t=o.extractRootDomain(e),n=o.findUsedProtocol(e);return u(t)&&c(n)?t:""}t.isValidDomain=u,t.isValidProtocol=c,t.getValidWebsiteDomainFromFullUrl=l,t.sendGetWebsiteInfoInternalOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body.data.fullUrl,!(r=l(n))||!n){t.next=8;break}return t.next=5,i.carbon().askWebsiteInfo({fullUrl:n});case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0={disabledFromSpaces:!1,disabledAutofillOnDomain:!1,disabledAutofillOnPage:!1,disabledAutologinOnDomain:!1,disabledAutologinOnPage:!1};case 9:o=t.t0,u=Object.assign(Object.assign({},o),{domain:r,fullUrl:n}),s.default().postMessageToPopover(a.ExtensionPopupActions.PopoverV2SignalCurrentTabInfo,{data:u});case 12:case"end":return t.stop()}}),t)})))}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.BasicAuthController=void 0;var r=n(6),o=n(1);t.BasicAuthController=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};var i=void 0;t.setInstance=function(e){i=e},t.getInstance=function(){if(!i)throw r.exceptionLog({code:o.ExceptionCode.Error,fileName:"common/background/basicAuth/index.ts",funcName:"getInstance",message:"GetInstance is called but instance is not initialized"}),"GetInstance is called but instance is not initialized";return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.AssetsController=void 0;t.AssetsController=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};var r=void 0;function o(){if(!r)throw new Error("No specific instance has been set yet");return r}t.setInstance=function(e){r=e},t.getInstance=o,t.default=o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extensionCarbonConnector=t._CARBON_EXTENSION_CHANNEL=void 0;var r=n(10),o=n(325),i=n(819);t._CARBON_EXTENSION_CHANNEL=new i.LocalChannel;var a=new i.LocalChannel;i.connectLocalChannels(a,t._CARBON_EXTENSION_CHANNEL),t.extensionCarbonConnector=r.createEventBus({events:o.apiEvents,channels:[a]})},,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;var l=n(878),d=n(152),f=n(69),p=n(6),g=n(1),h=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){var e;return o(this,c),(e=u.apply(this,arguments))._ws=null,e}return t=c,(n=[{key:"open",value:function(e){var t=this;if(!f.default().isStandalone()){if(this._ws&&this._ws.readyState!==WebSocket.CLOSED)throw p.exceptionLog({funcName:"ws.open",fileName:"WebSocketController.ts",code:g.ExceptionCode.Error,message:"Trying to open a websocket while we already have one"}),new Error("Trying to open a websocket while we already have one");var n=null,r=function(n){t._ws=null,t.onError(n,e)};try{(n=new WebSocket("ws://127.0.0.1:"+e)).onopen=function(r){t._ws=n,t.onOpen(e)},n.onmessage=function(e){t.onMessage(e.data)},n.onclose=function(r){p.exceptionLog({funcName:"ws.onclose",fileName:"WebSocketController.ts",code:g.ExceptionCode.Error,message:r.code+""}),n===t._ws&&(t._ws=null,t.onClose(r.reason,e))},n.onerror=function(e){var t=new Error("[WebsocketController] Websocket onError callback has been triggered.");r(t)},this._ws=n}catch(e){r(e)}}}},{key:"_send",value:function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN){var t="Send with bad ws: "+(this._ws&&this._ws.readyState||"null");return p.exceptionLog({funcName:"ws.send",fileName:"WebSocketController.ts",code:g.ExceptionCode.Error,message:t})}return this._ws.send(e)}},{key:"close",value:function(){this._ws&&this._ws.close()}},{key:"_onNoInitMessage",value:function(){this._initMsgTimer=null,d.getInstance().onWebSocketNotWorking()}}])&&i(t.prototype,n),r&&i(t,r),c}(l.WebSocketController));function m(){return h}l.setInstance(h),t.getInstance=m,t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeSha256=t.decrypt=t.encrypt=t.cryptHashPassword=t.getSalt=void 0;var r=n(879),o=n(332),i=n(197),a=n(883);function s(){var e=i.getWindow().crypto;return e&&(e.subtle||e.webkitSubtle)||null}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return crypto.getRandomValues(new Uint8Array(e))}function c(e,t){var n=r.str2ab("KWH1"),i=new Uint8Array(t.byteLength+n.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(n),t.byteLength),i.set(new Uint8Array(e),t.byteLength+n.byteLength),o.fromByteArray(i)}function l(e,t){var n=r.str2ab(e),o=new Uint8Array(t.byteLength+n.byteLength);o.set(new Uint8Array(n),0),o.set(new Uint8Array(t),n.byteLength);for(var i=a.codec.arrayBuffer.toBits(o.buffer),s=[],u=[],c=0;c<3;++c){s=s.concat(i);for(var l=0;l<5;++l)s=a.hash.sha1.hash(s);u[c]=s}var d=new Uint8Array(32),f=new Uint8Array(16),p=a.codec.arrayBuffer.fromBits(u[0]).slice(0,20);return d.set(new Uint8Array(p),0),p=a.codec.arrayBuffer.fromBits(u[1]).slice(0,12),d.set(new Uint8Array(p),20),p=a.codec.arrayBuffer.fromBits(u[1]).slice(12,20),f.set(new Uint8Array(p),0),p=a.codec.arrayBuffer.fromBits(u[2]).slice(0,8),f.set(new Uint8Array(p),8),{key:d,iv:f}}t.getSalt=u,t.cryptHashPassword=function(e,t){var n=null,o=s();if(!o){var l=a.hash.sha512.hash(e);i.getWindow().crypto&&crypto.getRandomValues&&(n=u(32));var d=a.codec.arrayBuffer.toBits(n.buffer);l=a.misc.pbkdf2(l,d,10204,256,(function(e){return new a.misc.hmac(e,a.hash.sha1)}));var f=a.codec.arrayBuffer.fromBits(l);return t(null,c(f,n))}n=u(32);var p=r.str2ab(e);o.digest({name:"SHA-512"},p).then((function(e){return o.importKey("raw",e,{name:"PBKDF2"},!1,["deriveKey"])})).then((function(e){return o.deriveKey({name:"PBKDF2",salt:n,iterations:10204,hash:"SHA-1"},e,{name:"HMAC",hash:"SHA-256",length:256},!0,["sign"])})).then((function(e){return o.exportKey("raw",e)})).then((function(e){return t(null,c(e,n))})).then(void 0,(function(e){return t(e,null)}))},t.encrypt=function(e,t){return new Promise((function(n,i){var c=null,d=r.str2ab(t),f=function(e){var t=new Uint8Array(e),n=new Uint8Array(c.byteLength+t.byteLength);return n.set(c,0),n.set(t,c.byteLength),o.fromByteArray(n)};c=u(8);var p=l(e,c),g=s();if(!g){var h=a.codec.arrayBuffer.toBits(d),m=a.codec.arrayBuffer.toBits(p.key.buffer),v=a.codec.arrayBuffer.toBits(p.iv.buffer),y=new a.cipher.aes(m);a.mode.cbc||a.beware["CBC mode is dangerous because it doesn't protect message integrity."]();var b=a.mode.cbc.encrypt(y,h,v);return n(f(a.codec.arrayBuffer.fromBits(b)))}g.importKey("raw",p.key.buffer,{name:"AES-CBC"},!1,["encrypt"]).then((function(e){return g.encrypt({name:"AES-CBC",iv:p.iv},e,d)})).then((function(e){return n(f(e))})).then(void 0,(function(e){return i(e)}))}))},t.decrypt=function(e,t){return new Promise((function(n,i){var u=o.toByteArray(t),c=u.subarray(0,8),d=u.subarray(8,u.length),f=l(e,c),p=s();if(p)p.importKey("raw",f.key.buffer,{name:"AES-CBC"},!1,["decrypt"]).then((function(e){return p.decrypt({name:"AES-CBC",iv:f.iv},e,d)})).then((function(e){var t=r.ab2str(e);n(t)})).then(void 0,(function(e){return i(e)}));else{var g=new Uint8Array(d),h=a.codec.arrayBuffer.toBits(g.buffer),m=a.codec.arrayBuffer.toBits(f.key.buffer),v=a.codec.arrayBuffer.toBits(f.iv.buffer),y=new a.cipher.aes(m);a.mode.cbc||a.beware["CBC mode is dangerous because it doesn't protect message integrity."]();var b=a.mode.cbc.decrypt(y,h,v),_=r.ab2str(a.codec.arrayBuffer.fromBits(b));n(_)}}))};t.computeSha256=function(e){var t=a.hash.sha256.hash(e);return a.codec.hex.fromBits(t)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeTabController=void 0;var d=n(1007),f=n(151),p=n(69),g=n(118),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(d,e);var t,n,r,u=s(d);function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=u.call(this,e))._eventBus=null,n._tabPanel=t,n.initializeTab(),n}return t=d,(n=[{key:"getTitle",value:function(){if(!this.tabPanel.title)throw new Error("Tab has no title");return this.tabPanel.title}},{key:"close",value:function(e,t){e||this.sendLoadEventToCpp("TAB_CLOSED",!1),g.default().unregisterTab(this)}},{key:"updateTab",value:function(e){if(this.tabPanel=e,e.url){var t=f.default().getExtensionSwitchModeForUrls([e.url]);f.default().switchExtensionModeIfNeeded(t)}}},{key:"postMessage",value:function(e){if(!this._eventBus)throw new Error("Event bus not ready");this._eventBus.messageFromExtension(e)}},{key:"initCommunicationChannel",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}throw new Error("bus is null, this is not supposed to happen");case 2:return this._eventBus=e,this._eventBus.messageFromJs.on((function(e){return i.onMessageListener(e)})),n.next=6,f.default().isMarshmallowEnabled();case 6:r=n.sent,o=p.default().getInitialDataForInjected({isUserLoggedIn:f.default().userLoggedIn,frameId:t,hasSecureWebUi:!0,features:f.default().getAccountFeatures(),isMarshmallowEnabled:r}),this._eventBus.messageFromExtension(o);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getFrames",value:function(){return i(c(d.prototype),"getFrames",this).call(this)}},{key:"getTab",value:function(){return this.tabPanel}},{key:"getLocation",value:function(){return this.tabPanel.url||""}},{key:"getFrameControllerByFrameUniqueId",value:function(e){var t=i(c(d.prototype),"getFrames",this).call(this).filter((function(t){return t.frameUniqueId===e}));return 1===t.length?t[0]:null}},{key:"removeFrameControllerByFrameUniqueId",value:function(e){for(var t=0;t<this._frames.length;t++)if(this._frames[t].frameUniqueId===e)return void this._frames.splice(t,1)}},{key:"initWebUICommunication",value:function(e){if(this._webUIController){var t=this._webUIController.createEventBusForWebui(e);this._webUIController.initCommunication(t)}else e.postMessage({action:"rejectToken"}),e.disconnect()}},{key:"initializeTab",value:function(){i(c(d.prototype),"initializeTab",this).call(this);var e={"https://www.dashlane.com/en/chrome_getstarted":"https://www.dashlane.com/en/chrome_welcome","https://www.dashlane.com/fr/chrome_getstarted":"https://www.dashlane.com/fr/chrome_welcome","https://www.dashlane.com/en/chrome_update":"https://www.dashlane.com/en/chrome_welcomeback","https://www.dashlane.com/fr/chrome_update":"https://www.dashlane.com/fr/chrome_welcomeback"};Object.prototype.hasOwnProperty.call(e,this.getLocation())&&chrome.tabs.update(this.tabId,{url:e[this.getLocation()]});var t=f.default().getExtensionSwitchModeForUrls([this.getLocation()]);f.default().switchExtensionModeIfNeeded(t)}},{key:"treatFramesReport",value:function(e){var t=[];this.getFrames().forEach((function(n,r){for(var o=!1,i=0,a=e.framesReport.length;i<a;i++){var s=e.framesReport[i];if(!0!==s.alreadySet&&n.couldBeThatFrame(s)){n.setFramePosition(i),s.alreadySet=!0,o=!0;break}}o||t.push(n)})),t.forEach((function(t,n){for(var r=0,o=e.framesReport.length;r<o;r++){var i=e.framesReport[r];if(!0!==i.alreadySet){t.setFramePosition(r),i.alreadySet=!0;break}}}))}},{key:"onMessageListener",value:function(e){e.type&&"framesReport"===e.type?this.treatFramesReport(e):this.dispatchMessage(e)}},{key:"tabPanel",get:function(){return this._tabPanel},set:function(e){this._tabPanel=e}}])&&o(t.prototype,n),r&&o(t,r),d}(d.TabController);t.ChromeTabController=h,t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getWebUIFactory=t.setFactory=t.WebUIController=void 0;var s=n(40),u=n(190),c=n(56),l=n(13),d=n(26),f=n(340),p=n(95),g=n(6),h=n(1),m=n(19),v=n(145),y={"autofill-dropdown":!0,"master-password":!0,"autologin-selection":!0,notification:!0},b={"autofill-dropdown":!0,"master-password":!0,"autologin-selection":!0,"warn-generated-password":!0},_=function(){function e(t,n){r(this,e),this._uiId=Math.floor(1e8*Math.random()),this._shown=0,this._guessedLoginStatus="unapplicable",this._loginStatusHints="",this._hiddenCallback=null,this._hideCalled=!1,this._tabId=t,this._type=n.type,this._uiState=n.uiData,this._context=this.getContext(n),this._showTimeout=null,this._srcElementId=n.srcElementId||-1,this._uiState.lang=v.default().getLang(),this._uiState.type=n.type,"master-password"===this._type&&(this._uiState.userLogin=d.default().userLogin)}return i(e,[{key:"getContext",value:function(e){if("limited-capability"===e.type&&"passwordLimit"===e.uiData.capability)return"password-limit";if("autofill-dropdown"===e.type&&e.uiData.showPasswordLimit)return"password-limit";if("save-password"===e.type&&"saveAsNewLimited"===e.uiData.mainButton)return"password-limit";if(this._uiState.step){if("categories"===this._uiState.step)return"step-1";if("signification"===this._uiState.step)return"step-2"}return"unsecureIframe"===this._uiState.warningType&&this._uiState.context||null}},{key:"getId",value:function(){return this._uiId}},{key:"getType",value:function(){return this._type}},{key:"getULContext",value:function(){return this._context}},{key:"getTriggeringFormType",value:function(){return this._uiState.formType||null}},{key:"getULType",value:function(){return"save-password"===this._type&&"replace"===this._uiState.mainButton?"replace-password":"autofill-dropdown"===this._type&&"addObject"===this._uiState.configuration?"data-capture-card":"autofill-dropdown"===this._type&&void 0!==this._uiState.step?"fix-autofill-dropdown":this._type}},{key:"getSrcElementId",value:function(){return this._srcElementId}},{key:"_tryToShow",value:function(){this._showTimeout=null;var e=m.default().getControllerById(this._tabId);if(e){this._shown+=1;var t=!1;l.default().isStandalone()?t=this._uiState.useFancyCards||!1:this._uiState.cardSize&&parseInt(this._uiState.cardSize.height,10)>100&&(t=!0);var n=this._uiState&&this._uiState.webcards&&this._uiState.webcards.length,r={srcElementId:this._srcElementId,type:this._type,uiId:this._uiId,useFancyCards:t,numberOfCards:n||0};this._uiState&&this._uiState.configuration&&(r.configuration=this._uiState.configuration),"autofill-dropdown"===this._type&&(r.srcElementPos=e.getInputPosition(this._srcElementId)),c.getInstance().sendOrderToJs({action:"showWebUI",infos:JSON.stringify(r)},this._tabId,"dashlaneMessageToWebPage")}}},{key:"_hasShowDelay",value:function(){return!l.default().getPluginFeatures().mfa&&!0!==y[this._type]}},{key:"show",value:function(){var e="autofillIssue"===this._uiState.warningType?"show-with-fix-button":"show";this.sendUsageLog({type:this.getULType(),action:e,context:this.getULContext(),triggeringFormType:this.getTriggeringFormType()}),this._hasShowDelay()?this._showTimeout=setTimeout(this._tryToShow.bind(this),1234):this._tryToShow()}},{key:"_shouldRestore",value:function(){return!0!==b[this._type]}},{key:"restore",value:function(){this._shouldRestore()?(this.sendUsageLog({type:this.getULType(),action:"restore",displayCount:this._shown,context:this.getULContext(),triggeringFormType:this.getTriggeringFormType()}),null!==this._showTimeout&&(clearTimeout(this._showTimeout),this._showTimeout=null),this._tryToShow()):this._suicide()}},{key:"hide",value:function(e,t){return this._hideCalled=!0,"autofill-dropdown"===this._type?(c.getInstance().sendOrderToJs({action:"hideWebUI",uiId:this._uiId},this._tabId,"dashlaneMessageToWebPage"),e&&t&&"function"==typeof t?t():void 0):e?(this._hiddenCallback=t||null,void this.postCloseWebcardMessage({action:"closeWebcard",content:{sendResult:e}})):this.webcardClosed()}},{key:"update",value:function(e){this.postUpdateStateMessage({action:"updateState",data:e.uiData})}},{key:"onMessage",value:function(e){var t=e.messageSlot;throw new Error("no handler for message ".concat(t))}},{key:"onCheckVisibility",value:function(e){this.checkVisibility(e.requestId)}},{key:"onInitialStateRequest",value:function(){this.sendInitialState()}},{key:"onWebcardClosed",value:function(){this.webcardClosed()}},{key:"onSendWebcardOutcome",value:function(e){this.sendResult(e)}},{key:"onSendUsageLog",value:function(e){this.sendUsageLog(e)}},{key:"onSignalGeometry",value:function(e){this.signalGeometry(e)}},{key:"onStateChanged",value:function(e){this.treatStateUpdate(e)}},{key:"sendInitialState",value:function(){var e=Object.assign({},this._uiState);this.postInitialStateResponseMessage({action:"initialStateResponse",content:{data:e,features:d.default().getAccountFeatures()}})}},{key:"treatStateUpdate",value:function(e){if("save-password"===this._type)if(this._uiState.emailOrLogin!==e.emailOrLogin){this._uiState=e;var t={emailOrLogin:this._uiState.emailOrLogin};c.getInstance().sendOrderToCpp({action:"webUIStateUpdate",type:this._type,uiState:JSON.stringify(t)},this._tabId,"fromExtensionToCpp")}else this._uiState=e;else this._uiState=e}},{key:"sendResult",value:function(e){var t=this;e.button&&("close"===e.button||"cancel"===e.button)&&setTimeout((function(){t._hideCalled||(t.hide(!1),g.exceptionLog({funcName:"WebUIController.sendResult",fileName:"webui/Controller.ts",code:h.ExceptionCode.Error,message:"WebUI not hidden after 3 seconds",precisions:JSON.stringify({type:t._type,shown:t._shown})}))}),3e3);var n={button:e.button};if("limited-capability"===this._type)n.capability=e.capability;else if("save-password"===this._type&&"cancel"!==n.button)n.emailOrLogin=this._uiState.emailOrLogin,n.checkProtectedOpt=this._uiState.checkProtectedOpt,n.checkSubdomainOpt=this._uiState.checkSubdomainOpt,n.category=this._uiState.category,n.space=this._uiState.space;else if("data-capture"===this._type&&"cancel"!==n.button&&"never"!==n.button&&this._uiState.data)n.selectedIds=this._uiState.data.filter((function(e){return e.checked})).map((function(e){return e.id}));else if("master-password"===this._type&&"cancel"!==n.button){if(n.alwaysAuthorized=this._uiState.alwaysAuthorized,n.password=this._uiState.password,!l.default().isStandalone())return f.cryptHashPassword(n.password||"",(function(e,r){n.password=r||"",c.getInstance().sendOrderToCpp({action:"webUIAction",type:t._type,uiResult:JSON.stringify(n)},t._tabId,"fromExtensionToCpp")}))}else"autofill-dropdown"!==this._type&&"autologin-selection"!==this._type||(n.id=e.id);"autofill-dropdown"===this._type&&"pwdGenerator"===(null==e?void 0:e.configuration)&&(e.password&&(n.password=e.password),e.passwordGenerationSettings&&(n.passwordGenerationSettings=e.passwordGenerationSettings)),this._uiState.loggingIn&&"save"===n.button&&(n.login=this._uiState.login,n.password=this._uiState.password);var r=function(e){for(var t=null,r=0;r<e.length;++r)if(e[r].cardId===n.id){t=e[r];break}return t&&t.type?t.type:null}(this._uiState.webcards||[]);c.getInstance().sendOrderToCpp({action:"webUIAction",type:this._type,srcElementId:this._srcElementId,uiResult:JSON.stringify(n),informationNeeded:r},this._tabId,"fromExtensionToCpp")}},{key:"signalGeometry",value:function(e){c.getInstance().sendOrderToJs({action:"signalWebUIGeometry",geometry:JSON.stringify(e),uiId:this._uiId},this._tabId,"dashlaneMessageToWebPage")}},{key:"webcardClosed",value:function(){c.getInstance().sendOrderToJs({action:"hideWebUI",uiId:this._uiId},this._tabId,"dashlaneMessageToWebPage"),this._hiddenCallback&&"function"==typeof this._hiddenCallback&&this._hiddenCallback()}},{key:"sendUsageLog",value:function(e){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i,a,f,v,y,b,_,w,S,O,P,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d.default().userLoggedIn){t.next=2;break}return t.abrupt("return");case 2:if(n=m.default().getControllerById(this._tabId),r=n?n.getDomain():"",o=u.extractRootDomain(r),i="string"==typeof o?o:"",a=e.type,f=e.action,v=e.displayCount,y=e.context,b=e.triggeringFormType,_=d.default().getWebOnboardingMode(),w=_&&(_.flowLoginCredentialOnWeb||_.flowSaveCredentialOnWeb),S={classic:"0",addObject:"2",pwdGenerator:"3",webOnboardingAfterSave:"4",webOnboardingAfterCancel:"5",webOnboardingAfterLogin:"6"},O="save-password"===a||"replace-password"===a,!l.default().isStandalone()){t.next=26;break}return P="mav",t.prev=13,t.next=16,d.default().isMarshmallowEnabled();case 16:t.sent&&(P="ml"),t.next=22;break;case 20:t.prev=20,t.t0=t.catch(13);case 22:I={type:a,action:f,context:w?"onboarding":y||void 0,website:i,displayCount:v,class:S[this._uiState.configuration]||"",triggeringFormType:b||void 0,guessedLoginStatus:O?this._guessedLoginStatus:void 0,loginStatusHints:O?this._loginStatusHints:void 0,analysis_engine_version:P},p.default().usageLog({code:s.UsageLogCode.USAGE_WEBCARDS,content:I}).catch((function(e){g.exceptionLog({funcName:"carbon.usageLog",fileName:"common/background/webui/Controller.ts",code:h.ExceptionCode.Error,message:(null==e?void 0:e.message)||"",type:"extensionException"})})),t.next=27;break;case 26:c.getInstance().sendOrderToCpp({action:"usageLogWebUI",details:{type:a,action:f,context:y,website:i,displayCount:v,triggeringFormType:b,os:l.default().getOSName(),browserVersion:l.default().getBrowserVersion(),browser:l.default().getBrowserName()}},this._tabId,"fromExtensionToCpp");case 27:case"end":return t.stop()}}),t,this,[[13,20]])})))}},{key:"_suicide",value:function(){var e=m.default().getControllerById(this._tabId);e&&e.signalWebUIHidden(this._type,this._uiId)}},{key:"sendCheckVisibilityResponse",value:function(e,t){this.postCheckVisibilityResponseMessage({action:"checkVisibilityResponse",isVisible:t,requestId:e})}},{key:"checkVisibility",value:function(e){c.getInstance().sendOrderToJs({action:"checkVisibilityRequest",requestId:e,uiId:this._uiId},this._tabId,"dashlaneMessageToWebPage")}},{key:"setGuessedLoginStatus",value:function(e,t){this._guessedLoginStatus=e,this._loginStatusHints=t}}]),e}();t.WebUIController=_;var w=void 0;t.setFactory=function(e){w=e},t.getWebUIFactory=function(){if(!w)throw g.exceptionLog({code:h.ExceptionCode.Error,fileName:"common/background/webui/Controller.ts",funcName:"getWebUIFactory",message:"getWebUIFactory is called but factoryClass is not initialized"}),"getWebUIFactory is called but instance is not initialized";return w}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkedPortInstanceChannel=t.PortInstanceChannel=t.events=void 0;var d=n(10),f=n(13);t.events={messageFromJs:d.slot(),messageFromExtension:d.slot()};var p=function(e){a(c,e);var t,n,r,s=u(c);function c(e){var t;return o(this,c),(t=s.call(this,f.default().isDebug()?5e4:5e3))._port=e,t._port.onDisconnect.addListener((function(){t._port=null,t._disconnected()})),t._port.onMessage.addListener((function(e){return t._messageReceived(e)})),t._connected(),t}return t=c,(n=[{key:"send",value:function(e){this._port&&this._port.postMessage(e)}}])&&i(t.prototype,n),r&&i(t,r),c}(d.GenericChannel);t.PortInstanceChannel=p;var g=function(e){a(n,e);var t=u(n);function n(e){var r;return o(this,n),(r=t.call(this,{chunkSize:1e3,sender:function(e){return r._port&&r._port.postMessage(e)},maxStringAlloc:Math.pow(2,14)-1}))._port=e,r._port.onDisconnect.addListener((function(){r._port=null,r._disconnected()})),r._port.onMessage.addListener((function(e){return r._messageReceived(e)})),r._connected(),r}return n}(d.ChunkedChannel);t.ChunkedPortInstanceChannel=g},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.removeCookiesForDomain=t.getCookiesForDomain=t.convertChromeCookiesToCookies=t.getUrlFromCookieDomain=t.getPremiumEndDate=t.getPremiumStatusCode=void 0;var a=n(40);t.getPremiumStatusCode=function(e){return e?e.statusCode:a.PremiumStatusCode.NEW_USER};t.getPremiumEndDate=function(e){return e?e.endDate:void 0};t.getUrlFromCookieDomain=function(e){var t="http"+(e.isSecure?"s":"")+"://";return t+=(e.domain.startsWith(".")?"www":"")+e.domain+e.path};t.convertChromeCookiesToCookies=function(e,n){var r=Object.assign(Object.assign({},e),{isSecure:e.secure});return Object.assign(Object.assign({},r),{url:n||t.getUrlFromCookieDomain(r)})};t.getCookiesForDomain=function(e){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(t){chrome.cookies.getAll(e,(function(e){return t(e||[])}))}));case 2:return r=n.sent,n.abrupt("return",r.map((function(n){return t.convertChromeCookiesToCookies(n,e.url)})));case 4:case"end":return n.stop()}}),n)})))};t.removeCookiesForDomain=function(e){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r(e),t.prev=1,i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.value,e.next=3,new Promise((function(e){chrome.cookies.remove({name:t.name,url:t.url},e)}));case 3:case"end":return e.stop()}}),e)})),n.s();case 4:if((o=n.n()).done){t.next=8;break}return t.delegateYield(i(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ABOUT_BLANK_URL=void 0,t.ABOUT_BLANK_URL="about:blank"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(400)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof msBrowser&&(chrome=msBrowser),"undefined"!=typeof browser&&(chrome=browser),n(401),n(603).init(),n(69).default().loadExtensionModeFromStorage().then((function(){var e=n(150).getInstance,t=n(118).default,r=n(151).default,o=n(152).getInstance,i=n(1026).default;e(),t(),o(),i(),n(1027),r().init()}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var r=n(35),o=n(604),i=n(605);t.init=function(){r.setAsyncStorageInstance(o.ChromeAsyncStorage),r.setSyncStorageInstance(i.ChromeSyncStorage)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeAsyncStorage=void 0;var r={getAll:function(){return new Promise((function(e){chrome.storage.local.get((function(t){e(t||{})}))}))},get:function(e){return new Promise((function(t){chrome.storage.local.get(e,(function(n){return t(n[e])}))}))},set:function(e,t){return new Promise((function(n){chrome.storage.local.set(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t),(function(){return n()}))}))},remove:function(e){return new Promise((function(t){chrome.storage.local.remove(e,(function(){return t()}))}))}};t.ChromeAsyncStorage=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeSyncStorage=void 0;var r=n(35),o=!0;try{window.localStorage}catch(e){o=!1,console.error("Could not use window.localStorage")}var i={},a={get:function(e){return i[e]},set:function(e,t){return i[e]=t},setRaw:function(e,t){return i[e]=t},getRaw:function(e){return i[e]},deleteRaw:function(e){delete i[e]}},s=o?r.LocalStorage:a;t.ChromeSyncStorage=s},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intrusiveException=void 0,t.intrusiveException={exceptions:[{name:"TIMED_OUT",message:"A timeout has occurred",contact:"Web Analysis Team"}]}},,,,,,,,function(e,t,n){"use strict";(function(e){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.setPopupChannel=t.setLeelooWs=t.getCarbonStorage=void 0;var o,i,a,s,u,c,l,d=n(627),f=n(40),p=n(708),g=n(285),h=n(140),m=n(95),v=n(211),y=n(13),b=n(35),_=n(324),w=n(817),S=n(95),O=n(196),P=n(110),I=n(194),C=n(818),k=n(145),E=n(10),R=n(325),T=n(1),x=n(326),L=n(820),M=n(327),A=n(866);function D(){var e=b.getAsyncStorageInstance();return new d.CarbonStorage({readItem:function(t){return e.get(t)},writeItem:function(t,n){return e.set(t,n)},removeItem:function(t){return e.remove(t)},itemExists:function(t){return e.get(t).then((function(e){return null!=e}))}})}t.getCarbonStorage=D,n(871),u=n(872),c=n(873),l=n(874),a=n(875),s=n(876),t.setLeelooWs=function(e){o=e},t.setPopupChannel=function(e){i=e},t.init=function(t){var n=this,N=new Worker(s);N.postMessage({type:"init",language:k.default().getLang(),isDebug:y.default().isDebug(),debugPort:4007,isStandalone:y.default().isStandalone()});var j=E.createEventBus({events:f.CarbonLeelooConnector,channels:[o]}),U=E.createEventBus({events:f.ExtensionCarbonConnector}),B=new p.WorkerChannel({worker:N,type:"MaverickBackend",isHost:!0}),F=E.createEventBus({events:R.apiEvents,channels:[o,x._CARBON_EXTENSION_CHANNEL,i,B]}),W=E.createEventBus({events:f.CarbonMaverickConnector,channels:[B]});W.exceptionLog.on((function(e){return console.error(e)}));var q=W;h.setMaverickBackendInstance(q);var H=E.createEventBus({events:f.ExtensionMaverickConnector,channels:[new p.WorkerChannel({worker:N,type:"MaverickExtension",isHost:!0})]});try{e.sharedTestMavConn=H}catch(e){}g.setInstance(H),m.setInstance(U);var G=E.createEventBus({events:f.CarbonDebugConnector}),V=function(e){var t=e.message,n=e.optionalParams;return t+(n.length?" ".concat(n.join(" ")):"")};G.error.on((function(e){return P.default().log(V(e),1,"Carbon")})),G.warning.on((function(e){return P.default().log(V(e),2,"Carbon")})),G.info.on((function(e){return P.default().log(V(e),3,"Carbon")})),G.log.on((function(e){return P.default().log(V(e),4,"Carbon")}));var K={connectors:{}};if(t){var z=E.createEventBus({events:M.passwordChangerEvents});L.connectPasswordChanger(t,z),K.connectors.passwordChanger=z}A.startExtensionIframeReplacer();var J=y.default().isStandalone()?r(n,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAsyncStorageInstance().get("isExtensionMigratedToSAEX");case 2:return e.t0=e.sent,t=!0===e.t0,e.next=6,d.init({storageLayer:D(),platformInfo:{platformName:"server_standalone",anonymousApplicationId:I.getAnonymousApplicationId(),appVersion:y.default().getBuildVersions().extension,browser:y.default().getBrowserName(),browserVersion:y.default().getBrowserVersion(),country:y.default().getBrowserCountry(),os:y.default().getOSName(),osCountry:y.default().getBrowserCountry(),osVersion:y.default().getOSVersion(),lang:y.default().getBrowserLanguage()},abTestForcedVersion:b.getSyncStorageInstance().get("abTestForcedVersion")||null,connectors:{api:F,debug:G,extension:U,leeloo:j,maverick:W},infrastructure:K,workers:{PBKDF2WebpackWorker:u,Argon2Asm:c,Argon2Wasm:l,Argon2JsWrapperForWasm:a,pbkdf2PolyfillWorker:u},keys:{appAccess:"C4F8H4SEAMXNBQVSASVBWDDZNCVTESMY",appSecret:"Na9Dz3WcmjMZ5pdYU1AmC5TdYkeWAOzvOK6PkbU4QjfjPQTSaXY8pjPwrvHfVH14"},settings:{sync:{syncWithLocalClients:!0},userABTestNames:["saexaddmobile","web_winback_test","smu_saex_try_autofill"],migratedToSAEX:t},publicPath:"./"});case 6:return e.abrupt("return",O.setReadyAndSendPendingLogs());case 7:case"end":return e.stop()}}),e)}))):Promise.resolve(),X=w.default.concat([110,232,72,104,108,100,204]).map((function(e){return e/2})).map((function(e){return String.fromCharCode(e)})).join(""),Y=function(e){S.default().exceptionLog({funcName:"init",fileName:"init.ts",code:T.ExceptionCode.Error,message:e.message||"An error occurred while getting assets",precisions:"",legacy:!1}),console.error("An error occurred",e)};return _.default().getBinaryAssetAsBase64("/textfiles/ar.txt").then((function(e){d.decipherDatabaseRules(X,e).then((function(e){if(!e||""===e)throw new Error("Error while deciphering cipheredDb");var t=JSON.parse(e);H.databasesReady(t).catch((function(e){e&&Y(e)})),y.default().isDebug()&&v.default().signalDatabasesSent(void 0)})).catch((function(e){Y(e)}))})).catch((function(e){return Y(e)})),C.default(H),J}}).call(this,n(20))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerChannel=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(e){var t,n=e.worker,r=e.type,o=e.isHost;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this))._worker=n,t._type=r,t._worker.addEventListener("message",(function(e){var n=e.data;if(n&&n.type===t._type)return"connected"===n.content?(o||t._signalConnected(),void t._connected()):void t._messageReceived(n.content)}),!1),o&&t._signalConnected(),t}return t=u,(n=[{key:"send",value:function(e){this._worker.postMessage({type:this._type,content:e})}},{key:"_signalConnected",value:function(){this._worker.postMessage({type:this._type,content:"connected"})}}])&&o(t.prototype,n),r&&o(t,r),u}(n(10).GenericChannel);t.WorkerChannel=c},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginStep=t.OpenSessionRequestType=t.ChangeDashlaneSettingsType=void 0,function(e){e.Domain="domain",e.Page="page"}(t.ChangeDashlaneSettingsType||(t.ChangeDashlaneSettingsType={})),function(e){e.SendLogin="sendEmail",e.SendPassword="sendPassword",e.SendToken="sendToken",e.SendOTPForNewDevice="sendOTPForNewDevice",e.SendOTP2="sendOTP2",e.ResendToken="resendToken"}(t.OpenSessionRequestType||(t.OpenSessionRequestType={})),function(e){e.Email="email",e.OTP2="OTP2",e.Welcome="welcome",e.OTP1="OTP1",e.OTPToken="token",e.Password="password",e.SSO="SSO",e.ActivateSSO="activateSSO"}(t.LoginStep||(t.LoginStep={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(290)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jenkinsOneAtATimeHash=t.id=void 0,t.id=function(e){return e},t.jenkinsOneAtATimeHash=function(e){for(var t=0,n=e.length;n--;)t+=e.charCodeAt(n),t+=t<<10,t^=t>>6;return t+=t<<3,(((t^=t>>11)+(t<<15)&4294967295)>>>0).toString(16)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformForPlugin=void 0;var r={KWAuthentifiant:function(e){return{AUTHENTIFIANT:{Password:e.password||"",Login:e.login||"",SecondaryLogin:e.secondaryLogin||"",Email:e.email||"",Url:e.url||"",Category:e.category||"",SpaceId:e.spaceId||"",Id:e.id||"",AutoProtected:e.protectWithMasterPassword||"",SubdomainOnly:e.onlyForThisSubdomain||""}}},KWAddress:function(e){return{ADDRESS:{addressName:e.addressName||"",receiver:e.receiver||"",addressFull:e.addressFull||"",city:e.city||"",zipcode:e.zipCode||"",state:e.state||"",country:e.country||"",streetNumber:e.streetNumber||"",building:e.building||"",stairs:e.stairs||"",floor:e.floor||"",door:e.door||"",digitCode:e.digitCode||""}}},KWCompany:function(e){return{COMPANY:{jobTitle:e.jobTitle||"",name:e.name||""}}},KWEmail:function(e){return{EMAIL:{email:e.email||"",emailName:e.emailName||""}}},KWIdentity:function(e){return{IDENTITY:{birthDate:e.birthDate||"",birthPlace:e.birthPlace||"",firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",pseudo:e.pseudo||"",title:e.title||""}}},KWPaymentMean_creditCard:function(e){return{PAYMENT_MEAN_CREDITCARD:{cardName:e.cardName||"",cardNumber:e.cardNumber||"",expireMonth:e.expireMonth||"",expireYear:e.expireYear||"",ownerName:e.ownerName||"",securityCode:e.securityCode||""}}},KWPersonalWebsite:function(e){return{WEBSITE:{name:e.name||"",website:e.website||""}}},KWPhone:function(e){return{PHONE:{number:e.number||"",phoneName:e.phoneName||"",type:e.type||""}}}};t.transformForPlugin=function(e){if(!r[e.kwType])throw new Error("Maverick for All does not handle ".concat(e.kwType," yet"));return r[e.kwType](e.content)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(35),i=n(191),a=n(13),s=n(110),u=n(108),c=n(194);t.default=function(e){var t=e.step,n=e.precisions,l="https://kck3hlb9.dashlane.com/1/installerlog/",d=u.getFullPlatformDetails(),f={step:t,version:a.default().getBuildVersions().extension,platform:a.default().getPlatform(),browser:a.default().getBrowser(),browserVersion:d.major},p=c.getAnonymousApplicationId(),g=o.getSyncStorageInstance().get("installerId"),h=o.getSyncStorageInstance().get("web_installerId"),m=u.getSimplePlatformString(),v=d.os.major;return p&&(f.anonymousapplicationid=p),g||h?(l+="create",f.os=m,f.osversion=v,f.step&&(f.step.startsWith("49")||f.step.startsWith("50")||f.step.startsWith("61"))?(f.anonymouscomputerid=h,f.desktopanonymouscomputerid=g):f.anonymouscomputerid=g):l+="createLight",n&&"object"===r(n)&&(f.content=JSON.stringify(n)),new Promise((function(e,t){i.post(l).type("form").send(f).end((function(n){if(n)return t(n);s.default().log("Successfully sent installer log. ",3),e()}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openApplication=t.makeVerifiedOpenApplicationOrder=void 0;var r=n(21),o=n(22),i=n(717),a=n(7),s=n(758),u=n(63),c=n(28),l=n(1),d=n(23),f=r.BaseOrderTarget,p=f.BACKGROUND,g=f.UNSPECIFIED;function h(e){var t=e.data,n=e.exceptionLog,i={from:p,to:g,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{tabId:-1,message:o.RuntimeOrderMessage.OpenApplication,data:t}};return u.getVerifiedOrder({protoLookupType:c.ProtoLookupType.OpenApplication,exceptionLog:n,order:i})}t.makeVerifiedOpenApplicationOrder=h,t.openApplication=function(e){var t=h({data:e,exceptionLog:d.nativeMessagingExceptionLog});t?a.sendMessage({order:t,internalHandler:s.sendInternalOrder,nativeMessagingHandler:a.sendNativeOrder,websocketHandler:i.sendLegacyOrder}):d.nativeMessagingExceptionLog({funcName:"openApplication",fileName:"common/background/runtime/openApplication/index.ts",code:l.ExceptionCode.Error,message:"Created message is not compatible with expected Desktop format"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLegacyOrder=t.makeLegacyOrder=t.makeOrderWithLink=t.makeOrderWithIdentifier=void 0;var r=n(7),o=n(41),i={passwords:"AUTHENTICATION"};function a(e){var t=e.identifier,n=e.link||"AUTHENTICATION",r=i[n]||n;return{action:o.LegacyOrderMessage.AskForActionOnObject,identifier:t,type:r,operation:"edit"}}function s(e){var t=o.LegacyOrderMessage.AskForOpenApplication;return e?{action:t,link:e}:{action:t}}function u(e){var t=e.link,n=e.identifier;return n?a({identifier:n,link:t}):s(t)}t.makeOrderWithIdentifier=a,t.makeOrderWithLink=s,t.makeLegacyOrder=u,t.sendLegacyOrder=function(e){var t=e.body,n=t.data,o=n.link,i=n.identifier,a=t.tabId,s=u({identifier:i,link:o});r.sendWebSocketOrder({order:s,tabId:a})}},function(e,t,n){"use strict";function r(e){if(e>=55296&&e<=57343)throw new Error("Illegal argument: "+e);if(e<0)throw new Error("Illegal argument: "+e);if(e<=127)return 1;if(e<=2047)return 2;if(e<=65535)return 3;if(e<=2097151)return 4;if(e<=67108863)return 5;if(e<=2147483647)return 6;throw new Error("Illegal argument: "+e)}function o(e){return e>=55296&&e<=56319}function i(e,t){if(!o(e))throw new Error("Illegal argument: "+e);if(!((n=t)>=56320&&n<=57343))throw new Error("Illegal argument: "+t);var n;return((e=(1023&e)<<10)|1023&t)+65536}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=0,n=0;n<e.length;n++){var a=e.charCodeAt(n);if(o(a))t+=r(i(a,e.charCodeAt(++n)));else t+=r(a)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleNativeOrder=void 0;var r=n(62),o=n(720),i=n(741),a=n(743),s=n(747),u=n(749),c=n(1),l=n(751),d=n(753),f=n(755),p=n(23);t.handleNativeOrder=function(e){var t=e.body.message;switch(t){case r.NativeAppMessage.LoginResponse:i.handleLoginResponse(e);break;case r.NativeAppMessage.SharedSessionResponse:o.handleSharedSessionResponse(e);break;case r.NativeAppMessage.LogoutRequest:a.handleLogoutRequest(e);break;case r.NativeAppMessage.LogoutResponse:s.handleLogoutResponse(e);break;case r.NativeAppMessage.RegisterResponse:u.handleRegisterResponse(e);break;case r.NativeAppMessage.CommunicationInitRequest:l.handleCommunicationInitRequest(e);break;case r.NativeAppMessage.CommunicationPingResponse:d.handleCommunicationPingResponse(e);break;case r.NativeAppMessage.ErrorResponse:f.handleErrorResponse(e);break;default:p.nativeMessagingExceptionLog({funcName:"handleNativeOrder",fileName:"common/background/communication/NativeMessagingController/messageHandler/index.ts",code:c.ExceptionCode.Error,message:'No handler for native messaging order "'.concat(t,'"'),precisions:JSON.stringify({order:e})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleSharedSessionResponse=t.makeVerifiedSharedSessionResponse=void 0;var r=n(11),o=n(28),i=n(721),a=n(1),s=n(23),u=n(71);t.makeVerifiedSharedSessionResponse=u.makeVerifyOrder({protoLookupType:o.ProtoLookupType.SharedSessionResponse,orderTypeGuard:i.isSharedSessionResponseOrder}),t.handleSharedSessionResponse=function(e){var n=t.makeVerifiedSharedSessionResponse({order:e,exceptionLog:s.nativeMessagingExceptionLog});if(n){var o=n.body.data,i=o.login,u=o.password,c=o.serverKey;r.carbon().openSessionWithMasterPassword({login:i,password:u,serverKey:c})}else s.nativeMessagingExceptionLog({funcName:"handleSharedSessionResponse",fileName:"common/background/messageHandler/sharedSessionResponse/index.ts",code:a.ExceptionCode.Error,message:"Desktop app sent an invalid response"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSharedSessionResponseOrder=void 0;var r=n(62);t.isSharedSessionResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.SharedSessionResponse&&e.body.data&&e.body.data.login&&e.body.data.password)}},,,,,,,,,,,,,,,,,,,function(e){e.exports=JSON.parse('{"nested":{"communicationInitPackage":{"nested":{"CommunicationInitRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}},"CommunicationInitResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}}}},"communicationPingPackage":{"nested":{"CommunicationPingRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}},"CommunicationPingResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}}}},"errorPackage":{"nested":{"ErrorResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"type":{"type":"string","id":2}}}}}}},"openApplicationPackage":{"nested":{"OpenApplication":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"data":{"type":"Data","id":2}},"nested":{"Data":{"fields":{"link":{"type":"string","id":1},"identifier":{"type":"string","id":2},"origin":{"type":"string","id":3}}}}}}}}},"loginPackage":{"nested":{"LoginRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"data":{"type":"Data","id":2}},"nested":{"Data":{"fields":{"forceLogin":{"type":"bool","id":1}}}}}}},"LoginResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"data":{"type":"Data","id":2}},"nested":{"Data":{"fields":{"userLoggedIn":{"type":"bool","id":1},"login":{"type":"string","id":2}}}}}}}}},"logoutPackage":{"nested":{"LogoutRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}},"LogoutResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}}}},"registerPackage":{"nested":{"RegisterRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}},"RegisterResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"data":{"type":"Data","id":2}},"nested":{"Data":{"fields":{"login":{"type":"string","id":1},"token":{"type":"string","id":2}}}}}}}}},"sharedSessionPackage":{"nested":{"SharedSessionRequest":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1}}}}},"SharedSessionResponse":{"fields":{"from":{"type":"string","id":1},"to":{"type":"string","id":2},"subject":{"type":"string","id":3},"body":{"type":"Body","id":4}},"nested":{"Body":{"fields":{"message":{"type":"string","id":1},"data":{"type":"Data","id":2}},"nested":{"Data":{"fields":{"login":{"type":"string","id":1},"password":{"type":"string","id":2},"serverKey":{"type":"string","id":3}}}}}}}}}}}')},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.handleLoginResponse=t.makeVerifiedLoginResponseOrder=void 0;var o=n(26),i=n(742),a=n(207),s=n(301),u=n(28),c=n(11),l=n(1),d=n(23),f=n(71);t.makeVerifiedLoginResponseOrder=f.makeVerifyOrder({protoLookupType:u.ProtoLookupType.LoginResponse,orderTypeGuard:i.isLoginResponseOrder}),t.handleLoginResponse=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.makeVerifiedLoginResponseOrder({order:e,exceptionLog:d.nativeMessagingExceptionLog})){n.next=4;break}return d.nativeMessagingExceptionLog({funcName:"handleLoginResponse",fileName:"common/background/messageHandler/login/response/index.ts",code:l.ExceptionCode.Error,message:"Desktop app sent an invalid response"}),n.abrupt("return");case 4:if(i=r.body.data,u=i.login,i.userLoggedIn){n.next=7;break}return n.abrupt("return");case 7:if(o.default().getIsUserLoggedIn(u)){n.next=11;break}return o.default().closePopup(),n.next=11,c.carbon().closeSession({});case 11:if(!o.default().hasLocalAccountData(u)){n.next=14;break}return a.requestSharedSession(),n.abrupt("return");case 14:s.requestRegister();case 15:case"end":return n.stop()}}),n)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLoginResponseOrder=void 0;var r=n(62);t.isLoginResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.LoginResponse&&e.body.data&&e.body.data.login&&e.body.data.userLoggedIn)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleLogoutRequest=t.makeVerifiedLogoutRequestOrder=void 0;var r=n(28),o=n(744),i=n(302),a=n(1),s=n(23),u=n(71);t.makeVerifiedLogoutRequestOrder=u.makeVerifyOrder({protoLookupType:r.ProtoLookupType.LogoutRequest,orderTypeGuard:o.isLogoutRequestOrder}),t.handleLogoutRequest=function(e){t.makeVerifiedLogoutRequestOrder({order:e,exceptionLog:s.nativeMessagingExceptionLog})?i.respondLogout():s.nativeMessagingExceptionLog({funcName:"handleLogoutRequest",fileName:"common/background/messageHandler/logout/request/index.ts",code:a.ExceptionCode.Error,message:"Desktop app sent an invalid response"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLogoutRequestOrder=void 0;var r=n(62);t.isLogoutRequestOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.LogoutRequest)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogoutResponseInternalOrder=void 0;var r=n(11);t.sendLogoutResponseInternalOrder=function(){r.carbon().closeSession({})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogoutResponseNativeOrder=void 0;var r=n(7),o=n(11);t.sendLogoutResponseNativeOrder=function(e){o.carbon().closeSession({}),r.sendNativeOrder(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleLogoutResponse=t.makeVerifiedLogoutResponseOrder=void 0;var r=n(28),o=n(748),i=n(303),a=n(1),s=n(23),u=n(71);t.makeVerifiedLogoutResponseOrder=u.makeVerifyOrder({protoLookupType:r.ProtoLookupType.LogoutResponse,orderTypeGuard:o.isLogoutResponseOrder}),t.handleLogoutResponse=function(e){t.makeVerifiedLogoutResponseOrder({exceptionLog:s.nativeMessagingExceptionLog,order:e})?i.sendLogoutRequestInternalOrder():s.nativeMessagingExceptionLog({funcName:"handleLogoutResponse",fileName:"common/background/messageHandler/logout/response/index.ts",code:a.ExceptionCode.Error,message:"Desktop app sent an invalid response"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLogoutResponseOrder=void 0;var r=n(62);t.isLogoutResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.LogoutResponse)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegisterResponse=t.makeVerifiedRegisterResponseOrder=void 0;var o=n(11),i=n(28),a=n(750),s=n(1),u=n(207),c=n(40),l=n(23),d=n(71);t.makeVerifiedRegisterResponseOrder=d.makeVerifyOrder({protoLookupType:i.ProtoLookupType.RegisterResponse,orderTypeGuard:a.isRegisterResponseOrder}),t.handleRegisterResponse=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,d,f,p;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.makeVerifiedRegisterResponseOrder({order:e,exceptionLog:l.nativeMessagingExceptionLog}),i="messageHandler/register/response/index.ts",r&&a.isRegisterResponseOrder(r)){n.next=5;break}return l.nativeMessagingExceptionLog({funcName:"handleRegisterResponse",fileName:i,code:s.ExceptionCode.Error,message:"Desktop app sent an invalid response"}),n.abrupt("return");case 5:return d=r.body.data,f=d.login,p=d.token,n.next=8,o.carbon().openSessionWithExtraDeviceToken({login:f,extraDeviceToken:p,persistData:!0});case 8:if(n.sent===c.LoginResultEnum.MasterPasswordMissing){n.next=12;break}return l.nativeMessagingExceptionLog({funcName:"handleRegisterResponse",fileName:i,code:0,message:"Carbon could not authorize extra device"}),n.abrupt("return");case 12:u.requestSharedSession();case 13:case"end":return n.stop()}}),n)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRegisterResponseOrder=void 0;var r=n(62);t.isRegisterResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.data&&e.body.data.login&&e.body.data.token&&e.body.message===r.NativeAppMessage.RegisterResponse)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCommunicationInitRequest=t.makeVerifiedCommunicationInitRequestOrder=void 0;var r=n(28),o=n(752),i=n(141),a=n(304),s=n(23),u=n(71);t.makeVerifiedCommunicationInitRequestOrder=u.makeVerifyOrder({protoLookupType:r.ProtoLookupType.CommunicationInitRequest,orderTypeGuard:o.isCommunicationInitRequestOrder}),t.handleCommunicationInitRequest=function(e){t.makeVerifiedCommunicationInitRequestOrder({exceptionLog:s.nativeMessagingExceptionLog,order:e})?(a.sendCommunicationInitResponse(),i.onNativeAppConnection()):s.nativeMessagingExceptionLog({funcName:"handleCommunicationInitRequest",fileName:"common/background/messageHandler/communicationRequest/index.ts",code:0,message:"Desktop app sent an invalid response"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCommunicationInitRequestOrder=void 0;var r=n(62);t.isCommunicationInitRequestOrder=function(e){return Boolean(e&&e.body&&e.body.message===r.NativeAppMessage.CommunicationInitRequest)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCommunicationPingResponse=t.makeVerifiedCommunicationPingResponseOrder=void 0;var r=n(28),o=n(754),i=n(305),a=n(23),s=n(71);t.makeVerifiedCommunicationPingResponseOrder=s.makeVerifyOrder({protoLookupType:r.ProtoLookupType.CommunicationPingResponse,orderTypeGuard:o.isCommunicationPingResponseOrder}),t.handleCommunicationPingResponse=function(e){t.makeVerifiedCommunicationPingResponseOrder({order:e,exceptionLog:a.nativeMessagingExceptionLog})?i.handlePingResponse(i.startPingSequence):a.nativeMessagingExceptionLog({funcName:"handleCommunicationPingResponse",fileName:"common/background/messageHandler/communication/ping/response/index.ts",code:0,message:"Desktop app sent an invalid response"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCommunicationPingResponseOrder=void 0;var r=n(62);t.isCommunicationPingResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.CommunicationPingResponse)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleErrorResponse=t.makeVerifiedErrorResponse=void 0;var r=n(6),o=n(28),i=n(756),a=n(1),s=n(23),u=n(71);t.makeVerifiedErrorResponse=u.makeVerifyOrder({protoLookupType:o.ProtoLookupType.ErrorResponse,orderTypeGuard:i.isErrorResponseOrder}),t.handleErrorResponse=function(e){var n=t.makeVerifiedErrorResponse({order:e,exceptionLog:s.nativeMessagingExceptionLog}),o="messageHandler/error/response/index.ts";n?r.exceptionLog({funcName:"handleErrorResponse",fileName:o,code:a.ExceptionCode.Error,message:n.body.message,precisions:JSON.stringify({subType:"DesktopApp"})}):s.nativeMessagingExceptionLog({funcName:"handleErrorResponse",fileName:o,code:a.ExceptionCode.Error,message:"Desktop app sent an invalid error order"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorResponseOrder=void 0;var r=n(62);t.isErrorResponseOrder=function(e){return Boolean(e&&e.from&&e.to&&e.subject&&e.body&&e.body.message===r.NativeAppMessage.ErrorResponse&&e.body.type)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommunicationMode=t.computeCommunicationMode=t.CommunicationMode=void 0;var r,o=n(13);!function(e){e[e.NATIVE_MESSAGING=0]="NATIVE_MESSAGING",e[e.WEB_SOCKETS=1]="WEB_SOCKETS",e[e.INTERNAL=2]="INTERNAL"}(r=t.CommunicationMode||(t.CommunicationMode={}));var i=r,a=i.WEB_SOCKETS,s=i.INTERNAL;t.computeCommunicationMode=function(e){return e.isStandalone?s:a};t.getCommunicationMode=function(){return t.computeCommunicationMode({isStandalone:o.default().isStandalone()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendInternalOrder=t.makeRoute=void 0;var r=n(26),o=n(307),i={console:"console",login:"login",passwords:"credentials","security-dashboard":"dark-web-monitoring",signup:"signup"};function a(e){var t=e.link,n=e.identifier;if(!t)return o.CURRENT_TAB_PATH;var r=i[t];return r?n?"".concat(r,"/").concat(n):r:o.CURRENT_TAB_PATH}t.makeRoute=a,t.sendInternalOrder=function(e){var t=e.body.data,n=a({link:t.link,identifier:t.identifier});r.default().openLeelooTab(n),r.default().closePopup()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetUserMessagesInternalOrder=t.makeGetUserMessagesInternalOrder=void 0;var r=n(26),o=n(309),i=n(50);function a(){var e=[],t=!r.default().isUserMessageDismissed(o.UserMessageType.TrialExpired),n=r.default().getPremiumStatus(),i=r.default().getFeatureToggle("trialExpiredFeature"),a=o.getTrialExpiredMessage({isVisible:t,premiumStatus:n,trialExpiredFeature:i});return a&&e.push(a),0!==e.length?e:null}t.makeGetUserMessagesInternalOrder=a,t.sendGetUserMessagesInternalOrder=function(){var e=a();e&&r.default().postMessageToPopover(i.ExtensionPopupActions.SignalUserMessages,{data:e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTrialExpiredMessage=t.isUserPaywalledForClient=void 0;var r=n(40),o=n(309);function i(e){var t=e.premiumStatus,n=e.currentDate,o=void 0===n?Date.now():n;switch(t.statusCode){case r.PremiumStatusCode.PREMIUM:case r.PremiumStatusCode.OLD_ACCOUNT:case r.PremiumStatusCode.NEW_USER:case r.PremiumStatusCode.GRACE_PERIOD:return!1;case r.PremiumStatusCode.PREMIUM_CANCELLED:var i=t.endDate;return!!i&&1e3*i-o<0;case r.PremiumStatusCode.NO_PREMIUM:default:return!0}}t.isUserPaywalledForClient=i,t.getTrialExpiredMessage=function(e){var t=e.trialExpiredFeature,n=e.isVisible,r=e.premiumStatus;if(!t){if(!r||"number"!=typeof r.statusCode)return null;if(i({premiumStatus:r})&&n)return{type:o.UserMessageType.TrialExpired}}return null}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetInitialDataLegacyOrder=t.makeGetInitialDataLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(){return{action:i.LegacyOrderMessage.GetInitialData}}t.makeGetInitialDataLegacyOrder=s,t.sendGetInitialDataLegacyOrder=function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s(),e.next=3,a.default().getCurrentTabId();case 3:n=e.sent,o.sendWebSocketOrder({order:t,tabId:n});case 5:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetInitialDataInternalOrder=void 0;var o=n(26),i=n(50),a=n(112),s=n(311);t.sendGetInitialDataInternalOrder=function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.performanceMethods.mark(a.PerformanceMarker.ASK_CARBON_DATA),e.next=3,s.getABTest(s.ABTestKeys.CHURNED_DISCOUNT_OFFER_AB_TEST);case 3:t=e.sent,o.default().postMessageToPopover(i.ExtensionPopupActions.PopoverV2SignalDataRefresh,{data:Object.assign(Object.assign({},o.default().getUserData()),{churnedDiscountOfferTestInfo:{isABTestParticipant:t}})});case 5:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getABTest=t.ABTestKeys=void 0;var o=n(11);!function(e){e.CHURNED_DISCOUNT_OFFER_AB_TEST="web_winback_test"}(t.ABTestKeys||(t.ABTestKeys={})),t.getABTest=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.extensionCarbonConnector.getUserABTestVariant(e);case 2:if("controlGroup"!==(n=t.sent)){t.next=6;break}return o.extensionCarbonConnector.participateToUserABTest(e),t.abrupt("return",!1);case 6:if("A"!==n){t.next=9;break}return o.extensionCarbonConnector.participateToUserABTest(e),t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendRequestLoginLegacyOrder=t.makeRequestLoginLegacyOrder=void 0;var r=n(7),o=n(41);function i(){return{action:o.LegacyOrderMessage.AskLogin,status:"loggedout"}}t.makeRequestLoginLegacyOrder=i,t.sendRequestLoginLegacyOrder=function(e){var t=i();r.sendWebSocketOrder({order:t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendRequestLoginInternalOrder=void 0;var r=n(26),o=n(307);t.sendRequestLoginInternalOrder=function(){r.default().openLeelooTab(o.CURRENT_TAB_PATH)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogoutRequestLegacyOrder=t.makeRequestLogoutLegacyOrder=void 0;var r=n(7),o=n(41);function i(){return{action:o.LegacyOrderMessage.AskLogout,status:"logout",confirmation:!0,dontShowAgain:!1}}t.makeRequestLogoutLegacyOrder=i,t.sendLogoutRequestLegacyOrder=function(){var e=i();r.sendWebSocketOrder({order:e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendLogoutRequestNativeOrder=void 0;var r=n(7),o=n(11);t.sendLogoutRequestNativeOrder=function(e){o.carbon().closeSession({}),r.sendNativeOrder(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoLoginPassword=t.makeAutoLoginPasswordOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(769),s=r.BaseOrderTarget,u=s.BACKGROUND,c=s.UNSPECIFIED;function l(e){var t=e.identifier;return{from:u,to:c,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.AutoLoginPassword,data:{identifier:t}}}}t.makeAutoLoginPasswordOrder=l,t.autoLoginPassword=function(e){var t=l(e);i.sendMessage({order:t,websocketHandler:a.sendAutoLoginPasswordLegacyOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendAutoLoginPasswordLegacyOrder=t.makeAutoLoginPasswordLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.identifier;return{action:i.LegacyOrderMessage.AutoLoginPassword,identifier:t}}t.makeAutoLoginPasswordLegacyOrder=s,t.sendAutoLoginPasswordLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data.identifier,r=s({identifier:n}),t.next=4,a.default().getCurrentTabId();case 4:i=t.sent,o.sendWebSocketOrder({order:r,tabId:i});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillPassword=t.makeFillPasswordOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(771),s=r.BaseOrderTarget,u=s.BACKGROUND,c=s.UNSPECIFIED;function l(e){var t=e.password;return{from:u,to:c,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.FillPassword,data:{password:t}}}}t.makeFillPasswordOrder=l,t.fillPassword=function(e){var t=l(e);i.sendMessage({order:t,websocketHandler:a.sendFillPasswordLegacyOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendFillPasswordLegacyOrder=t.makeFillPasswordLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.password;return{action:i.LegacyOrderMessage.FillPassword,password:t}}t.makeFillPasswordLegacyOrder=s,t.sendFillPasswordLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data.password,r=s({password:n}),t.next=4,a.default().getCurrentTabId();case 4:i=t.sent,o.sendWebSocketOrder({order:r,tabId:i});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePassword=t.makeGeneratePasswordOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(773),s=n(774),u=r.BaseOrderTarget,c=u.BACKGROUND,l=u.UNSPECIFIED;function d(e){var t=e.avoidAmbiguous,n=e.digits,i=e.length,a=e.letters,s=e.symbols;return{from:c,to:l,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.GeneratePassword,data:{avoidAmbiguous:t,digits:n,length:i,letters:a,symbols:s}}}}t.makeGeneratePasswordOrder=d,t.generatePassword=function(e){var t=d(e);i.sendMessage({order:t,websocketHandler:a.sendGeneratePasswordLegacyOrder,nativeMessagingHandler:s.sendGeneratePasswordInternalOrder,internalHandler:s.sendGeneratePasswordInternalOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGeneratePasswordLegacyOrder=t.makeGeneratePasswordLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.avoidAmbiguous,n=e.digits,r=e.length,o=e.letters,a=e.symbols;return{action:i.LegacyOrderMessage.GeneratePassword,avoidAmbiguous:t,avoidambiguous:t,length:r,size:r,digits:n,letters:o,mixedcase:!0,symbols:a}}t.makeGeneratePasswordLegacyOrder=s,t.sendGeneratePasswordLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s(e.body.data),t.next=3,a.default().getCurrentTabId();case 3:r=t.sent,o.sendWebSocketOrder({order:n,tabId:r});case 5:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGeneratePasswordInternalOrder=void 0;var o=n(11),i=n(26),a=n(50);t.sendGeneratePasswordInternalOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.carbon().generatePassword(e.body.data);case 2:n=t.sent,i.default().postMessageToPopover(a.ExtensionPopupActions.PopoverV2SignalPasswordGenerated,{data:n});case 4:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveGeneratedPassword=t.makeSaveGeneratedPasswordOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(776),s=n(777),u=r.BaseOrderTarget,c=u.BACKGROUND,l=u.UNSPECIFIED;function d(e){var t=e.password;return{from:c,to:l,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.SaveGeneratedPassword,data:{password:t}}}}t.makeSaveGeneratedPasswordOrder=d,t.saveGeneratedPassword=function(e){var t=d(e);i.sendMessage({order:t,websocketHandler:s.sendLegacySaveGeneratedPasswordOrder,nativeMessagingHandler:a.sendSaveGeneratedPasswordInternalOrder,internalHandler:a.sendSaveGeneratedPasswordInternalOrder})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendSaveGeneratedPasswordInternalOrder=void 0;var r=n(11);t.sendSaveGeneratedPasswordInternalOrder=function(e){var t=e.body.data.password;r.carbon().saveGeneratedPassword({password:t})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendLegacySaveGeneratedPasswordOrder=t.makeSaveGeneratedPasswordLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.password;return{action:i.LegacyOrderMessage.SaveGeneratedPassword,password:t}}t.makeSaveGeneratedPasswordLegacyOrder=s,t.sendLegacySaveGeneratedPasswordOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data.password,r=s({password:n}),t.next=4,a.default().getCurrentTabId();case 4:i=t.sent,o.sendWebSocketOrder({order:r,tabId:i});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.savePasswordGeneratorOptions=t.makeSavePasswordGeneratorOptionsOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(779),s=n(780),u=r.BaseOrderTarget,c=u.BACKGROUND,l=u.UNSPECIFIED;function d(e){var t=e.avoidAmbiguous,n=e.digits,i=e.length,a=e.letters,s=e.symbols;return{from:c,to:l,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.SavePasswordGeneratorOptions,data:{avoidAmbiguous:t,digits:n,length:i,letters:a,symbols:s}}}}t.makeSavePasswordGeneratorOptionsOrder=d,t.savePasswordGeneratorOptions=function(e){var t=d(e);i.sendMessage({order:t,websocketHandler:a.sendSavePasswordGeneratorOptionsLegacyOrder,internalHandler:s.sendSavePasswordGeneratorOptionsInternalOrder,nativeMessagingHandler:s.sendSavePasswordGeneratorOptionsInternalOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendSavePasswordGeneratorOptionsLegacyOrder=t.makeSavePasswordGeneratorOptionsLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.avoidAmbiguous,n=e.digits,r=e.length,o=e.letters,a=e.symbols;return{action:i.LegacyOrderMessage.SavePasswordGeneratorOptions,avoidAmbiguous:t,avoidambiguous:t,digits:n,length:r,letters:o,mixedcase:!0,size:r,symbols:a}}t.makeSavePasswordGeneratorOptionsLegacyOrder=s,t.sendSavePasswordGeneratorOptionsLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data,r=s(n),t.next=4,a.default().getCurrentTabId();case 4:i=t.sent,o.sendWebSocketOrder({order:r,tabId:i});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendSavePasswordGeneratorOptionsInternalOrder=void 0;var r=n(11);t.sendSavePasswordGeneratorOptionsInternalOrder=function(e){r.carbon().saveGeneratePasswordOptions(e.body.data)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeDashlaneSettings=t.makeChangeDashlaneSettingsOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(782),s=n(784),u=r.BaseOrderTarget,c=u.BACKGROUND,l=u.UNSPECIFIED;function d(e){var t=e.settings,n=e.type;return{from:c,to:l,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.ChangeDashlaneSettings,data:{settings:t,type:n}}}}t.makeChangeDashlaneSettingsOrder=d,t.changeDashlaneSettings=function(e){var t=d(e);i.sendMessage({order:t,websocketHandler:a.sendChangeDashlaneSettingsLegacyOrder,internalHandler:s.sendChangeDashlaneSettingsInternalOrder,nativeMessagingHandler:s.sendChangeDashlaneSettingsInternalOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendChangeDashlaneSettingsLegacyOrder=t.makeLegacyOrders=t.ToggleDashlaneSettingsFeature=void 0;var o,i=n(7),a=n(41),s=n(19),u=n(198),c=n(314),l=c.toggleDashlaneSettingsLegacyController,d=l.getQueue,f=l.ifQueueIsEmpty,p=l.getSettings,g=l.setSettings;function h(e){var t=e.type,n=e.settings,r=n.autoFill,i=n.autoLogin,s=e.currentSettings,u=s.autoFill,c=s.autoLogin,l=e.url,d=[];return r!==u&&d.push({action:a.LegacyOrderMessage.ToggleDashlaneSettings,feature:o.AutoFill,type:t,url:l}),i!==c&&d.push({action:a.LegacyOrderMessage.ToggleDashlaneSettings,feature:o.AutoLogin,type:t,url:l}),d}!function(e){e.AutoFill="autofill",e.AutoLogin="autologin"}(o=t.ToggleDashlaneSettingsFeature||(t.ToggleDashlaneSettingsFeature={})),t.makeLegacyOrders=h,t.sendChangeDashlaneSettingsLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,a,c,l,m,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data,r=n.type,o=n.settings,t.next=3,s.default().getCurrentTabController();case 3:return a=t.sent,c=a?a.getLocation():"",l=p(r),m=h(Object.assign(Object.assign({},e.body.data),{url:c,currentSettings:l})),g(r,o),t.next=10,s.default().getCurrentTabId();case 10:v=t.sent,m.forEach((function(e,t){d().add((function(){i.sendWebSocketOrder({order:e,tabId:v}),t===m.length-1&&setTimeout((function(){return f(u.getWebsiteInfo)}),2e3)}))}));case 12:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r(this,e),this.queue=0,this.delay=0,this.timestamp=0,this.timeout=t,this.increment=n,this.delay=this.timeout}var t,n,i;return t=e,(n=[{key:"add",value:function(e){var t=this,n=Date.now();n-this.timestamp>this.timeout+this.delay?(this.queue=0,this.delay=this.timeout,this.timestamp=n,e()):(this.isEmpty()&&(this.delay=this.timeout),this.queue++,this.delay+=this.increment,this.timestamp+=this.delay,setTimeout((function(){t.queue--,e()}),this.timestamp-n))}},{key:"isEmpty",value:function(){return 0===this.queue}}])&&o(t.prototype,n),i&&o(t,i),e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendChangeDashlaneSettingsInternalOrder=t.makeToggleDashlaneSettingsInternalOrder=void 0;var o=n(209),i=n(11),a=n(19);function s(e){var t=e.currentTabController,n=e.autoFill,r=e.autoLogin;return{url:t.getLocation(),autofill:n,autologin:r}}t.makeToggleDashlaneSettingsInternalOrder=s,t.sendChangeDashlaneSettingsInternalOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default().getCurrentTabController();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:r=e.body.data,u=r.settings,c=r.type,l=s(Object.assign({currentTabController:n},u)),t.t0=c,t.next=t.t0===o.ChangeDashlaneSettingsType.Page?10:t.t0===o.ChangeDashlaneSettingsType.Domain?12:14;break;case 10:return i.carbon().toggleDashlaneOnPage(l),t.abrupt("break",14);case 12:return i.carbon().toggleDashlaneOnSite(l),t.abrupt("break",14);case 14:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendUsageLog=t.makeUsageLogOrder=void 0;var r=n(21),o=n(22),i=n(7),a=n(786),s=n(787),u=n(13),c=r.BaseOrderTarget,l=c.BACKGROUND,d=c.UNSPECIFIED;function f(e){var t=e.action,n=e.details,i=e.type,a=e.extensionVersion;return{from:l,to:d,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.SendUsageLog,data:{action:t,type:i,details:n,extensionVersion:a}}}}t.makeUsageLogOrder=f,t.sendUsageLog=function(e){var t=e.action,n=e.type,r=e.details,o=f({action:t,details:void 0===r?{}:r,type:n,extensionVersion:u.default().getBuildVersions().extension});i.sendMessage({order:o,websocketHandler:a.sendUsageLogLegacyOrder,internalHandler:s.sendUsageLogInternalOrder,nativeMessagingHandler:s.sendUsageLogInternalOrder})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendUsageLogLegacyOrder=t.makeUsageLogLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.action,n=e.details,r=e.type,o=e.extensionVersion;return{action:i.LegacyOrderMessage.SendUsageLog,extensionversion:o,service:r,type:t,details:n.website,logType:r,logAction:t,logDetailsWebsite:n.website,logDetailsABStatus:n.ABStatus}}t.makeUsageLogLegacyOrder=s,t.sendUsageLogLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,u,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data,r=n.action,i=n.details,u=n.type,c=n.extensionVersion,l=s({action:r,details:i,type:u,extensionVersion:c}),t.next=4,a.default().getCurrentTabId();case 4:d=t.sent,o.sendWebSocketOrder({order:l,tabId:d});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendUsageLogInternalOrder=t.makeUsageLogInternalOrder=t.USAGE_LOG_CODE=void 0;var o=n(26),i=n(70),a=n(11),s=n(6),u=n(1);function c(e){var n=e.type,i=e.action,a=e.details,s=e.extensionVersion,u=e.webOnboardingMode;return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u&&(u.flowSaveCredentialOnWeb||u.flowLoginCredentialOnWeb),c="mav",e.prev=2,e.next=5,o.default().isMarshmallowEnabled();case 5:e.sent&&(c="ml"),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return",{code:t.USAGE_LOG_CODE,content:Object.assign({extensionversion:s,context:r?"onboarding":"",type:n,action:i,analysis_engine_version:c},a)});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))}t.USAGE_LOG_CODE=51,t.makeUsageLogInternalOrder=c,t.sendUsageLogInternalOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,l,d,f,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.body.data,r=n.type,l=n.action,d=n.details,f=n.extensionVersion,o.default().userLoggedIn){t.next=4;break}return i.default().log(4,"User not logged In : UsageLog ".concat(r," ").concat(l," cannot be fired"),"runtime/usageLog/sendInternalOrder"),t.abrupt("return");case 4:return t.next=6,c({type:r,action:l,details:d,extensionVersion:f,webOnboardingMode:o.default().getWebOnboardingMode()});case 6:p=t.sent,a.carbon().usageLog(p).catch((function(e){s.exceptionLog({funcName:"carbon.usageLog",fileName:"common/background/webui/Controller.ts",code:u.ExceptionCode.Error,message:(null==e?void 0:e.message)||"",type:"extensionException"})}));case 8:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetWebsiteInfoLegacyOrder=t.makeGetWebsiteInfoLegacyOrder=void 0;var o=n(7),i=n(41),a=n(19);function s(e){var t=e.fullUrl;return{action:i.LegacyOrderMessage.GetWebsiteInfo,fullUrl:t}}t.makeGetWebsiteInfoLegacyOrder=s,t.sendGetWebsiteInfoLegacyOrder=function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body.data.fullUrl,r=s({fullUrl:n}),t.next=4,a.default().getCurrentTabId();case 4:i=t.sent,o.sendWebSocketOrder({order:r,tabId:i});case 6:case"end":return t.stop()}}),t)})))}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.MigrationAlertController=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._isDismissed=!1}var t,n,o;return t=e,(n=[{key:"dismiss",value:function(){this._isDismissed=!0}},{key:"reset",value:function(){this._isDismissed=!1}},{key:"shouldDisplayAlert",value:function(e){var t=!0===e.migrationComms||"true"===e.migrationComms,n=!0===e.migrationSAEX||"true"===e.migrationSAEX,r=!0===e.testMigration||"true"===e.testMigration;return t&&!n&&!r&&!this._isDismissed}}])&&r(t.prototype,n),o&&r(t,o),e}();t.MigrationAlertController=o},,,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.MigrationSwitchAlertController=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"shouldDisplayAlert",value:function(e){var t=!0===e.testMigration||"true"===e.testMigration,n=!0===e.migrationSAEX||"true"===e.migrationSAEX;return t||n}}])&&r(t.prototype,n),o&&r(t,o),e}();t.MigrationSwitchAlertController=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDomainIconMapEmpty=void 0;var r=n(794),o=n(13),i={};t.isDomainIconMapEmpty=function(){return 0===Object.keys(i).length},t.default=function(e){var t=e.filter((function(e){return void 0===i[e]}));if(!t.length)return Promise.resolve(i);var n=o.default().isHiDPICapable()?"50x33@2x":"50x33",a=t.map((function(e){return{domain:e,type:n}}));return r.getIcons(a).then((function(e){return e.map((function(e){return e.url?{url:e.url,color:e.backgroundColor?"#".concat(e.backgroundColor):null,icon:e.url}:null}))})).then((function(e){return e.forEach((function(e,n){var r=t[n];i[r]=e})),i})).catch((function(){return i}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIcons=void 0;var r=n(795),o=n(317);t.getIcons=function(e){return t="2/iconcrawler/getIcons",n={domainsInfo:e},i=function(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return t[n]=Array.isArray(r)?JSON.stringify(r):r,t}),{})},r.default.post("https://ws1.dashlane.com/".concat(t),n,{transformRequest:[function(e){return o.stringify(i?i(e):e)}]}).then((function(e){return e.data.content}));var t,n,i}},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){for(var t=/([^\\](\\\\)*)\\'/,n=e;t.test(n);)n=n.replace(t,"$1\\\\'");return n}Object.defineProperty(t,"__esModule",{value:!0}),t.fixOrderEncoding=t.fixJSONEncoding=void 0,t.fixJSONEncoding=r,t.fixOrderEncoding=function(e){return e.content?Object.assign(Object.assign({},e),{content:r(e.content)}):e}},function(e,t,n){"use strict";function r(e){return function(t){for(var n=0,r=t.length;n<r;n++){var o=t.charAt(n);if(!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.treatVar=void 0;r({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0}),r({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,".":!0,",":!0});t.treatVar=function(e){return void 0===e||""===e?e:"true"===e||"false"!==e&&e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GET_PREMIUM_URL=void 0,t.GET_PREMIUM_URL="https://www.dashlane.com/getpremium"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[214,238,100,106,146,140,114]},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(191),i=n(35),a=n(110),s=n(13),u="https://ws1.dashlane.com/1/crowdbugz";var c=function(){function e(t){var n,r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._lastUpdateDateUnix=0,this._serverRules=[],this._localRules=[],this._conn=t,this._localRules=(n=i.getSyncStorageInstance().get("maverick.userDefinedRules"))?JSON.parse(n):[],this._conn.ruleCreated.on((function(e){r._saveNewRule(e),r._sendRulesToMaverick()})),this._startSeverSync()}var t,n,c;return t=e,(n=[{key:"_sendRulesToMaverick",value:function(){a.default().log("Sending ".concat(this._serverRules.length," server rules and ").concat(this._localRules.length," local rules to Maverick"),3,"UserDefinedRules"),this._conn.rulesSynchronized({local:this._localRules,remote:this._serverRules})}},{key:"_saveNewRule",value:function(e){var t;this._localRules=this._localRules.filter((function(t){return t.domain!==e.domain||t.hashId!==e.hashId})).concat(e),t=this._localRules,i.getSyncStorageInstance().set("maverick.userDefinedRules",JSON.stringify(t)),o.post("".concat(u,"/sendFix")).type("form").send({anonymousUserId:"2",browser:s.default().getBrowser(),os:"extension",version:"5",rule:JSON.stringify(e)}).end((function(e){if(e)return a.default().log("Error while posting created rule: ".concat(e),0,"UserDefinedRules");a.default().log("Rule created successfully",3,"UserDefinedRules")}))}},{key:"_mergeServerRules",value:function(e){var t=e.filter((function(e){return"invalidated"!==e.status})),n=e.filter((function(e){return"invalidated"!==e.status})).map((function(e){return e.ruleId}));this._serverRules=this._serverRules.filter((function(e){return!n.includes(e.ruleId)})).concat(t),a.default().log("".concat(e.length," server rules received, now have ").concat(this._serverRules.length," rules"),3,"UserDefinedRules")}},{key:"_getSyncTimeout",value:function(e){return e&&e.nextPoll?(a.default().log("Next sync in ".concat(e.nextPoll,"s"),3,"UserDefinedRules"),1e3*e.nextPoll):(a.default().log("Next sync in one hour",1,"UserDefinedRules"),6e4)}},{key:"_startSeverSync",value:function(){var e=this;!function t(){a.default().log("Syncing",3,"UserDefinedRules");var n={timestamp:e._lastUpdateDateUnix};o.post("".concat(u,"/getRules")).type("form").send(n).end((function(n,r){if(n)return a.default().log("Sync error: ".concat(n),0,"UserDefinedRules"),void setTimeout(t,e._getSyncTimeout());if(200!==r.body.code)return a.default().log("Sync error: ".concat(r.body.code," ").concat(r.body.message),0,"UserDefinedRules"),void setTimeout(t,e._getSyncTimeout());a.default().log("Sync sucessful",3,"UserDefinedRules");var o=r.body.content;e._mergeServerRules(o.rules),e._sendRulesToMaverick(),e._lastUpdateDateUnix=o.lastUpdateDateUnix,setTimeout(t,e._getSyncTimeout(o))}))}()}}])&&r(t.prototype,n),c&&r(t,c),e}();t.default=function(e){return new c(e)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.connectLocalChannels=t.LocalChannel=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){var e;return o(this,c),(e=u.apply(this,arguments))._isConnected=!1,e._connectedChannelReceive=function(){},e}return t=c,(n=[{key:"send",value:function(e){if(!this._isConnected)throw new Error("Local Channel not connected");this._connectedChannelReceive(e)}},{key:"receive",value:function(e){this._messageReceived(e)}},{key:"connect",value:function(e){this._connectedChannelReceive=function(t){return e.receive(t)},this._isConnected=!0,this._connected()}}])&&i(t.prototype,n),r&&i(t,r),c}(n(10).GenericChannel);t.LocalChannel=l;t.connectLocalChannels=function(e,t){e.connect(t),t.connect(e)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.connectPasswordChanger=t.convertPasswordChangerDataToCarbonRequirements=void 0;var o=n(327),i=n(113),a=n(328),s=n(11),u=n(6),c=n(1),l=n(864),d=n(865);t.convertPasswordChangerDataToCarbonRequirements=function(e){if(!e.success)return{success:!1,error:o.PasswordChangeRequirementError.DomainNotSupported};var t=e.data.passwordRequirements;return t?{success:!0,requirements:{avoidAmbiguous:t.avoidAmbiguousChars,digits:t.withDigits,length:t.length,letters:t.withLetters,symbols:t.withSymbols}}:{success:!0}};t.connectPasswordChanger=function(e,n){var o=a.passwordChanger({apiEvents:Object.assign(Object.assign({},s.extensionCarbonConnector),{getRecipe:function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.extensionCarbonConnector.getRecipe(e);case 2:if(!(n=t.sent).success){t.next=5;break}return t.abrupt("return",n);case 5:return t.abrupt("return",{success:!1,error:l.CarbonGetRecipeErrors.InternalError});case 6:case"end":return t.stop()}}),t)})))},notifyNewUserPrompt:function(e,t){return n.notifyPasswordChangeUserPrompt(e,t)},subscribeUserPromptAnswers:function(e,t){return n.livePasswordChangeUserPromptAnswer.on(e,t)}}),environmentFactory:d.singleChangeEnvironmentFactory(e),diagnostics:{sendDiagnostic:function(e){return s.carbon().usageLog({code:137,content:{domain:e.domain,engineVersion:e.version,recipeVersion:e.recipeVersion,action:"progress",recipeAction:e.recipeAction,recipeStep:e.recipeStep}})},sendFailure:function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.dump){t.next=3;break}return t.next=3,n.dumpCreated(e.dump);case 3:return t.next=5,s.carbon().usageLog({code:137,content:{domain:e.domain,engineVersion:e.version,recipeVersion:e.recipeVersion,action:"finish",success:!1,errorCode:e.errorCode,errorType:e.errorType,message:e.error}});case 5:case"end":return t.stop()}}),t)})))}},logger:{sendUsageLogForPasswordChange:function(e){return"success"===e.action?s.carbon().usageLog({code:137,content:{domain:e.domain,engineVersion:e.version,action:"finish",success:!0}}):s.carbon().usageLog({code:137,content:{domain:e.domain,engineVersion:e.version,action:e.action}})}}});n.changePassword.on((function(e){return o.changePassword(e.domain,e.credential,e.options,(function(t){n.passwordChangeNotification(e.credential.id,t)})).then((function(t){n.passwordChangeNotification(e.credential.id,t)})).catch((function(t){var r="Recieved an exception during passwordchange: ".concat(t);u.exceptionLog({funcName:"common.background.externalModules.passwordChanger.changePassword",fileName:"Common/Background/ExternalModules/PasswordChanger.ts",code:c.ExceptionCode.Error,message:r,type:"extensionException"}),n.passwordChangeNotification(e.credential.id,{state:i.PasswordChangeFinalStatus.Failed,failureCode:i.FailureCode.InternalError,running:!1}),s.carbon().usageLog({code:137,content:{domain:e.domain,action:"finish",success:!1,errorCode:"UNKNOWN_ERROR",errorType:"unknownError",message:String(t)}})})),{state:i.PasswordChangeOngoingStatus.Waiting,running:!0}})),n.getVersion.on((function(){return o.getEngineVersion()})),n.getPasswordChangeRequirements.on((function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.getDomainScriptData(e.domain);case 2:return r=n.sent,n.abrupt("return",t.convertPasswordChangerDataToCarbonRequirements(r));case 4:case"end":return n.stop()}}),n)})))}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.singleChangeEnvironmentFactory=void 0;t.singleChangeEnvironmentFactory=function(e){var t=[],n=!1;return{create:function o(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n){r.next=2;break}return r.abrupt("return",new Promise((function(e,n){t.push({resolve:e,reject:n,options:i})})));case 2:return n=!0,r.next=5,e.create(i);case 5:return a=r.sent,r.abrupt("return",Object.assign(Object.assign({},a),{close:function(){a.close(),n=!1;var e=t.pop();e&&o(e.options).then(e.resolve,e.reject)}}));case 7:case"end":return r.stop()}}),r)})))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startExtensionIframeReplacer=void 0;var r=n(867);Object.defineProperty(t,"startExtensionIframeReplacer",{enumerable:!0,get:function(){return r.startExtensionIframeReplacer}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startExtensionIframeReplacer=void 0;var r=n(868),o=n(869),i=[r.GenericReplaceRule],a={},s=function(e){a[e]&&(a[e](),delete a[e])};t.startExtensionIframeReplacer=function(){chrome.tabs.onRemoved.addListener((function(e){s(e)})),chrome.tabs.onUpdated.addListener((function(e,t,n){n.url&&n.url.startsWith(chrome.runtime.getURL("/"))?"complete"===t.status&&n.url.startsWith(chrome.runtime.getURL("/"))&&function(e){if(!a[e]){var t=i.map((function(t){return o.injectIFrameReplacer(e,t)}));a[e]=function(){t.forEach((function(e){return e()}))}}}(e):s(e)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericReplaceRule=void 0;var r="https://www.dashlane.com/404/magic/saexIframes/",o="^".concat(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\?token=([a-zA-z0-9%]+)$");t.GenericReplaceRule={getData:function(e){return function(e){var t=RegExp(o).exec(e);if(!t)throw new Error("Unsupported url "+e);return JSON.parse(atob(decodeURIComponent(t[1])))}(e)},baseUrls:["".concat(r)]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectIFrameReplacer=void 0;var r=n(870);t.injectIFrameReplacer=function(e,t){var n={},o={urls:t.baseUrls.map((function(e){return"".concat(e,"*")})),tabId:e,types:["sub_frame"]},i={urls:["http://*/*","https://*/*"],tabId:e},a=r.makeRedirectionListener(t,(function(e,t){return n[e]=t})),s=function(e){return n[e]},u=r.makeReplaceOriginListener(s),c=r.makeReplaceCspAndXFrameResponseHeaders(s),l=r.makeReplaceDocumentListener(s);return chrome.webRequest.onBeforeRequest.addListener(a,o,["blocking"]),chrome.webRequest.onBeforeSendHeaders.addListener(u,i,["requestHeaders","blocking"]),chrome.webRequest.onHeadersReceived.addListener(c,i,["responseHeaders","blocking"]),chrome.webRequest.onCompleted.addListener(l,i),function(){chrome.webRequest.onBeforeRequest.removeListener(a),chrome.webRequest.onBeforeSendHeaders.removeListener(u),chrome.webRequest.onHeadersReceived.removeListener(c),chrome.webRequest.onCompleted.removeListener(l)}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.makeReplaceDocumentListener=t.makeReplaceCspAndXFrameResponseHeaders=t.makeReplaceOriginListener=t.makeRedirectionListener=void 0;var o=function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){return chrome.tabs.get(e,(function(e){if(e)return t(e);n()}))})));case 1:case"end":return t.stop()}}),t)})))},i=function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=void 0;case 1:return t.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:return t.next=5,o(e);case 5:n=t.sent;case 6:if("complete"!==n.status){t.next=1;break}case 7:case"end":return t.stop()}}),t)})))},a=function(e){return e.toLowerCase().replace(/\/$/,"")};t.makeRedirectionListener=function(e,t){return function(n){if(n.frameId){var r=e.getData(n.url);return t(n.frameId,r),{redirectUrl:r.origin}}}};var s=new Set(["origin","referer"]);t.makeReplaceOriginListener=function(e){return function(t){var n=e(t.frameId);if(n){var r=(t.requestHeaders||[]).filter((function(e){return!s.has(e.name.toLowerCase())}));return r.push({name:"origin",value:n.origin}),{requestHeaders:r}}}};var u=["frame-options","x-webkit-csp","content-security-policy"];t.makeReplaceCspAndXFrameResponseHeaders=function(e){return function(t){var n=e(t.frameId);if(n){var r=(t.responseHeaders||[]).filter((function(e){return!u.some((function(t){return e.name.toLowerCase().endsWith(t)}))}));return r.push({name:"Content-Security-Policy",value:n.csp}),{responseHeaders:r}}}};var c=function(e,t){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){chrome.tabs.executeScript({allFrames:!1,code:e,frameId:t,runAt:"document_idle"},(function(){n()}))})));case 1:case"end":return n.stop()}}),n)})))};t.makeReplaceDocumentListener=function(e){return function(t){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e(t.frameId))&&t.url){n.next=3;break}return n.abrupt("return");case 3:if(a(r.origin)===a(t.url)){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,i(t.tabId);case 7:return o=btoa(r.body),s="document.body.innerHTML = atob('".concat(o,"')"),n.next=11,c(s,t.frameId);case 11:return n.next=13,i(t.tabId);case 13:return n.next=15,c(r.js,t.frameId);case 15:case"end":return n.stop()}}),n)})))}}},,,,,,function(e,t){e.exports="content/scripts/worker-maverick.js"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DebugWS=void 0;var c=n(10),l=n(110).default(),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(r=s.call(this))._ws=null,r._doNotLogErrors=!1,r.port=e,r.name=t,r._tryToConnect(),r._doNotLogErrors=n||!1,r}return t=u,(n=[{key:"send",value:function(e){if(this._ws){var t=JSON.stringify(e);this._ws.send(t)}}},{key:"_tryToConnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.MAX_RETRIES;this._init(e)}},{key:"_onWsMessage",value:function(e){var t;try{t=JSON.parse(e)}catch(e){return void this._error(e)}this._doNotLogErrors||l.log("Message received",1,"DebugWS/".concat(this.name)),this._messageReceived(t)}},{key:"_init",value:function(e){var t=this;if(0!==e){var n=new WebSocket("ws://127.0.0.1:".concat(this.port));n.onopen=function(e){t._doNotLogErrors||l.log("Socket open",3,"DebugWS/".concat(t.name)),t._ws=n,t._connected()},n.onerror=function(n){t._error(n),t._disconnected(),t._doNotLogErrors||l.log("Error on socket",1,"DebugWS/".concat(t.name)),t._ws=null,setTimeout((function(){t._tryToConnect(e-1)}),1500)},n.onclose=function(e){t._error(e),t._disconnected(),t._doNotLogErrors||l.log("Socket closed",1,"DebugWS/".concat(t.name)),n===t._ws&&(t._ws=null,t._tryToConnect())},n.onmessage=function(e){t._onWsMessage(e.data)}}}}])&&o(t.prototype,n),r&&o(t,r),u}(c.GenericChannel);t.DebugWS=d,d.MAX_RETRIES=3},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=t.setInstance=t.WebSocketController=void 0;var o=n(13),i=n(26),a=n(340),s=n(30),u=n(19),c=n(6),l=n(140),d=n(35),f=n(977),p=n(197),g=n(1),h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initDone=!1,this._ports=[11456,15674,17896,21953,32934],this._currentPort=-1,this._tryingPort=-1,this._nextTry=0,this._lastConnectionTime=0,this._stablePortRetries=0,this._pingRate=3e4,this._pingTimer=null,this._orderMessageBuffer=[],this._initMsgTimer=null,this._initMsgTimeout=5e3,this._lastMessageTime=0,this._messageController=null,this._setReadyToSendHandlers=[]}var t,n,h;return t=e,(n=[{key:"_resetBackoff",value:function(){-1!==this._currentPort&&0!==this._nextTry&&(1!==this._nextTry?(this._nextTry/=2,setTimeout(this._resetBackoff.bind(this),this._nextTry)):this._nextTry=0)}},{key:"_flushOrderMessageBuffer",value:function(){var e=this,t=this._orderMessageBuffer.slice();this._orderMessageBuffer=[],t.forEach((function(t){e.send(t,!1)}))}},{key:"clearOrderMessageBuffer",value:function(){this._orderMessageBuffer=[]}},{key:"_tryFirstPort",value:function(){this._tryingPort=this._ports[0],this.open(this._tryingPort)}},{key:"init",value:function(){this._initDone||(this._tryFirstPort(),this._initDone=!0)}},{key:"retry",value:function(){this._tryFirstPort()}},{key:"send",value:function(e,t){return this._messageController&&this.isReadyToSend()?this._messageController.sendOrder(e):(t&&this._orderMessageBuffer.push(e),Promise.resolve())}},{key:"isReadyToSend",value:function(){return-1!==this._currentPort&&null!==this._messageController&&this._messageController.isReadyToSend()}},{key:"resetCommunication",value:function(){c.exceptionLog({funcName:"resetCommunication",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Warning,message:"Communication reset has been requested. WS will be closed.",type:"extensionException"}),this.close()}},{key:"_ping",value:function(){-1!==this._currentPort&&(this._send("pInG"),this._pingTimer=setTimeout(this._ping.bind(this),this._pingRate))}},{key:"_cancelPing",value:function(){this._pingTimer&&(clearTimeout(this._pingTimer),this._pingTimer=null)}},{key:"onOpen",value:function(e){var t=this;s.Logger.getInstance().log("Websocket connection established on port "+e,3),c.exceptionLog({funcName:"ws.onOpen",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Warning,message:"[plugin_communication][ws_opened] New websocket opened",type:"extensionException"}),this._lastConnectionTime=Date.now(),this._currentPort=e,this._tryingPort=-1,this._resetBackoff(),this._pingTimer=setTimeout(this._ping.bind(this),this._pingRate),this._initMsgTimer=setTimeout(this._onNoInitMessage.bind(this),this._initMsgTimeout),32===this._nextTry&&c.exceptionLog({funcName:"ws.onOpen",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Error,message:"Connection after max backoff"}),this._makeMessageController().then((function(){t._send(o.default().getBrowser())}))}},{key:"onMessage",value:function(e){this._lastMessageTime=Date.now();var t=null;try{t=JSON.parse(e)}catch(e){return void c.exceptionLog({funcName:"ws.onMessage",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Error,message:"[WebSocketController][onMessage] Message is not JSON, can't parse. Error: ".concat(e)})}if(t&&t.init)return t.init.pairingCapable?this._messageController?void this._messageController.initializeCommunication():void c.exceptionLog({funcName:"ws.onMessage",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Error,message:"[WebSocketController][_handleMessage] _messageController is null - should not happen"}):(c.exceptionLog({funcName:"ws.onMessage",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Warning,message:"[plugin_communication][desktop_not_compatible] Desktop application is not compatible with pairing",type:"extensionException"}),void i.default().openNewTabWithInternalPage("pairingVerification.html?error=NEED_PLUGIN_UPDATE"));t&&"1"!==t.protocolVersion?c.exceptionLog({funcName:"ws.onMessage",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Error,message:'[WebSocketController][onMessage] Protocol version is expected to be "1"'}):this._handleMessage(t)}},{key:"_handleMessage",value:function(e){if(this._messageController)return this._messageController.handleIncomingMessage(e);c.exceptionLog({funcName:"ws.onMessage",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Error,message:"[WebSocketController][_handleMessage] _messageController is null - should not happen"})}},{key:"_handleIdentificationMessage",value:function(e){this._initMsgTimer&&(clearTimeout(this._initMsgTimer),this._initMsgTimer=null),i.default().socketWorking(),e&&e.content&&e.content.params&&e.content.params.features&&(o.default().setPluginFeatures(e.content.params.features),e.content.params.features.mfa&&l.setMfaHooksForPlugin())}},{key:"_handleDeadConnection",value:function(e,t){this._currentPort===t&&i.default().socketClosed(),this._currentPort=-1,this._cancelPing(),this._deleteMessageController();var n=this._ports.indexOf(t);return this._lastConnectionTime&&(Date.now()-this._lastConnectionTime)/1e3>60&&this._stablePortRetries++<3?(this._tryingPort=t,this.open(t)):(this._lastConnectionTime=0,this._stablePortRetries=0,n===this._ports.length-1?(this._tryingPort=-1,setTimeout(this.retry.bind(this),1e3*this._nextTry),void(this._nextTry=Math.min(this._nextTry?2*this._nextTry:1,8))):(this._tryingPort=this._ports[++n],void this.open(this._tryingPort)))}},{key:"onError",value:function(e,t){s.Logger.getInstance().logError("Websocket error on port "+t,e,0),this._currentPort!==t&&this._tryingPort!==t||this._handleDeadConnection(e&&e.message||"noreason",t)}},{key:"onClose",value:function(e,t){s.Logger.getInstance().log("Websocket connection was closed: "+e,3),this._currentPort!==t&&this._tryingPort!==t||this._handleDeadConnection(e,t)}},{key:"getMessageController",value:function(){return this._messageController}},{key:"addReadyToSendHandler",value:function(e){this._setReadyToSendHandlers.push(e)}},{key:"_deleteMessageController",value:function(){this._messageController=null,p.getWindow().messageController=null}},{key:"_callSetReadyToSendHandlers",value:function(){this._setReadyToSendHandlers.forEach((function(e){e()}))}},{key:"_getBasePairingUrl",value:function(){var e=o.default().getBrowser();return"CHROME"===e||"FIREFOX"===e?"https://www.dashlane.com/extension/":o.default().getExtensionHostUrl()}},{key:"_makeMessageController",value:function(){var e=this;return f.makeMessageController({browser:o.default().getBrowser(),extensionBuild:o.default().getBuildVersions().extension,extensionFeatures:o.default().getExtensionFeatures(),extensionHostUrl:this._getBasePairingUrl(),decrypt:a.decrypt,encrypt:a.encrypt,storage:d.getAsyncStorageInstance(),syncStorage:d.getSyncStorageInstance(),send:function(t){e._send(t)},restartConnectionHandler:function(){c.exceptionLog({funcName:"restartConnectionHandler",fileName:"common/background/WebSocketController.ts",code:g.ExceptionCode.Warning,message:"[plugin_communication][ws_closed] websocket has been closed",type:"extensionException"}),e.close()},openNewTabWithInternalPage:function(e){i.default().openNewTabWithInternalPage(e)}}).then((function(t){t.setCipheredOrderHandler((function(e){u.default().catchMessageFromCpp(e.tabId,e.message)})),t.setIdentificationMessageHandler((function(t){e._handleIdentificationMessage(t)})),t.setReadyToSendHandler((function(){setTimeout((function(){e._flushOrderMessageBuffer()}),0),e._callSetReadyToSendHandlers(),i.default().removeTabWithInternalUrl("pairingVerification.html")})),e._messageController=t,p.getWindow().messageController=t}))}}])&&r(t.prototype,n),h&&r(t,h),e}();t.WebSocketController=h;var m=void 0;function v(){if(!m)throw c.exceptionLog({code:g.ExceptionCode.Error,fileName:"common/background/communication/WebSocketController.ts",funcName:"getInstance",message:"GetInstance is called but instance is not initialized"}),"GetInstance is called but instance is not initialized";return m}t.setInstance=function(e){m=e},t.getInstance=v,t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ab2str=t.str2ab=void 0;var r=n(880);t.str2ab=function(e){return new r.TextEncoder("utf-8").encode(e).buffer},t.ab2str=function(e){for(var t=new Uint8Array(e),n=t.byteLength;0===t[n-1];)--n;if(!n)return"";var o=t.subarray(0,n);return new r.TextDecoder("utf-8").decode(o)}},,,,function(e,t,n){"use strict";var r,o,i={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};e.exports&&(e.exports=i),void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r),i.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,n,r,o,a,s=this._tables[0][4],u=this._tables[1],c=e.length,l=1;if(4!==c&&6!==c&&8!==c)throw new i.exception.invalid("invalid aes key size");for(this._key=[o=e.slice(0),a=[]],t=c;t<4*c+28;t++)r=o[t-1],(t%c==0||8===c&&t%c==4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],t%c==0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),o[t]=o[t-c]^r;for(n=0;t;n++,t--)r=o[3&n?t:t-4],a[n]=t<=4||n<4?r:u[0][s[r>>>24]]^u[1][s[r>>16&255]]^u[2][s[r>>8&255]]^u[3][s[255&r]]},i.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e,t,n,r,o,i,a,s,u=this._tables[0],c=this._tables[1],l=u[4],d=c[4],f=[],p=[];for(e=0;e<256;e++)p[(f[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=r||1,n=p[n]||1)for(i=(i=n^n<<1^n<<2^n<<3^n<<4)>>8^255&i^99,l[t]=i,d[i]=t,s=16843009*f[o=f[r=f[t]]]^65537*o^257*r^16843008*t,a=257*f[i]^16843008*i,e=0;e<4;e++)u[e][t]=a=a<<24^a>>>8,c[e][i]=s=s<<24^s>>>8;for(e=0;e<5;e++)u[e]=u[e].slice(0),c[e]=c[e].slice(0)},_crypt:function(e,t){if(4!==e.length)throw new i.exception.invalid("invalid aes block size");var n,r,o,a,s=this._key[t],u=e[0]^s[0],c=e[t?3:1]^s[1],l=e[2]^s[2],d=e[t?1:3]^s[3],f=s.length/4-2,p=4,g=[0,0,0,0],h=this._tables[t],m=h[0],v=h[1],y=h[2],b=h[3],_=h[4];for(a=0;a<f;a++)n=m[u>>>24]^v[c>>16&255]^y[l>>8&255]^b[255&d]^s[p],r=m[c>>>24]^v[l>>16&255]^y[d>>8&255]^b[255&u]^s[p+1],o=m[l>>>24]^v[d>>16&255]^y[u>>8&255]^b[255&c]^s[p+2],d=m[d>>>24]^v[u>>16&255]^y[c>>8&255]^b[255&l]^s[p+3],p+=4,u=n,c=r,l=o;for(a=0;a<4;a++)g[t?3&-a:a]=_[u>>>24]<<24^_[c>>16&255]<<16^_[l>>8&255]<<8^_[255&d]^s[p++],n=u,u=c,c=l,l=d,d=n;return g}},i.bitArray={bitSlice:function(e,t,n){return e=i.bitArray._shiftRight(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:i.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=i.bitArray.getPartial(n);return 32===r?e.concat(t):i.bitArray._shiftRight(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t,n=e.length;return 0===n?0:(t=e[n-1],32*(n-1)+i.bitArray.getPartial(t))},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=i.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(i.bitArray.bitLength(e)!==i.bitArray.bitLength(t))return!1;var n,r=0;for(n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},_shiftRight:function(e,t,n,r){var o,a,s;for(void 0===r&&(r=[]);t>=32;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(o=0;o<e.length;o++)r.push(n|e[o]>>>t),n=e[o]<<32-t;return a=e.length?e[e.length-1]:0,s=i.bitArray.getPartial(a),r.push(i.bitArray.partial(t+s&31,t+s>32?n:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},i.codec.utf8String={fromBits:function(e){var t,n,r="",o=i.bitArray.bitLength(e);for(t=0;t<o/8;t++)0==(3&t)&&(n=e[t/4]),r+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e.charCodeAt(t),3==(3&t)&&(n.push(r),r=0);return 3&t&&n.push(i.bitArray.partial(8*(3&t),r)),n}},i.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=(0xf00000000000+(0|e[t])).toString(16).substr(4);return n.substr(0,i.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,r=[];for(n=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",t=0;t<e.length;t+=8)r.push(0^parseInt(e.substr(t,8),16));return i.bitArray.clamp(r,4*n)}},"undefined"==typeof ArrayBuffer&&((o=this).ArrayBuffer=function(){},o.DataView=function(){}),i.codec.arrayBuffer={fromBits:function(e,t,n){var r,o,a,s,u;if(t=null==t||t,n=n||8,0===e.length)return new ArrayBuffer(0);if(a=i.bitArray.bitLength(e)/8,i.bitArray.bitLength(e)%8!=0)throw new i.exception.invalid("Invalid bit size, must be divisble by 8 to fit in an arraybuffer correctly");for(t&&a%n!=0&&(a+=n-a%n),s=new DataView(new ArrayBuffer(4*e.length)),o=0;o<e.length;o++)s.setUint32(4*o,e[o]<<32);if((r=new DataView(new ArrayBuffer(a))).byteLength===s.byteLength)return s.buffer;for(u=s.byteLength<r.byteLength?s.byteLength:r.byteLength,o=0;o<u;o++)r.setUint8(o,s.getUint8(o));return r.buffer},toBits:function(e){var t,n,r,o=[];if(0===e.byteLength)return[];t=(n=new DataView(e)).byteLength-n.byteLength%4;for(var a=0;a<t;a+=4)o.push(n.getUint32(a));if(n.byteLength%4!=0){r=new DataView(new ArrayBuffer(4));a=0;for(var s=n.byteLength%4;a<s;a++)r.setUint8(a+4-s,n.getUint8(t+a));o.push(i.bitArray.partial(n.byteLength%4*8,r.getUint32(0)))}return o},hexDumpBuffer:function(e){for(var t,n,r=new DataView(e),o="",i=0;i<r.byteLength;i+=2)i%16==0&&(o+="\n"+i.toString(16)+"\t"),o+=(t=r.getUint16(i).toString(16),((t+="").length>=(n=4)?t:new Array(n-t.length+1).join("0")+t)+" ");void 0===typeof console&&(console=console||{log:function(){}}),console.log(o.toUpperCase())}},i.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r,o="",a=0,s=i.codec.base64._chars,u=0,c=i.bitArray.bitLength(e);for(n&&(s=s.substr(0,62)+"-_"),r=0;6*o.length<c;)o+=s.charAt((u^e[r]>>>a)>>>26),a<6?(u=e[r]<<6-a,a+=26,r++):(u<<=6,a-=6);for(;3&o.length&&!t;)o+="=";return o},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n,r,o=[],a=0,s=i.codec.base64._chars,u=0;for(t&&(s=s.substr(0,62)+"-_"),n=0;n<e.length;n++){if((r=s.indexOf(e.charAt(n)))<0)throw new i.exception.invalid("this isn't base64!");a>26?(a-=26,o.push(u^r>>>a),u=r<<32-a):u^=r<<32-(a+=6)}return 56&a&&o.push(i.bitArray.partial(56&a,u,1)),o}},i.codec.base64url={fromBits:function(e){return i.codec.base64.fromBits(e,1,1)},toBits:function(e){return i.codec.base64.toBits(e,1)}},i.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},i.hash.sha256.hash=function(e){return(new i.hash.sha256).update(e).finalize()},i.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=i.codec.utf8String.toBits(e));var t,n=this._buffer=i.bitArray.concat(this._buffer,e),r=this._length,o=this._length=r+i.bitArray.bitLength(e);for(t=512+r&-512;t<=o;t+=512)this._block(n.splice(0,16));return this},finalize:function(){var e,t=this._buffer,n=this._h;for(e=(t=i.bitArray.concat(t,[i.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){var e,t=0,n=2;function r(e){return 4294967296*(e-Math.floor(e))|0}e:for(;t<64;n++){for(e=2;e*e<=n;e++)if(n%e==0)continue e;t<8&&(this._init[t]=r(Math.pow(n,.5))),this._key[t]=r(Math.pow(n,1/3)),t++}},_block:function(e){var t,n,r,o,i=e.slice(0),a=this._h,s=this._key,u=a[0],c=a[1],l=a[2],d=a[3],f=a[4],p=a[5],g=a[6],h=a[7];for(t=0;t<64;t++)t<16?n=i[t]:(r=i[t+1&15],o=i[t+14&15],n=i[15&t]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+i[15&t]+i[t+9&15]|0),n=n+h+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(g^f&(p^g))+s[t],h=g,g=p,p=f,f=d+n|0,d=l,l=c,u=n+((c=u)&l^d&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;a[0]=a[0]+u|0,a[1]=a[1]+c|0,a[2]=a[2]+l|0,a[3]=a[3]+d|0,a[4]=a[4]+f|0,a[5]=a[5]+p|0,a[6]=a[6]+g|0,a[7]=a[7]+h|0}},i.mode.ccm={name:"ccm",_progressListeners:[],listenProgress:function(e){i.mode.ccm._progressListeners.push(e)},unListenProgress:function(e){var t=i.mode.ccm._progressListeners.indexOf(e);t>-1&&i.mode.ccm._progressListeners.splice(t,1)},_callProgressListener:function(e){var t,n=i.mode.ccm._progressListeners.slice();for(t=0;t<n.length;t+=1)n[t](e)},encrypt:function(e,t,n,r,o){var a,s,u=t.slice(0),c=i.bitArray,l=c.bitLength(n)/8,d=c.bitLength(u)/8;if(o=o||64,r=r||[],l<7)throw new i.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;a<4&&d>>>8*a;a++);return a<15-l&&(a=15-l),n=c.clamp(n,8*(15-a)),s=i.mode.ccm._computeTag(e,t,n,r,o,a),u=i.mode.ccm._ctrMode(e,u,n,s,o,a),c.concat(u.data,u.tag)},decrypt:function(e,t,n,r,o){o=o||64,r=r||[];var a,s,u=i.bitArray,c=u.bitLength(n)/8,l=u.bitLength(t),d=u.clamp(t,l-o),f=u.bitSlice(t,l-o);if(l=(l-o)/8,c<7)throw new i.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;a<4&&l>>>8*a;a++);if(a<15-c&&(a=15-c),n=u.clamp(n,8*(15-a)),d=i.mode.ccm._ctrMode(e,d,n,f,o,a),s=i.mode.ccm._computeTag(e,d.data,n,r,o,a),!u.equal(d.tag,s))throw new i.exception.corrupt("ccm: tag doesn't match");return d.data},_macAdditionalData:function(e,t,n,r,o,a){var s,u,c,l=[],d=i.bitArray,f=d._xor4;if(s=[d.partial(8,(t.length?64:0)|r-2<<2|a-1)],(s=d.concat(s,n))[3]|=o,s=e.encrypt(s),t.length)for((u=d.bitLength(t)/8)<=65279?l=[d.partial(16,u)]:u<=4294967295&&(l=d.concat([d.partial(16,65534)],[u])),l=d.concat(l,t),c=0;c<l.length;c+=4)s=e.encrypt(f(s,l.slice(c,c+4).concat([0,0,0])));return s},_computeTag:function(e,t,n,r,o,a){var s,u,c=i.bitArray,l=c._xor4;if((o/=8)%2||o<4||o>16)throw new i.exception.invalid("ccm: invalid tag length");if(r.length>4294967295||t.length>4294967295)throw new i.exception.bug("ccm: can't deal with 4GiB or more data");for(s=i.mode.ccm._macAdditionalData(e,r,n,o,c.bitLength(t)/8,a),u=0;u<t.length;u+=4)s=e.encrypt(l(s,t.slice(u,u+4).concat([0,0,0])));return c.clamp(s,8*o)},_ctrMode:function(e,t,n,r,o,a){var s,u,c,l=i.bitArray,d=l._xor4,f=t.length,p=l.bitLength(t),g=f/50,h=g;if(c=l.concat([l.partial(8,a-1)],n).concat([0,0,0]).slice(0,4),r=l.bitSlice(d(r,e.encrypt(c)),0,o),!f)return{tag:r,data:[]};for(u=0;u<f;u+=4)u>g&&(i.mode.ccm._callProgressListener(u/f),g+=h),c[3]++,s=e.encrypt(c),t[u]^=s[0],t[u+1]^=s[1],t[u+2]^=s[2],t[u+3]^=s[3];return{tag:r,data:l.clamp(t,p)}}},i.arrayBuffer=i.arrayBuffer||{},"undefined"==typeof ArrayBuffer&&function(e){e.ArrayBuffer=function(){},e.DataView=function(){}}(this),i.arrayBuffer.ccm={mode:"ccm",defaults:{tlen:128},compat_encrypt:function(e,t,n,r,o){var a,s,u=i.codec.arrayBuffer.fromBits(t,!0,16),c=i.bitArray.bitLength(t)/8;return o=o||64,r=r||[],a=i.arrayBuffer.ccm.encrypt(e,u,n,r,o,c),s=i.codec.arrayBuffer.toBits(a.ciphertext_buffer),s=i.bitArray.clamp(s,8*c),i.bitArray.concat(s,a.tag)},compat_decrypt:function(e,t,n,r,o){o=o||64,r=r||[];var a=i.bitArray,s=a.bitLength(t),u=a.clamp(t,s-o),c=a.bitSlice(t,s-o),l=i.codec.arrayBuffer.fromBits(u,!0,16),d=i.arrayBuffer.ccm.decrypt(e,l,n,c,r,o,(s-o)/8);return i.bitArray.clamp(i.codec.arrayBuffer.toBits(d),s-o)},encrypt:function(e,t,n,r,o,a){var s,u,c=i.bitArray,l=c.bitLength(n)/8;for(r=r||[],o=o||i.arrayBuffer.ccm.defaults.tlen,a=a||t.byteLength,o=Math.ceil(o/8),u=2;u<4&&a>>>8*u;u++);return u<15-l&&(u=15-l),n=c.clamp(n,8*(15-u)),s=i.arrayBuffer.ccm._computeTag(e,t,n,r,o,a,u),{ciphertext_buffer:t,tag:s=i.arrayBuffer.ccm._ctrMode(e,t,n,s,o,u)}},decrypt:function(e,t,n,r,o,a,s){var u,c,l,d=i.bitArray,f=d.bitLength(n)/8;for(o=o||[],a=a||i.arrayBuffer.ccm.defaults.tlen,s=s||t.byteLength,a=Math.ceil(a/8),l=2;l<4&&s>>>8*l;l++);if(l<15-f&&(l=15-f),n=d.clamp(n,8*(15-l)),u=i.arrayBuffer.ccm._ctrMode(e,t,n,r,a,l),c=i.arrayBuffer.ccm._computeTag(e,t,n,o,a,s,l),!i.bitArray.equal(u,c))throw new i.exception.corrupt("ccm: tag doesn't match");return t},_computeTag:function(e,t,n,r,o,a,s){var u,c,l;i.bitArray;if(c=i.mode.ccm._macAdditionalData(e,r,n,o,a,s),0!==t.byteLength){for(l=new DataView(t),u=a;u<t.byteLength;u++)l.setUint8(u,0);for(u=0;u<l.byteLength;u+=16)c[0]^=l.getUint32(u),c[1]^=l.getUint32(u+4),c[2]^=l.getUint32(u+8),c[3]^=l.getUint32(u+12),c=e.encrypt(c)}return i.bitArray.clamp(c,8*o)},_ctrMode:function(e,t,n,r,o,a){var s,u,c,l,d,f,p,g,h=i.bitArray,m=h._xor4,v=t.byteLength/50,y=v;if(u=new DataView(new ArrayBuffer(16)),u=h.concat([h.partial(8,a-1)],n).concat([0,0,0]).slice(0,4),r=h.bitSlice(m(r,e.encrypt(u)),0,8*o),u[3]++,0===u[3]&&u[2]++,0!==t.byteLength)for(s=new DataView(t),g=0;g<s.byteLength;g+=16)g>v&&(i.mode.ccm._callProgressListener(g/t.byteLength),v+=y),p=e.encrypt(u),c=s.getUint32(g),l=s.getUint32(g+4),d=s.getUint32(g+8),f=s.getUint32(g+12),s.setUint32(g,c^p[0]),s.setUint32(g+4,l^p[1]),s.setUint32(g+8,d^p[2]),s.setUint32(g+12,f^p[3]),u[3]++,0===u[3]&&u[2]++;return r}},i.mode.ocb2={name:"ocb2",encrypt:function(e,t,n,r,o,a){if(128!==i.bitArray.bitLength(n))throw new i.exception.invalid("ocb iv must be 128 bits");var s,u,c,l,d=i.mode.ocb2._times2,f=i.bitArray,p=f._xor4,g=[0,0,0,0],h=d(e.encrypt(n)),m=[];for(r=r||[],o=o||64,s=0;s+4<t.length;s+=4)g=p(g,u=t.slice(s,s+4)),m=m.concat(p(h,e.encrypt(p(h,u)))),h=d(h);return u=t.slice(s),c=f.bitLength(u),l=e.encrypt(p(h,[0,0,0,c])),u=f.clamp(p(u.concat([0,0,0]),l),c),g=p(g,p(u.concat([0,0,0]),l)),g=e.encrypt(p(g,p(h,d(h)))),r.length&&(g=p(g,a?r:i.mode.ocb2.pmac(e,r))),m.concat(f.concat(u,f.clamp(g,o)))},decrypt:function(e,t,n,r,o,a){if(128!==i.bitArray.bitLength(n))throw new i.exception.invalid("ocb iv must be 128 bits");o=o||64;var s,u,c,l,d=i.mode.ocb2._times2,f=i.bitArray,p=f._xor4,g=[0,0,0,0],h=d(e.encrypt(n)),m=i.bitArray.bitLength(t)-o,v=[];for(r=r||[],s=0;s+4<m/32;s+=4)u=p(h,e.decrypt(p(h,t.slice(s,s+4)))),g=p(g,u),v=v.concat(u),h=d(h);if(c=m-32*s,l=e.encrypt(p(h,[0,0,0,c])),u=p(l,f.clamp(t.slice(s),c).concat([0,0,0])),g=p(g,u),g=e.encrypt(p(g,p(h,d(h)))),r.length&&(g=p(g,a?r:i.mode.ocb2.pmac(e,r))),!f.equal(f.clamp(g,o),f.bitSlice(t,m)))throw new i.exception.corrupt("ocb: tag doesn't match");return v.concat(f.clamp(u,c))},pmac:function(e,t){var n,r,o=i.mode.ocb2._times2,a=i.bitArray,s=a._xor4,u=[0,0,0,0],c=e.encrypt([0,0,0,0]);for(c=s(c,o(o(c))),n=0;n+4<t.length;n+=4)c=o(c),u=s(u,e.encrypt(s(c,t.slice(n,n+4))));return r=t.slice(n),a.bitLength(r)<128&&(c=s(c,o(c)),r=a.concat(r,[-2147483648,0,0,0])),u=s(u,r),e.encrypt(s(o(s(c,o(c))),u))},_times2:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},i.mode.gcm={name:"gcm",encrypt:function(e,t,n,r,o){var a,s=t.slice(0),u=i.bitArray;return o=o||128,r=r||[],a=i.mode.gcm._ctrMode(!0,e,s,r,n,o),u.concat(a.data,a.tag)},decrypt:function(e,t,n,r,o){var a,s,u=t.slice(0),c=i.bitArray,l=c.bitLength(u);if(r=r||[],(o=o||128)<=l?(s=c.bitSlice(u,l-o),u=c.bitSlice(u,0,l-o)):(s=u,u=[]),a=i.mode.gcm._ctrMode(!1,e,u,r,n,o),!c.equal(a.tag,s))throw new i.exception.corrupt("gcm: tag doesn't match");return a.data},_galoisMultiply:function(e,t){var n,r,o,a,s,u=i.bitArray._xor4;for(o=[0,0,0,0],a=t.slice(0),n=0;n<128;n++){for(0!=(e[Math.floor(n/32)]&1<<31-n%32)&&(o=u(o,a)),s=0!=(1&a[3]),r=3;r>0;r--)a[r]=a[r]>>>1|(1&a[r-1])<<31;a[0]=a[0]>>>1,s&&(a[0]=a[0]^225<<24)}return o},_ghash:function(e,t,n){var r,o,a=n.length;for(r=t.slice(0),o=0;o<a;o+=4)r[0]^=4294967295&n[o],r[1]^=4294967295&n[o+1],r[2]^=4294967295&n[o+2],r[3]^=4294967295&n[o+3],r=i.mode.gcm._galoisMultiply(r,e);return r},_ctrMode:function(e,t,n,r,o,a){var s,u,c,l,d,f,p,g,h,m,v,y,b=i.bitArray;for(h=n.length,m=b.bitLength(n),v=b.bitLength(r),y=b.bitLength(o),s=t.encrypt([0,0,0,0]),96===y?(u=o.slice(0),u=b.concat(u,[1])):(u=i.mode.gcm._ghash(s,[0,0,0,0],o),u=i.mode.gcm._ghash(s,u,[0,0,Math.floor(y/4294967296),4294967295&y])),c=i.mode.gcm._ghash(s,[0,0,0,0],r),f=u.slice(0),p=c.slice(0),e||(p=i.mode.gcm._ghash(s,c,n)),d=0;d<h;d+=4)f[3]++,l=t.encrypt(f),n[d]^=l[0],n[d+1]^=l[1],n[d+2]^=l[2],n[d+3]^=l[3];return n=b.clamp(n,m),e&&(p=i.mode.gcm._ghash(s,c,n)),g=[Math.floor(v/4294967296),4294967295&v,Math.floor(m/4294967296),4294967295&m],p=i.mode.gcm._ghash(s,p,g),l=t.encrypt(u),p[0]^=l[0],p[1]^=l[1],p[2]^=l[2],p[3]^=l[3],{tag:b.bitSlice(p,0,a),data:n}}},i.misc.hmac=function(e,t){this._hash=t=t||i.hash.sha256;var n,r=[[],[]],o=t.prototype.blockSize/32;for(this._baseHash=[new t,new t],e.length>o&&(e=t.hash(e)),n=0;n<o;n++)r[0][n]=909522486^e[n],r[1][n]=1549556828^e[n];this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new t(this._baseHash[0])},i.misc.hmac.prototype.encrypt=i.misc.hmac.prototype.mac=function(e){if(this._updated)throw new i.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},i.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},i.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},i.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(e).finalize();return this.reset(),t},i.misc.pbkdf2=function(e,t,n,r,o){if(n=n||1e3,r<0||n<0)throw i.exception.invalid("invalid params to pbkdf2");"string"==typeof e&&(e=i.codec.utf8String.toBits(e)),"string"==typeof t&&(t=i.codec.utf8String.toBits(t));var a,s,u,c,l,d=new(o=o||i.misc.hmac)(e),f=[],p=i.bitArray;for(l=1;32*f.length<(r||1);l++){for(a=s=d.encrypt(p.concat(t,[l])),u=1;u<n;u++)for(s=d.encrypt(s),c=0;c<s.length;c++)a[c]^=s[c];f=f.concat(a)}return r&&(f=p.clamp(f,r)),f},i.prng=function(e){this._pools=[new i.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},i.prng.prototype={randomWords:function(e,t){var n,r,o=[],a=this.isReady(t);if(a===this._NOT_READY)throw new i.exception.notReady("generator isn't seeded");for(a&this._REQUIRES_RESEED&&this._reseedFromPools(!(a&this._READY)),n=0;n<e;n+=4)(n+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),r=this._gen4words(),o.push(r[0],r[1],r[2],r[3]);return this._gate(),o.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=e},addEntropy:function(e,t,n){n=n||"user";var r,o,a,s,u=(new Date).valueOf(),c=this._robins[n],l=this.isReady(),d=0;switch(void 0===(r=this._collectorIds[n])&&(r=this._collectorIds[n]=this._collectorIdNext++),void 0===c&&(c=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof e){case"number":void 0===t&&(t=1),this._pools[c].update([r,this._eventId++,1,t,u,1,0|e]);break;case"object":if("[object Uint32Array]"===(s=Object.prototype.toString.call(e))){for(a=[],o=0;o<e.length;o++)a.push(e[o]);e=a}else for("[object Array]"!==s&&(d=1),o=0;o<e.length&&!d;o++)"number"!=typeof e[o]&&(d=1);if(!d){if(void 0===t)for(t=0,o=0;o<e.length;o++)for(a=e[o];a>0;)t++,a>>>=1;this._pools[c].update([r,this._eventId++,2,t,u,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this._pools[c].update([r,this._eventId++,3,t,u,e.length]),this._pools[c].update(e);break;default:d=1}if(d)throw new i.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[c]+=t,this._poolStrength+=t,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[void 0!==e?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e||this._defaultParanoia];return this._strength>=t||this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new i.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,r,o=this._callbacks[e],i=[];for(r in o)o.hasOwnProperty(r)&&o[r]===t&&i.push(r);for(n=0;n<i.length;n++)delete o[r=i[n]]},_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function(){for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new i.cipher.aes(this._key)},_reseed:function(e){this._key=i.hash.sha256.hash(this._key.concat(e)),this._cipher=new i.cipher.aes(this._key);for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);},_reseedFromPools:function(e){var t,n=[],r=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,t=0;t<16;t++)n.push(4294967296*Math.random()|0);for(t=0;t<this._pools.length&&(n=n.concat(this._pools[t].finalize()),r+=this._poolEntropy[t],this._poolEntropy[t]=0,e||!(this._reseedCount&1<<t));t++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new i.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(n)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){t=0,n=0}0!=t&&0!=n&&i.random.addEntropy([t,n],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(e){var t=e.touches[0]||e.changedTouches[0],n=t.pageX||t.clientX,r=t.pageY||t.clientY;i.random.addEntropy([n,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?i.random.addEntropy(window.performance.now(),e,"loadtime"):i.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var t=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var n=window.orientation;"number"==typeof n&&i.random.addEntropy(n,1,"accelerometer")}t&&i.random.addEntropy(t,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,t){var n,r=i.random._callbacks[e],o=[];for(n in r)r.hasOwnProperty(n)&&o.push(r[n]);for(n=0;n<o.length;n++)o[n](t)}},i.random=new i.prng(6),function(){try{var t,r,o;if(e.exports&&(r=function(){try{return n(884)}catch(e){return null}}())&&r.randomBytes)t=r.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),i.random.addEntropy(t,1024,"crypto.randomBytes");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(o=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(o);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(o)}i.random.addEntropy(o,1024,"crypto.getRandomValues")}}catch(e){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}}(),i.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(e,t,n,r){n=n||{},r=r||{};var o,a,s,u=i.json,c=u._add({iv:i.random.randomWords(4,0)},u.defaults);if(u._add(c,n),s=c.adata,"string"==typeof c.salt&&(c.salt=i.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=i.codec.base64.toBits(c.iv)),!i.mode[c.mode]||!i.cipher[c.cipher]||"string"==typeof e&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||c.iv.length<2||c.iv.length>4)throw new i.exception.invalid("json encrypt: invalid parameters");return"string"==typeof e?(e=(o=i.misc.cachedPbkdf2(e,c)).key.slice(0,c.ks/32),c.salt=o.salt):i.ecc&&e instanceof i.ecc.elGamal.publicKey&&(o=e.kem(),c.kemtag=o.tag,e=o.key.slice(0,c.ks/32)),"string"==typeof t&&(t=i.codec.utf8String.toBits(t)),"string"==typeof s&&(c.adata=s=i.codec.utf8String.toBits(s)),a=new i.cipher[c.cipher](e),u._add(r,c),r.key=e,"ccm"===c.mode&&i.arrayBuffer&&i.arrayBuffer.ccm&&t instanceof ArrayBuffer?c.ct=i.arrayBuffer.ccm.encrypt(a,t,c.iv,s,c.ts):c.ct=i.mode[c.mode].encrypt(a,t,c.iv,s,c.ts),c},encrypt:function(e,t,n,r){var o=i.json,a=o._encrypt.apply(o,arguments);return o.encode(a)},_decrypt:function(e,t,n,r){n=n||{},r=r||{};var o,a,s,u=i.json,c=u._add(u._add(u._add({},u.defaults),t),n,!0),l=c.adata;if("string"==typeof c.salt&&(c.salt=i.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=i.codec.base64.toBits(c.iv)),!i.mode[c.mode]||!i.cipher[c.cipher]||"string"==typeof e&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||!c.iv||c.iv.length<2||c.iv.length>4)throw new i.exception.invalid("json decrypt: invalid parameters");return"string"==typeof e?(e=(a=i.misc.cachedPbkdf2(e,c)).key.slice(0,c.ks/32),c.salt=a.salt):i.ecc&&e instanceof i.ecc.elGamal.secretKey&&(e=e.unkem(i.codec.base64.toBits(c.kemtag)).slice(0,c.ks/32)),"string"==typeof l&&(l=i.codec.utf8String.toBits(l)),s=new i.cipher[c.cipher](e),o="ccm"===c.mode&&i.arrayBuffer&&i.arrayBuffer.ccm&&c.ct instanceof ArrayBuffer?i.arrayBuffer.ccm.decrypt(s,c.ct,c.iv,c.tag,l,c.ts):i.mode[c.mode].decrypt(s,c.ct,c.iv,l,c.ts),u._add(r,c),r.key=e,1===n.raw?o:i.codec.utf8String.fromBits(o)},decrypt:function(e,t,n,r){var o=i.json;return o._decrypt(e,o.decode(t),n,r)},encode:function(e){var t,n="{",r="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new i.exception.invalid("json encode: invalid property name");switch(n+=r+'"'+t+'":',r=",",typeof e[t]){case"number":case"boolean":n+=e[t];break;case"string":n+='"'+escape(e[t])+'"';break;case"object":n+='"'+i.codec.base64.fromBits(e[t],0)+'"';break;default:throw new i.exception.bug("json encode: unsupported type")}}return n+"}"},decode:function(e){if(!(e=e.replace(/\s/g,"")).match(/^\{.*\}$/))throw new i.exception.invalid("json decode: this isn't json!");var t,n,r=e.replace(/^\{|\}$/g,"").split(/,/),o={};for(t=0;t<r.length;t++){if(!(n=r[t].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new i.exception.invalid("json decode: this isn't json!");null!=n[3]?o[n[2]]=parseInt(n[3],10):null!=n[4]?o[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?i.codec.base64.toBits(n[4]):unescape(n[4]):null!=n[5]&&(o[n[2]]="true"===n[5])}return o},_add:function(e,t,n){if(void 0===e&&(e={}),void 0===t)return e;var r;for(r in t)if(t.hasOwnProperty(r)){if(n&&void 0!==e[r]&&e[r]!==t[r])throw new i.exception.invalid("required parameter overridden");e[r]=t[r]}return e},_subtract:function(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(r[n]=e[n]);return r},_filter:function(e,t){var n,r={};for(n=0;n<t.length;n++)void 0!==e[t[n]]&&(r[t[n]]=e[t[n]]);return r}},i.encrypt=i.json.encrypt,i.decrypt=i.json.decrypt,i.misc._pbkdf2Cache={},i.misc.cachedPbkdf2=function(e,t){var n,r,o,a,s=i.misc._pbkdf2Cache;return a=(t=t||{}).iter||1e3,(n=(r=s[e]=s[e]||{})[a]=r[a]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):i.random.randomWords(2,0)})[o=void 0===t.salt?n.firstSalt:t.salt]=n[o]||i.misc.pbkdf2(e,o,t.iter),{key:n[o].slice(0),salt:o.slice(0)}},i.hash.sha1=function(e){e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},i.hash.sha1.hash=function(e){return(new i.hash.sha1).update(e).finalize()},i.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=i.codec.utf8String.toBits(e));var t,n=this._buffer=i.bitArray.concat(this._buffer,e),r=this._length,o=this._length=r+i.bitArray.bitLength(e);for(t=this.blockSize+r&-this.blockSize;t<=o;t+=this.blockSize)this._block(n.splice(0,16));return this},finalize:function(){var e,t=this._buffer,n=this._h;for(e=(t=i.bitArray.concat(t,[i.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return this.reset(),n},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(e,t,n,r){return e<=19?t&n|~t&r:e<=39?t^n^r:e<=59?t&n|t&r|n&r:e<=79?t^n^r:void 0},_S:function(e,t){return t<<e|t>>>32-e},_block:function(e){var t,n,r,o,i,a,s,u=e.slice(0),c=this._h;for(r=c[0],o=c[1],i=c[2],a=c[3],s=c[4],t=0;t<=79;t++)t>=16&&(u[t]=this._S(1,u[t-3]^u[t-8]^u[t-14]^u[t-16])),n=this._S(5,r)+this._f(t,o,i,a)+s+u[t]+this._key[Math.floor(t/20)]|0,s=a,a=i,i=this._S(30,o),o=r,r=n;c[0]=c[0]+r|0,c[1]=c[1]+o|0,c[2]=c[2]+i|0,c[3]=c[3]+a|0,c[4]=c[4]+s|0}},i.hash.sha512=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},i.hash.sha512.hash=function(e){return(new i.hash.sha512).update(e).finalize()},i.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"==typeof e&&(e=i.codec.utf8String.toBits(e));var t,n=this._buffer=i.bitArray.concat(this._buffer,e),r=this._length,o=this._length=r+i.bitArray.bitLength(e);for(t=1024+r&-1024;t<=o;t+=1024)this._block(n.splice(0,32));return this},finalize:function(){var e,t=this._buffer,n=this._h;for(e=(t=i.bitArray.concat(t,[i.bitArray.partial(1,1)])).length+4;31&e;e++)t.push(0);for(t.push(0),t.push(0),t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,32));return this.reset(),n},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){var e,t=0,n=2;function r(e){return 4294967296*(e-Math.floor(e))|0}function o(e){return 1099511627776*(e-Math.floor(e))&255}e:for(;t<80;n++){for(e=2;e*e<=n;e++)if(n%e==0)continue e;t<8&&(this._init[2*t]=r(Math.pow(n,.5)),this._init[2*t+1]=o(Math.pow(n,.5))<<24|this._initr[t]),this._key[2*t]=r(Math.pow(n,1/3)),this._key[2*t+1]=o(Math.pow(n,1/3))<<24|this._keyr[t],t++}},_block:function(e){var t,n,r,o=e.slice(0),i=this._h,a=this._key,s=i[0],u=i[1],c=i[2],l=i[3],d=i[4],f=i[5],p=i[6],g=i[7],h=i[8],m=i[9],v=i[10],y=i[11],b=i[12],_=i[13],w=i[14],S=i[15],O=s,P=u,I=c,C=l,k=d,E=f,R=p,T=g,x=h,L=m,M=v,A=y,D=b,N=_,j=w,U=S;for(t=0;t<80;t++){if(t<16)n=o[2*t],r=o[2*t+1];else{var B=o[2*(t-15)],F=o[2*(t-15)+1],W=(F<<31|B>>>1)^(F<<24|B>>>8)^B>>>7,q=(B<<31|F>>>1)^(B<<24|F>>>8)^(B<<25|F>>>7),H=o[2*(t-2)],G=o[2*(t-2)+1],V=(G<<13|H>>>19)^(H<<3|G>>>29)^H>>>6,K=(H<<13|G>>>19)^(G<<3|H>>>29)^(H<<26|G>>>6),z=o[2*(t-7)],J=o[2*(t-7)+1],X=o[2*(t-16)],Y=o[2*(t-16)+1];n=W+z+((r=q+J)>>>0<q>>>0?1:0),n+=V+((r+=K)>>>0<K>>>0?1:0),n+=X+((r+=Y)>>>0<Y>>>0?1:0)}o[2*t]=n|=0,o[2*t+1]=r|=0;var Q=x&M^~x&D,$=L&A^~L&N,Z=O&I^O&k^I&k,ee=P&C^P&E^C&E,te=(P<<4|O>>>28)^(O<<30|P>>>2)^(O<<25|P>>>7),ne=(O<<4|P>>>28)^(P<<30|O>>>2)^(P<<25|O>>>7),re=(L<<18|x>>>14)^(L<<14|x>>>18)^(x<<23|L>>>9),oe=(x<<18|L>>>14)^(x<<14|L>>>18)^(L<<23|x>>>9),ie=a[2*t],ae=a[2*t+1],se=U+oe,ue=j+re+(se>>>0<U>>>0?1:0);ue+=Q+((se+=$)>>>0<$>>>0?1:0),ue+=ie+((se+=ae)>>>0<ae>>>0?1:0);var ce=ne+ee;j=D,U=N,D=M,N=A,M=x,A=L,x=R+(ue+=n+((se=se+r|0)>>>0<r>>>0?1:0))+((L=T+se|0)>>>0<T>>>0?1:0)|0,R=k,T=E,k=I,E=C,I=O,C=P,O=ue+(te+Z+(ce>>>0<ne>>>0?1:0))+((P=se+ce|0)>>>0<se>>>0?1:0)|0}u=i[1]=u+P|0,i[0]=s+O+(u>>>0<P>>>0?1:0)|0,l=i[3]=l+C|0,i[2]=c+I+(l>>>0<C>>>0?1:0)|0,f=i[5]=f+E|0,i[4]=d+k+(f>>>0<E>>>0?1:0)|0,g=i[7]=g+T|0,i[6]=p+R+(g>>>0<T>>>0?1:0)|0,m=i[9]=m+L|0,i[8]=h+x+(m>>>0<L>>>0?1:0)|0,y=i[11]=y+A|0,i[10]=v+M+(y>>>0<A>>>0?1:0)|0,_=i[13]=_+N|0,i[12]=b+D+(_>>>0<N>>>0?1:0)|0,S=i[15]=S+U|0,i[14]=w+j+(S>>>0<U>>>0?1:0)|0}},void 0===i.beware&&(i.beware={}),i.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){i.mode.cbc={name:"cbc",encrypt:function(e,t,n,r){if(r&&r.length)throw new i.exception.invalid("cbc can't authenticate data");if(128!==i.bitArray.bitLength(n))throw new i.exception.invalid("cbc iv must be 128 bits");var o,a=i.bitArray,s=a._xor4,u=a.bitLength(t),c=0,l=[];if(7&u)throw new i.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(o=0;c+128<=u;o+=4,c+=128)n=e.encrypt(s(n,t.slice(o,o+4))),l.splice(o,0,n[0],n[1],n[2],n[3]);return u=16843009*(16-(u>>3&15)),n=e.encrypt(s(n,a.concat(t,[u,u,u,u]).slice(o,o+4))),l.splice(o,0,n[0],n[1],n[2],n[3]),l},decrypt:function(e,t,n,r){if(r&&r.length)throw new i.exception.invalid("cbc can't authenticate data");if(128!==i.bitArray.bitLength(n))throw new i.exception.invalid("cbc iv must be 128 bits");if(127&i.bitArray.bitLength(t)||!t.length)throw new i.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var o,a,s,u=i.bitArray,c=u._xor4,l=[];for(r=r||[],o=0;o<t.length;o+=4)a=t.slice(o,o+4),s=c(n,e.decrypt(a)),l.splice(o,0,s[0],s[1],s[2],s[3]),n=a;if(0===(a=255&l[o-1])||a>16)throw new i.exception.corrupt("pkcs#5 padding corrupt");if(s=16843009*a,!u.equal(u.bitSlice([s,s,s,s],0,8*a),u.bitSlice(l,32*l.length-8*a,32*l.length)))throw new i.exception.corrupt("pkcs#5 padding corrupt");return u.bitSlice(l,0,32*l.length-8*a)}}},i.bitArray._xor4=function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}},,,function(e,t){},,function(e,t){},,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeMessageController=void 0;var r=n(978),o=n(979),i=n(980),a=n(981),s=n(984),u=n(985),c=n(986),l=n(987),d=n(988),f=n(998),p=n(999),g=n(1e3),h=n(1001),m=n(1002),v=n(1003),y=n(1004);t.makeMessageController=function(e){var t=g.makeExternalHandlersService(),n=a.makePairingDataService(e.storage),b=i.makeEncryptionService(e.encrypt,e.decrypt,n),_=r.makeBuildMessageService(b),w=s.makeSendMessageService(e.send),S=o.makeConfirmationService(n,t,e.syncStorage);return n.loadPairingDataFromStorage().then((function(){return{initializeCommunication:function(){return f.initializeCommunication(e.browser,e.extensionHostUrl,e.extensionBuild,e.extensionFeatures,_,w,n)},getVerificationCode:function(){return Promise.resolve(l.getVerificationCode(n))},confirmVerificationCode:function(){return c.confirmVerificationCode(n,_,w,S)},confirmAutomaticPairing:function(t){return u.confirmAutomaticPairing(e.restartConnectionHandler,n,_,w,S,t)},handleIncomingMessage:function(r){return d.handleIncomingMessage(e.restartConnectionHandler,e.openNewTabWithInternalPage,n,b,_,w,S,t,r)},setCipheredOrderHandler:function(e){return m.setCipheredOrderHandler(t,e)},setIdentificationMessageHandler:function(e){return v.setIdentificationMessageHandler(t,e)},setReadyToSendHandler:function(e){return y.setReadyToSendHandler(t,e)},isReadyToSend:function(){return p.isReadyToSend(S)},sendOrder:function(e){return h.sendOrder(w,_,e)}}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBuildMessageService=void 0,t.makeBuildMessageService=function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{protocolVersion:1,content:{type:e,params:t}}}return{getMessage:t,getCipheredMessage:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.encrypt(t(n,r))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeConfirmationService=void 0;var r=n(6),o=n(1);t.makeConfirmationService=function(e,t,n){var i=!1,a=!1,s=[],u=function(){return i&&a},c=function(){u()&&s.forEach((function(e){return e()}))};return s.push((function(){r.exceptionLog({funcName:"confirmationService",fileName:"common/background/communication/messageController/services/confirmationService.ts",code:o.ExceptionCode.Warning,message:"[plugin_communication][pairing_success] pairing process successful, ready to communicate",type:"extensionException"}),e.preventFutureImplicitPairing(),t.callReadyToSendHandler()})),{confirmExtension:function(){i=!0,c()},confirmPlugin:function(){a=!0,c()},isConfirmed:u,addPairingConfirmedListener:function(e){s.push(e)},shouldAcceptImplicitPairing:function(){return e.shouldAcceptImplicitPairing().then((function(e){return!!e&&!!n.get("installerId")}))},confirmImplicitPairing:function(){i=!0,a=!0,c()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEncryptionService=void 0,t.makeEncryptionService=function(e,t,n){return{decrypt:function(e){var r=n.getPairingData();if(!r||!r.commonSecret)throw new Error("[pairing][encryptionHandler][decrypt] commonSecret is not available. pairingData: ".concat(JSON.stringify(r)));return t(r.commonSecret,e.content).then((function(e){return JSON.parse(e)})).then((function(t){return Object.assign(Object.assign({},e),{content:t})}))},encrypt:function(t){var r=n.getPairingData();if(!r||!r.commonSecret)throw new Error("[pairing][encryptionHandler][encrypt] commonSecret is not available. pairingData: ".concat(JSON.stringify(r)));var o=JSON.stringify(t.content);return e(r.commonSecret,o).then((function(e){return Object.assign(Object.assign({},t),{content:e})}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePairingDataService=void 0;var r=n(982);t.makePairingDataService=function(e){var t;return{getPairingData:function(){return t},generateNewPairingData:function(e,n){var o=r.generatePairingSecret(),i=r.encodePairingSecret(o),a=r.computeSharedSecret(o,n),s=r.computeVerificationCode(a);t={pairingId:e,pluginMix:n,extensionSecret:o,extensionMix:i,commonSecret:a,verificationCode:s}},loadPairingDataFromStorage:function(){return e.get("pairingData").then((function(e){t=e}))},persistPairingDataToStorage:function(){return e.set("pairingData",t).then((function(){return e.set("preventFutureImplicitPairing",!0)}))},clearPairingDataInStorage:function(){return e.set("pairingData",null)},getEncryptionKey:function(){if(!t||!t.commonSecret)throw new Error("[pairingDataService][getEncryptionKey] commonSecret is not available. pairingData: ".concat(JSON.stringify(t)));return t.commonSecret},getVerificationCode:function(){if(!t||!t.verificationCode)throw new Error("[pairingDataService][getVerificationCode] verificationCode is not available. pairingData: ".concat(JSON.stringify(t)));return(e=t.verificationCode).length>=6?e:new Array(6-e.length+1).join("0")+e;var e},shouldAcceptImplicitPairing:function(){return e.get("preventFutureImplicitPairing").then((function(e){return!e}))},preventFutureImplicitPairing:function(){return e.set("preventFutureImplicitPairing",!0)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeVerificationCode=t.computeSharedSecret=t.encodePairingSecret=t.generatePairingSecret=void 0;var r=n(393),o=n(983),i=Math.pow(2,31)-1;t.generatePairingSecret=function(){return Math.floor(Math.random()*(i+1))},t.encodePairingSecret=function(e){return o.generator.modPow(e,o.prime).toString()},t.computeSharedSecret=function(e,t){return r(t).modPow(e,o.prime).toString()},t.computeVerificationCode=function(e){return r(e).mod(1e6).toString()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prime=t.generator=void 0;var r=n(393);t.generator=r(2),t.prime=r("00:c3:94:4e:15:09:c2:8c:e4:46:ce:fc:e1:bf:82:ce:a5:81:12:cc:f7:4a:ce:4b:24:1d:7d:99:df:5b:d7:e6:fe:ae:17:23:34:f7:13:07:39:08:49:ce:c2:8e:08:33:71:d1:27:09:09:fd:2f:e1:05:c0:a1:cc:38:a4:b2:e5:d9:26:87:80:94:d3:de:21:a2:e8:be:03:5a:59:80:f8:df:40:bd:ce:3d:d8:0a:54:87:dd:c4:cd:6d:74:e3:84:2e:cb:9a:63:3f:d4:e9:79:94:d4:d1:a1:c9:41:1c:e5:06:55:d6:53:dd:11:78:4e:b7:9f:88:a7:c4:eb:b9:9c:6d:1f:05:d7:81:2d:92:23:c4:8d:83:eb:e1:7e:f4:89:ff:1b:a2:ab:f4:a1:ed:d3:80:ae:e6:1b:90:06:cd:67:04:5c:2f:63:42:10:3d:50:0a:0a:d1:29:01:78:1d:7a:9b:8f:6b:8d:30:e4:ef:2d:56:0a:58:af:76:8b:d9:18:3e:00:30:08:60:20:e6:f4:bb:67:b4:97:f7:f5:90:fd:76:66:a9:f0:23:cb:c6:53:be:2b:3e:51:f1:0a:d2:cd:d2:95:fd:1b:2f:6c:b1:da:f2:c3:c3:ff:12:ce:bd:de:5d:24:c1:a3:ef:ce:33:2b:ae:22:e7:c9:09:4d:ee:dc:8b".replace(new RegExp(":","g"),""),16)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeSendMessageService=void 0;var r=n(30);t.makeSendMessageService=function(e){return{sendMessage:function(t){if(r.Logger.getInstance().log("[SendMessageService] Sending message: ".concat(JSON.stringify(t,null,4)),3),"string"!=typeof t){var n=JSON.stringify(t);e(n)}else e(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmAutomaticPairing=void 0;var r=n(6),o=n(158),i=n(1);t.confirmAutomaticPairing=function(e,t,n,a,s,u){r.exceptionLog({funcName:"confirmAutomaticPairing",fileName:"common/background/communication/messageController/confirmAutomaticPairing.ts",code:i.ExceptionCode.Warning,message:"[plugin_communication][automatic_pairing] confirm automatic pairing",type:"extensionException"}),u===t.getVerificationCode()?(s.confirmImplicitPairing(),o.persistPairingDataIfAllPartiesConfirmed(t,s),a.sendMessage(n.getMessage("EXTENSION_CONFIRM_PAIRING"))):e()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmVerificationCode=void 0;var r=n(158);t.confirmVerificationCode=function(e,t,n,o){o.confirmExtension(),r.persistPairingDataIfAllPartiesConfirmed(e,o),n.sendMessage(t.getMessage("EXTENSION_CONFIRM_PAIRING"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerificationCode=void 0,t.getVerificationCode=function(e){return e.getVerificationCode()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleIncomingMessage=void 0;var r=n(30),o=n(989),i=n(990),a=n(991),s=n(992),u=n(993),c=n(994),l=n(995),d=n(996),f=n(997);t.handleIncomingMessage=function(e,t,n,p,g,h,m,v,y){Promise.resolve().then((function(){if(o.isCipheredMessage(y))return p.decrypt(y);if(o.isClearTextPairingMessage(y))return y;throw new Error("Message is invalid. Message: ".concat(JSON.stringify(y)))})).then((function(o){switch(r.Logger.getInstance().log("[handleIncomingMessage] Receiving message: ".concat(JSON.stringify(o,null,4)),3),o&&o.content&&o.content.type){case"PLUGIN_IDENTIFICATION":f.handlePluginIdentification(v,y);break;case"PLUGIN_SEND_PAIRING_REQUEST":l.handlePluginSendPairingRequest(n,g,h,y);break;case"PLUGIN_PAIRING_HANDSHAKE":u.handlePluginPairingHandshake(n,p,g,h,y);break;case"PLUGIN_ASK_TO_SHOW_CONFIRMATION_CODE":a.handlePluginAskToShowConfirmationCode(t);break;case"PLUGIN_CONFIRM_PAIRING":s.handlePluginConfirmPairing(n,m);break;case"PLUGIN_VALID_PAIRING":d.handlePluginValidPairing(m);break;case"PLUGIN_REQUEST_IMPLICIT_PAIRING":c.handlePluginRequestsImplicitPairing(e,n,m,h,g);break;case"CIPHERED_ORDER":i.handleCipheredOrder(v,m,o);break;default:throw new Error("Message type is unknown. Message: ".concat(JSON.stringify(o)))}})).catch((function(t){r.Logger.getInstance().logError("[handleIncomingMessage] Failed to parse incoming message, clearing pairing data and killing websocket connection",t,0),n.clearPairingDataInStorage().then((function(){e()}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCipheredMessage=t.isClearTextPairingMessage=void 0,t.isClearTextPairingMessage=function(e){var t=e&&e.content&&e.content.type;return["PLUGIN_IDENTIFICATION","PLUGIN_SEND_PAIRING_REQUEST"].includes(t)},t.isCipheredMessage=function(e){return e&&"string"==typeof e.content}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCipheredOrder=void 0,t.handleCipheredOrder=function(e,t,n){if(!t.isConfirmed())throw new Error("[handleCipheredOrder] Communication pairing has not been confirmed. Can't treat CIPHERED_ORDER message");try{var r=function(e){return JSON.parse(e.content.params.order)}(n);e.callCipheredOrderHandler(r)}catch(e){console.warn("[handleCipheredOrder] Can't parse ciphered order JSON")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginAskToShowConfirmationCode=void 0;var r=n(6),o=n(1);t.handlePluginAskToShowConfirmationCode=function(e){r.exceptionLog({funcName:"handlePluginAskToShowConfirmationCode",fileName:"common/background/communication/messageController/handleIncomingMessage/handlePluginAskToShowConfirmationCode.ts",code:o.ExceptionCode.Warning,message:"[plugin_communication][explicit_pairing] explicit pairing requested",type:"extensionException"}),e("pairingVerification.html")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginConfirmPairing=void 0;var r=n(158);t.handlePluginConfirmPairing=function(e,t){t.confirmPlugin(),r.persistPairingDataIfAllPartiesConfirmed(e,t)}},function(e,t,n){"use strict";function r(e,t){e.getCipheredMessage("EXTENSION_PAIRING_HANDSHAKE",{challenge:"This is Major Tom to Ground Control"}).then((function(e){t.sendMessage(e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginPairingHandshake=t.sendExtensionPairingHandshake=void 0,t.sendExtensionPairingHandshake=r,t.handlePluginPairingHandshake=function(e,t,n,o,i){var a=e.getPairingData();if(!a||!a.commonSecret)throw new Error("[pairing][controller][handlePluginPairingHandshake] commonSecret is not available. pairingData: ".concat(JSON.stringify(a)));t.decrypt(i).then((function(e){if(!e.content.params||"This is Ground Control to Major Tom"!==e.content.params.challenge)throw new Error("[pairing][controller][handlePluginPairingHandshake] challenge is invalid. message: ".concat(JSON.stringify(e)));r(n,o)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginRequestsImplicitPairing=void 0;var r=n(30),o=n(6),i=n(158),a=n(1);t.handlePluginRequestsImplicitPairing=function(e,t,n,s,u){o.exceptionLog({funcName:"handlePluginRequestsImplicitPairing",fileName:"common/background/communication/messageController/handleIncomingMessage/handlePluginRequestsImplicitPairing.ts",code:a.ExceptionCode.Warning,message:"[plugin_communication][implicit_pairing] implicit pairing requested",type:"extensionException"}),n.shouldAcceptImplicitPairing().then((function(o){t.preventFutureImplicitPairing().then((function(){if(!o){var a="[handlePluginRequestsImplicitPairing] Can't do implicit pairing, killing websocket connection";return r.Logger.getInstance().logError(a,new Error(a),1),void e()}n.confirmImplicitPairing(),i.persistPairingDataIfAllPartiesConfirmed(t,n),u.getCipheredMessage("EXTENSION_ACCEPT_IMPLICIT_PAIRING").then((function(e){s.sendMessage(e)}))}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginSendPairingRequest=void 0,t.handlePluginSendPairingRequest=function(e,t,n,r){if(!r.content.params||!r.content.params.newPairingId||!r.content.params.pluginMix)throw new Error("[pairing][controller][handlePluginSendPairingRequest] message is malformed (missing data). message: ".concat(JSON.stringify(r)));e.generateNewPairingData(r.content.params.newPairingId,r.content.params.pluginMix),function(e,t,n){t.sendMessage(e.getMessage("EXTENSION_RESPONSE_TO_PAIRING_REQUEST",{extensionMix:n}))}(t,n,e.getPairingData().extensionMix)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginValidPairing=void 0;var r=n(6),o=n(1);t.handlePluginValidPairing=function(e){r.exceptionLog({funcName:"handlePluginValidPairing",fileName:"common/background/communication/messageController/handleIncomingMessage/handlePluginValidPairing.ts",code:o.ExceptionCode.Warning,message:"[plugin_communication][already_paired] already paired, continuing with existing pairing key",type:"extensionException"}),e.confirmPlugin(),e.confirmExtension()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlePluginIdentification=void 0,t.handlePluginIdentification=function(e,t){e.callInitializationMessageHandler(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCommunication=void 0;var r=n(6),o=n(1);t.initializeCommunication=function(e,t,n,i,a,s,u){r.exceptionLog({funcName:"initializeCommunication",fileName:"common/background/communication/messageController/initializeCommunication.ts",code:o.ExceptionCode.Warning,message:"[plugin_communication][pairing_started] pairing process initialized",type:"extensionException"});var c=u.getPairingData(),l=c&&c.pairingId;s.sendMessage(a.getMessage("EXTENSION_IDENTIFICATION",{browser:e,extensionAutomaticPairingPageUrl:t+"pairingVerification.html?code=",version:n,features:i,pairingId:l}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReadyToSend=void 0,t.isReadyToSend=function(e){return e.isConfirmed()}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.makeExternalHandlersService=void 0,t.makeExternalHandlersService=function(){var t={cipheredOrder:function(){},initializationMessage:function(){},readyToSend:function(){}};return{setCipheredOrderHandler:function(e){t.cipheredOrder=e},callCipheredOrderHandler:function(n){e((function(){t.cipheredOrder(n)}))},setIdentificationMessageHandler:function(e){t.initializationMessage=e},callInitializationMessageHandler:function(e){t.initializationMessage(e)},setReadyToSendHandler:function(e){t.readyToSend=e},callReadyToSendHandler:function(){t.readyToSend()}}}}).call(this,n(353).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendOrder=void 0,t.sendOrder=function(e,t,n){return t.getCipheredMessage("CIPHERED_ORDER",{order:JSON.stringify(n)}).then((function(t){e.sendMessage(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCipheredOrderHandler=void 0,t.setCipheredOrderHandler=function(e,t){e.setCipheredOrderHandler(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIdentificationMessageHandler=void 0,t.setIdentificationMessageHandler=function(e,t){e.setIdentificationMessageHandler(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setReadyToSendHandler=void 0,t.setReadyToSendHandler=function(e,t){e.setReadyToSendHandler(t)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeFrameController=void 0;var l=n(1006),d=n(30),f=n(69),p=n(151),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=s.call(this,e,t)).tabController=e,n.frameObject=t,n}return t=u,(n=[{key:"postMessage",value:function(e){if(!this._eventBus)throw new Error("Event bus not ready");this._eventBus.messageFromExtension(e)}},{key:"initCommunicationChannel",value:function(e,t){return c(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}throw new Error("bus is null, should not happen");case 2:return n.prev=2,this._eventBus&&delete this._eventBus,this._eventBus=e,this._eventBus.messageFromJs.on((function(e){e.type&&"kwFrameIdKnown"===e.type?i.kwframeid=e.kwframeid:(i._isMeaning=!0,i.dispatchMessage(e))})),n.next=8,p.default().isMarshmallowEnabled();case 8:r=n.sent,o=f.default().getInitialDataForInjected({isUserLoggedIn:p.default().userLoggedIn,frameId:t,hasSecureWebUi:!0,features:p.default().getAccountFeatures(),isMarshmallowEnabled:r}),this._eventBus.messageFromExtension(o),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),d.Logger.getInstance().logError("initCommunicationChannel frame",n.t0,0);case 16:case"end":return n.stop()}}),n,this,[[2,13]])})))}},{key:"catchMessageFromWebpage",value:function(){}}])&&o(t.prototype,n),r&&o(t,r),u}(l.FrameController);t.ChromeFrameController=g,l.setSpecificClass(g)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getSpecificClass=t.setSpecificClass=t.FrameController=void 0;var o=n(70),i=n(139),a=n(30),s=n(6),u=n(1),c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._bufferedDOMInformations=null,this.bufferedMessagesUntilPositionFound=[],this.frameUniqueId=null,this.framePosition=null,this.kwframeid=null,this.name=null,this.url=null,this.uID=null,this._scriptInjected=!1,this._isMeaning=!1,this.tabController=t,this.frameObject=n}var t,n,s;return t=e,(n=[{key:"setFramePosition",value:function(e){if(this.framePosition=e,null!==this.bufferedMessagesUntilPositionFound){var t=this.bufferedMessagesUntilPositionFound;this.bufferedMessagesUntilPositionFound=null;for(var n=0,r=t.length;n<r;n++)this.dispatchMessage(t[n])}}},{key:"setInformations",value:function(e){this.frameUniqueId=e.frameUniqueId||null,this.url=e.frameUrl,this.name=e.frameName}},{key:"setUID",value:function(e){this.uID=e}},{key:"destruct",value:function(){}},{key:"catchMessageFromWebpage",value:function(e){}},{key:"couldBeThatFrame",value:function(e){var t=this.url&&""!==this.url&&(this.url===e.frameUrl||e.frameUrl.startsWith(this.url)),n=this.name&&""!==this.name&&this.name===e.frameName,r=this.kwframeid&&"denied"!==this.kwframeid&&"unset"!==this.kwframeid&&this.kwframeid===e.kwframeid;return!!(t||n||r)&&(this.kwframeid=e.kwframeid||null,!0)}},{key:"dispatchMessage",value:function(e){if(this.isNormalDispatchOrder(e))i.dispatch(e,this.tabController.tabId);else if(!this.isNoDispatchOrder(e)){var t=e.action;switch(o.default().logOrder(t+" (frame)",e,"fromInjectedJsToExtension"),t){case"DOMInformations":case"signalNewDOMInformations":if(this._bufferedDOMInformations===e.domStructure)return;return this._bufferedDOMInformations=e.domStructure,void(this.tabController.isWaitingForAnyDOMInformations()||this.tabController.sendNewDOMInformationsFromFrame("signalAjaxDOMInformations"));case"signalAjaxDOMInformations":case"signalCssDOMInformations":if(this._bufferedDOMInformations===e.domStructure)return;return this._bufferedDOMInformations=e.domStructure,void this.tabController.sendNewDOMInformationsFromFrame(t);default:return void a.Logger.getInstance().log("dispatchOrder (frame) order type not treated: "+t,1)}}}},{key:"isNormalDispatchOrder",value:function(e){var t=e.action||"";switch(t){case"logOnline":case"oneClickDebuggerOrder":case"logException":return!0;case"mlResults":case"getDescriptionsForAutoFill":case"focusDescriptionsForAutoFill":case"blurDescriptionsForAutoFill":case"valueDescriptionsForAutoFill":case"autoFillForm":case"changeDefaultAndAutoFillForm":case"eventOnOutFired":case"signalXPathListForBasket":case"signalContextDebugInfo":case"sendAutofillLog":return!0;default:return t.startsWith("DashlaneAPIRequest_")}}},{key:"isNoDispatchOrder",value:function(e){var t=e.action;return"documentComplete"===t||"signalStructurePerformance"===t}}])&&r(t.prototype,n),s&&r(t,s),e}();t.FrameController=c;var l=null;function d(){if(!l)throw s.exceptionLog({code:u.ExceptionCode.Error,fileName:"common/background/frame/index.ts",funcName:"getSpecificClass",message:"getSpecificClass is called but instance is not initialized"}),"getSpecificClass is called but instance is not initialized";return l}t.setSpecificClass=function(e){l=e},t.getSpecificClass=d,t.default=d},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.TabController=void 0;var o=n(193),i=n(13),a=n(70),s=n(287),u=n(56),c=n(30),l=n(19),d=n(26),f=n(143),p=n(286),g=n(395),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.injectedScriptExecutionAllowed=!1,this.tabActive=!1,this._bufferedDOMInformations=null,this._waitForNewDOMInformations=!1,this._webUIController=null,this._webUIHistory=[],this._inputsPosition={},this._frames=[],this._hiddingInProgress=!1,this._pendingWebUItoShow=null,this.pageId=null,this.focusedOnce=!1,this.tabId=t}var t,n,h;return t=e,(n=[{key:"getFrames",value:function(){return this._frames}},{key:"addFrame",value:function(e){this._frames.push(e)}},{key:"isCurrentTabController",value:function(e){l.default().isCurrentTabController(this,e)}},{key:"dispatchMessage",value:function(e){s.Dispatcher.dispatch(e,this.tabId)}},{key:"getDomain",value:function(){return f.getDomain(this.getLocation())}},{key:"selected",value:function(){this.focusedOnce=!0,this.tabActive||(this.tabActive=!0),this.signalTabFocused()}},{key:"signalTabFocused",value:function(){this.sendOrderToAllFrames({action:"controlMessageToWebpage",demand:"tabBecomeKey"})}},{key:"unselected",value:function(){this.injectedScriptExecutionAllowed&&this.signalInjectedScriptExecutionUnallowed(),this.tabActive&&(this.tabActive=!1)}},{key:"signalInjectedScriptExecutionAllowed",value:function(){this.sendOrderToAllFrames({action:"controlMessageToWebpage",demand:"analysisAllowed"})}},{key:"allowInjectedScriptExecution",value:function(){c.Logger.getInstance().logAsapEvent("Javascript execution allowed",3),this.injectedScriptExecutionAllowed=!0,this.signalInjectedScriptExecutionAllowed()}},{key:"signalInjectedScriptExecutionUnallowed",value:function(){this.sendOrderToAllFrames({action:"controlMessageToWebpage",demand:"tabResignKey"})}},{key:"forbidInjectedScriptExecution",value:function(){c.Logger.getInstance().logAsapEvent("Javascript execution forbidden",3),this.injectedScriptExecutionAllowed=!1,this.signalInjectedScriptExecutionUnallowed()}},{key:"signalWaitForNewDOMInformations",value:function(){c.Logger.getInstance().log("signalWaitForNewDOMInformations",3),this._waitForNewDOMInformations=!0}},{key:"signalNewDOMInformationsSent",value:function(){c.Logger.getInstance().log("signalNewDOMInformationsSent",3),this._waitForNewDOMInformations=!1}},{key:"isWaitingForAnyDOMInformations",value:function(){return this._waitForNewDOMInformations}},{key:"sendNewDOMInformationsFromFrame",value:function(e){try{var t={action:e,domStructure:this.getFullDOMStructureWithFrames(),location:this.getLocation()};u.getInstance().sendDomInformationsOrder(t,this.tabId)}catch(e){c.Logger.getInstance().logError("sendNewDOMInformationsFromFrame failed with error",e,2)}}},{key:"sendNewDOMInformationsWithFrame",value:function(e){try{e.domStructure=this.populateDOMStructureWithFrames(e.domStructure),e.location=this.getLocation(),u.getInstance().sendDomInformationsOrder(e,this.tabId)}catch(e){c.Logger.getInstance().logError("sendNewDOMInformationsWithFrame failed with error",e,2)}}},{key:"getFullDOMStructureWithFrames",value:function(){return this.populateDOMStructureWithFrames(this._bufferedDOMInformations)}},{key:"populateDOMStructureWithFrames",value:function(e){if(!e)throw new Error("getFullDOMStructureWithFrames or populateDOMStructureWithFrames failed because buffered DOM structure is empty. No DOM structure sent.");for(var t,n=this.getFrames(),r=0,o=n.length;r<o;r++){var i=(t=n[r].frameUniqueId,'">>>KWIFT_FRAME_CONTENT_PLACEHOLDER_'.concat(t,'<<<"'));try{var a=n[r]._bufferedDOMInformations;if(a){var s=e.indexOf(i);if(-1!==s)e=e.substring(0,s)+"["+a+"]"+e.substring(s+i.length);else{c.Logger.getInstance().log("Frame isn't in the general DOM Structure",2);var u=n[r].frameUniqueId,l=u&&u.replace("fromInjectedFrame","");if(l){var d=e.lastIndexOf("]");if(!(d>-1))throw new Error("Main DOM structure has no children brackets");var f="["===e[d-1]?"":",",p='{"0":"iframe","1":"'.concat(l,'","6":[')+a+"]}";e=e.substring(0,d)+f+p+e.substring(d)}}}else e=e.replace(i,"[]")}catch(t){c.Logger.getInstance().logError("getFullDOMStructureWithFrames just found a corrupted frame: skip!",t,2),e=e.replace(i,"[]")}}return e=e.replace(/">>>KWIFT_FRAME_CONTENT_PLACEHOLDER_fromInjectedFrame[a-z0-9]{64}<<<"/g,"[]")}},{key:"sendDocumentComplete",value:function(){try{this.forbidInjectedScriptExecution(),a.default().signalLoadEvent("DOCUMENT_COMPLETE",this.tabId);var e=this.getLocation();this.pageId=o.v4();var t={action:"documentComplete",url:e};(i.default().isStandalone()||i.default().getPluginFeatures().mfa)&&(t.pageId=this.pageId),u.getInstance().documentComplete(t,this.tabId),this._hiddingInProgress=!1,this._pendingWebUItoShow=null,this.restoreWebUI()}catch(e){c.Logger.getInstance().logError("An error occured when sending documentComplete event",e,1)}}},{key:"sendOrder",value:function(e){u.getInstance().sendOrderToCpp(e,this.tabId,"fromExtensionToCpp")}},{key:"sendOrderToAllFrames",value:function(e){u.getInstance().sendOrderToAllFrames(e,this.tabId,"dashlaneMessageToWebPageForAllFrames")}},{key:"sendLoadEventToCpp",value:function(e,t){void 0===t||t?this.sendOrder({action:"event",eventType:e,location:this.getLocation()}):this.sendOrder({action:"event",eventType:e})}},{key:"showWebUI",value:function(e,t){if(this._hiddingInProgress)this._pendingWebUItoShow={pageId:e,uiInfos:t};else if(this._webUIController)"autologin-selection"===this._webUIController.getType()&&"autologin-selection"===t.type&&t.uiData.loggingIn&&(this._pendingWebUItoShow={pageId:e,uiInfos:t});else if(i.default().isStandalone()&&e&&e!==this.pageId&&!["save-password","limited-capability"].includes(t.type))a.default().log(4,"pageId mismatch, discard order","showWebUI()");else{var n=new(g.getWebUIFactory())(this.tabId,t);this._webUIController=n,n.show()}}},{key:"forwardVisibilityResponseToWebUI",value:function(e,t){var n;null===(n=this._webUIController)||void 0===n||n.sendCheckVisibilityResponse(e,t)}},{key:"_saveWebUIHistory",value:function(){this._webUIController&&(this._webUIHistory.push({elemId:this._webUIController.getSrcElementId(),type:this._webUIController.getType(),when:Date.now()}),this._webUIHistory.length>10&&this._webUIHistory.shift())}},{key:"hideWebUI",value:function(e){var t=this;if(this._webUIController){if(this._webUIController.getType()!==e)return;this._hiddingInProgress=!0,this._webUIController.hide(!0,(function(){t._saveWebUIHistory(),t._webUIController=null,t._currentWebUIHidden()}))}}},{key:"_currentWebUIHidden",value:function(){this._hiddingInProgress=!1,this._pendingWebUItoShow&&(this.showWebUI(this._pendingWebUItoShow.pageId,this._pendingWebUItoShow.uiInfos),this._pendingWebUItoShow=null)}},{key:"forceHideWebUI",value:function(){var e;null===(e=this._webUIController)||void 0===e||e.hide(!0),this._webUIController=null,this._hiddingInProgress=!1,this._pendingWebUItoShow=null,this._webUIHistory=[]}},{key:"signalWebUIHidden",value:function(e,t,n,r){if(this._webUIController&&this._webUIController.getId()===t&&this._webUIController.getType()===e)return"autologin-selection"===e&&"close-unfocus"===n||this.sendWebcardLog(e,n,r),this._saveWebUIHistory(),this._webUIController=null,this._currentWebUIHidden(),void u.getInstance().sendOrderToCpp({action:"signalWebUIHidden",type:e},this.tabId,"fromExtensionToCpp")}},{key:"sendWebcardLog",value:function(e,t,n){var r;(null===(r=this._webUIController)||void 0===r?void 0:r.getType())===e&&(t&&d.default().userLoggedIn?this._webUIController.sendUsageLog({type:this._webUIController.getULType(),action:t,context:this._webUIController.getULContext(),triggeringFormType:this._webUIController.getTriggeringFormType()}):n&&p.getInstance().sendInstallerLog(n))}},{key:"updateWebUI",value:function(e){var t;(null===(t=this._webUIController)||void 0===t?void 0:t.getType())===e.type&&this._webUIController.update(e)}},{key:"restoreWebUI",value:function(){var e;null===(e=this._webUIController)||void 0===e||e.restore()}},{key:"shouldBlockFocusOrder",value:function(e){if(!i.getInstance().willWebUIControllerUsePopover(this.getLocation()))return!1;if(!this._webUIHistory.length)return!1;var t=this._webUIHistory[this._webUIHistory.length-1];return"autofill-dropdown"===t.type&&t.elemId===e.srcElementId&&t.when>Date.now()-5e3}},{key:"setGuessedLoginStatus",value:function(e,t){var n;null===(n=this._webUIController)||void 0===n||n.setGuessedLoginStatus(e,t)}},{key:"cacheInputPosition",value:function(e){this._inputsPosition[e.srcElementId+""]={clientX:parseFloat(e.clientX),clientY:parseFloat(e.clientY),height:parseFloat(e.srcElementHeight),offsetX:parseFloat(e.offsetX),offsetY:parseFloat(e.offsetY),width:parseFloat(e.srcElementWidth)}}},{key:"getInputPosition",value:function(e){return Object.prototype.hasOwnProperty.call(this._inputsPosition,e+"")?this._inputsPosition[e]:null}},{key:"initializeTab",value:function(){l.default().registerTab(this),this.sendLoadEventToCpp("TAB_OPENED",!1)}}])&&r(t.prototype,n),h&&r(t,h),e}();t.TabController=h},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;var l=n(192),d=n(145),f=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){return o(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"getDefaultLanguage",value:function(){var e=this,t=[navigator.language].concat(navigator.languages||[]),n=l.find(t,(function(t){return e.isSupportedLanguage(t)}));return n?n.includes("-")?n:n+"US":"en-US"}}])&&i(t.prototype,n),r&&i(t,r),c}(d.Translations));d.setInstance(f),t.getInstance=function(){return f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makePopupChannel=t.makeLeelooChannel=void 0;var r=n(1010);Object.defineProperty(t,"makeLeelooChannel",{enumerable:!0,get:function(){return r.makeLeelooChannel}});var o=n(1011);Object.defineProperty(t,"makePopupChannel",{enumerable:!0,get:function(){return o.makePopupChannel}})},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.makeLeelooChannel=void 0;var c=n(10),l=n(159),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=s.call(this))._port=null,chrome.runtime.onConnect.addListener((function(t){if("leeloo"===t.name){var n=l.getSenderUrl(t);l.isConnectionAllowed({originUrl:n,portName:t.name})&&(e._port&&e._disconnected(),e._setupPort(t))}})),e}return t=u,(n=[{key:"send",value:function(e){if(!this._port)throw new Error("LeelooChromeChannel: no port");this._port.postMessage(e)}},{key:"_setupPort",value:function(e){var t=this;this._port=e,this._port.onMessage.addListener((function(e){return t._messageReceived(e)})),this._port.onDisconnect.addListener((function(){var e=chrome.runtime.getURL("");chrome.tabs.query({url:"".concat(e,"*")},(function(e){e&&e.length&&void 0!==e[0].id?chrome.tabs.connect(e[0].id,{name:"leeloo"}):(t._port=null,t._disconnected())}))})),this._connected()}}])&&o(t.prototype,n),r&&o(t,r),u}(c.GenericChannel);t.makeLeelooChannel=function(){return new d}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.makePopupChannel=void 0;var c=n(10),l=n(138),d=n(159),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=s.call(this))._port=null,chrome.runtime.onConnect.addListener((function(t){if("Popup"===t.name){var n=d.getSenderUrl(t),r=d.isConnectionAllowed({originUrl:n,portName:t.name});(l.browser.isEdge()||r)&&(e._port&&e._disconnected(),e._setupPort(t))}})),e}return t=u,(n=[{key:"send",value:function(e){if(!this._port)throw new Error("PopupChromeChannel: no port");this._port.postMessage(e)}},{key:"_setupPort",value:function(e){var t=this;this._port=e,this._port.onMessage.addListener((function(e){return t._messageReceived(e)})),this._port.onDisconnect.addListener((function(){t._port=null,t._disconnected()})),this._connected()}}])&&o(t.prototype,n),r&&o(t,r),u}(c.GenericChannel);t.makePopupChannel=function(){return new f}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(69),d=n(323),f=n(152),p=n(394),g=n(118),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){var e;return o(this,c),(e=u.apply(this,arguments))._credentialCallback=null,e._timeoutId=null,e._pendingRequests=[],e}return t=c,(n=[{key:"_createTabControllerIfDoesNotExist",value:function(e){var t=this;g.default().getControllerById(e.tabId)||chrome.tabs.get(e.tabId,(function(n){n.url||(n.url="basicAuthRequest#".concat(e.requestId)),t._dummyChromeTabController=new p.default(e.tabId,n)}))}},{key:"_clearDummyChromeTabController",value:function(){void 0!==this._dummyChromeTabController&&(this._dummyChromeTabController=void 0)}},{key:"credentialCallback",value:function(e,t){if(clearInterval(this._timeoutId),this._timeoutId=null,this._clearDummyChromeTabController(),!e||!t)return this._credentialCallback({});this._credentialCallback({authCredentials:{username:e,password:t}})}},{key:"init",value:function(){var e=this,t=["http://*/*","https://*/*"];if(chrome.webRequest&&chrome.webRequest.onAuthRequired){var n=function(n,r){if(n.url&&n.url.startsWith("http://"))return r({});chrome.webRequest.onCompleted.hasListener(e._requestCompleted)||chrome.webRequest.onCompleted.addListener(e._requestCompleted.bind(e),{urls:t}),chrome.webRequest.onErrorOccurred.hasListener(e._requestCompleted)||chrome.webRequest.onErrorOccurred.addListener(e._requestCompleted.bind(e),{urls:t}),e._retrieveCredentials(n,r)},r="FIREFOX"===l.default().getBrowser(),o=r?function(e){var t,r=new Promise((function(e){return t=e}));return n(e,t),r}:n;chrome.webRequest.onAuthRequired.addListener(o,{urls:t},[r?"blocking":"asyncBlocking"])}}},{key:"_requestCompleted",value:function(e){var t=this._pendingRequests.indexOf(e.requestId);t>-1&&(this._pendingRequests.splice(t,1),chrome.webRequest.onCompleted.removeListener(this._requestCompleted),chrome.webRequest.onErrorOccurred.removeListener(this._requestCompleted))}},{key:"_retrieveCredentials",value:function(e,t){var n=this;if(this._pendingRequests.includes(e.requestId))return console.error("[Basic Auth] Bad credentials"),t({});this._createTabControllerIfDoesNotExist(e),this._pendingRequests.push(e.requestId),f.getInstance().sendOrderToCpp({action:"basicAuthRequest",url:e.url},e.tabId,"fromExtensionToCpp"),this._credentialCallback=t,this._timeoutId=setTimeout((function(){n._credentialCallback=function(){return null},n._clearDummyChromeTabController(),t({})}),3e3)}}])&&i(t.prototype,n),r&&i(t,r),c}(d.BasicAuthController);t.default=function(){var e=new h;e.init(),d.setInstance(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dismissSUSSurvey=void 0;var r=n(1014);Object.defineProperty(t,"dismissSUSSurvey",{enumerable:!0,get:function(){return r.dismissSUSSurvey}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.dismissSUSSurvey=void 0;var o=n(113),i=n(11);t.dismissSUSSurvey=function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.extensionCarbonConnector.markNotificationAsInteracted(o.NotificationName.SUSSurvey);case 2:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openSession=void 0;var r=n(21),o=n(22),i=n(7),a=n(1016),s=r.BaseOrderTarget,u=s.POPUP,c=s.CARBON;t.openSession=function(e){var t=function(e){return{from:u,to:c,subject:r.BaseOrderSubject.POPOVER_REQUEST,body:{message:o.RuntimeOrderMessage.OpenSession,data:e}}}(e);i.sendMessage({order:t,internalHandler:a.sendInternalOrder})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendInternalOrder=void 0;var r=n(138),o=n(11),i=n(144),a=n(50),s=n(6),u=n(1),c=n(112);t.sendInternalOrder=function(e){var t=e.body.data;switch(i.default.updateLogin(t.params.login),t.requestType){case a.OpenSessionRequestType.SendLogin:o.carbon().openSession({login:t.params.login,password:t.params.password});break;case a.OpenSessionRequestType.SendPassword:c.performanceMethods.mark(c.PerformanceMarker.POPUP_LOGIN_REQUEST),o.carbon().openSessionWithMasterPassword({login:t.params.login,password:t.params.password,rememberPassword:t.params.rememberMe});break;case a.OpenSessionRequestType.SendOTP2:o.carbon().openSessionWithOTP({login:t.params.login,otp:t.params.otp,password:null});break;case a.OpenSessionRequestType.SendOTPForNewDevice:o.carbon().openSessionWithOTPForNewDevice({login:t.params.login,otp:t.params.otpForNewDevice,deviceName:r.device.getDefaultDeviceName(),persistData:!0,password:null});break;case a.OpenSessionRequestType.SendToken:o.carbon().openSessionWithToken({login:t.params.login,token:t.params.token,deviceName:r.device.getDefaultDeviceName(),persistData:!0,password:null});break;case a.OpenSessionRequestType.ResendToken:o.carbon().openSessionResendToken({login:t.params.login});break;default:s.exceptionLog({funcName:"sendInternalOrder",fileName:"bridge/runtime/openSession/sendInternalOrder.ts",code:u.ExceptionCode.Error,message:"Request Type doesn't match any openSession request"})}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.dismissChurnedPremiumSurvey=t.dismissChurnedPremiumDiscountNotification=t.shouldDisplayChurnedPremiumDiscountNotification=t.shouldDisplayVaultChurnedDiscount=t.shouldDisplayMoreToolsChurnedDiscount=t.isPremiumCancelled=t.hasThirtyDaysExpired=t.THIRTY_DAYS_IN_MILLISECONDS=void 0;var o=n(113),i=n(40),a=n(311),s=n(11);t.THIRTY_DAYS_IN_MILLISECONDS=2592e6;t.hasThirtyDaysExpired=function(e){var n,r,o=!1;return void 0!==e&&(n=e,(r=new Date(0)).setUTCSeconds(n),o=r.getTime()-Date.now()<t.THIRTY_DAYS_IN_MILLISECONDS),o};t.isPremiumCancelled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.PremiumStatusCode.NO_PREMIUM;return e===i.PremiumStatusCode.PREMIUM_CANCELLED};t.shouldDisplayMoreToolsChurnedDiscount=function(e){var n=e.premiumEndDate,i=e.premiumStatusCode;return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.extensionCarbonConnector.getNotificationStatus(null);case 2:if(r=e.sent,!(r.churnedDiscountOffer===o.NotificationStatus.Interacted&&t.isPremiumCancelled(i)&&t.hasThirtyDaysExpired(n))){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})))};t.shouldDisplayVaultChurnedDiscount=function(e){var n=e.premiumEndDate,i=e.premiumStatusCode;return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.extensionCarbonConnector.getNotificationStatus(null);case 2:if(r=e.sent,r.churnedDiscountOffer===o.NotificationStatus.Interacted||!t.isPremiumCancelled(i)||!t.hasThirtyDaysExpired(n)){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})))};t.shouldDisplayChurnedPremiumDiscountNotification=function(e){var n=e.premiumEndDate,i=e.premiumStatusCode;return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var r,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,e.next=3,s.extensionCarbonConnector.getNotificationStatus(null);case 3:if((u=e.sent).churnedDiscountOffer!==o.NotificationStatus.Interacted||u.moreToolsChurnedDiscountOffer!==o.NotificationStatus.Seen){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a.getABTest(a.ABTestKeys.CHURNED_DISCOUNT_OFFER_AB_TEST);case 8:return e.sent&&(r=t.isPremiumCancelled(i)&&t.hasThirtyDaysExpired(n)),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})))};t.dismissChurnedPremiumDiscountNotification=function(){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.extensionCarbonConnector.markNotificationAsSeen(o.NotificationName.MoreToolsChurnedDiscountOffer);case 2:case"end":return e.stop()}}),e)})))};t.dismissChurnedPremiumSurvey=function(){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.extensionCarbonConnector.markNotificationAsInteracted(o.NotificationName.ChurnedPremiumSurvey);case 2:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createChromeTabEnvironment=void 0;var a=n(10),s=n(1029),u=n(1019),c=n(1020),l=n(143),d=n(1021),f=n(397),p=n(1023),g=n(150),h=1e3;t.createChromeTabEnvironment=function(e){var t,n;return i(this,void 0,void 0,regeneratorRuntime.mark((function o(){var m,v,y,b,_,w,S,O,P,I=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(m=function(){return Promise.resolve()},!(null==e?void 0:e.requirements.urls)){o.next=12;break}return v=new Set(e.requirements.urls.map(l.getDomain)),o.next=5,Promise.all(r(v).map((function(e){return f.getCookiesForDomain({domain:e})})));case 5:return y=o.sent,b=y.reduce((function(e,t){return[].concat(r(e),r(t))}),[]),o.next=9,f.removeCookiesForDomain(b);case 9:return o.next=11,p.temporarilySuspendDashlaneOnDomains(v);case 11:m=o.sent;case 12:return _=new d.BrowserTabsFactory({httpHeaders:null!==(t=null==e?void 0:e.requirements.httpHeaders)&&void 0!==t?t:{},bannedAddress:null!==(n=null==e?void 0:e.requirements.blacklistUrls)&&void 0!==n?n:[]}),o.next=15,_.newTab();case 15:return w=o.sent,S=a.createEventBus({events:s.passwordChangerContentScriptEvents,channels:[u.makeBrowserTabChannel("PasswordChangerContentScriptChromeChannel",w.tabId)]}),O=S.log.on((function(e){g.getInstance().log(4,e,"PasswordChanger")})),P=function(e){return i(I,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.waitForPageChange(h);case 2:return t.next=4,c.retry((function(){return S.waitForReady({url:null!=e?e:""})}),{timeoutBetweenRetries:h});case 4:case"end":return t.stop()}}),t)})))},o.abrupt("return",{screenshot:function(e){return w.screenshot(e)},waitForNavigation:function(e){return i(I,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P();case 3:return t.abrupt("return",Object.assign(Object.assign({},e),{success:!0}));case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",Object.assign(Object.assign({},e),{success:!1}));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))},sendMessageToAnimator:function(e){return c.retry((function(){return S.sendMessageToAnimator(e)}))},goto:function(e){return i(I,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.goto(e.src,e.timeout);case 3:return t.next=5,P(e.src);case 5:return t.abrupt("return",Object.assign({},e));case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",Object.assign(Object.assign({},e),{error:String(t.t0)}));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))},close:function(){return i(I,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.close();case 2:return O(),e.next=5,m();case 5:case"end":return e.stop()}}),e)})))},dump:function(e){return c.retry((function(){return S.getDump(e)}))}});case 20:case"end":return o.stop()}}),o)})))}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.makeBrowserTabChannel=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,e);var t,n,r,s=a(u);function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=s.call(this)).portName=e,n.tabid=t,n._port=null,chrome.runtime.onConnect.addListener((function(t){t.name===e&&(n._port&&n._disconnected(),n._setupPort(t))})),n}return t=u,(n=[{key:"send",value:function(e){return c(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=3;case 1:if(!(n-- >0)){t.next=15;break}if(t.prev=2,this._port){t.next=5;break}throw new Error(this.portName+": no port");case 5:return this._port.postMessage(e),t.abrupt("return");case 9:return t.prev=9,t.t0=t.catch(2),t.next=13,new Promise((function(e){return setTimeout(e,1e3)}));case 13:t.next=1;break;case 15:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"_setupPort",value:function(e){var t=this,n=this.tabid,r=this.portName;this._port=e,this._port.onMessage.addListener((function(e){return t._messageReceived(e)})),this._port.onDisconnect.addListener((function(){chrome.tabs.connect(n,{name:r})})),this._connected()}}])&&o(t.prototype,n),r&&o(t,r),u}(n(10).GenericChannel);t.makeBrowserTabChannel=function(e,t){return new l(e,t)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.retry=void 0;var o={nbrOfTries:3,timeoutBetweenRetries:3e3};t.retry=function(e,t){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=Object.assign(Object.assign({},o),t),i=r.nbrOfTries,a=0;case 3:if(!(i-- >0)){n.next=17;break}return n.prev=4,n.next=7,e();case 7:return n.abrupt("return",n.sent);case 10:n.prev=10,n.t0=n.catch(4),a++;case 13:return n.next=15,new Promise((function(e){return setTimeout(e,r.timeoutBetweenRetries)}));case 15:n.next=3;break;case 17:if(!a){n.next=19;break}throw new Error("[Retry]: Failed with ".concat(a," errors"));case 19:throw new Error("[Retry]: Failed with ".concat(r.nbrOfTries," tries"));case 20:case"end":return n.stop()}}),n,null,[[4,10]])})))}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserTabsFactory=void 0;var s=n(1022),u=n(398),c=n(1),l=n(6),d="ChromeExtension/background/passwordChange/browserTabContainer.ts",f={file:"content/contentScripts/dashlane.passwordchanger.js",runAt:"document_end"},p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.tabs=[];var n=this.tabs,r=function(e,t){n.find((function(t){return t.tabId===e}))&&"complete"===t.status&&t.url!==u.ABOUT_BLANK_URL&&chrome.tabs.executeScript(e,f,(function(){}))};chrome.tabs.onUpdated.addListener(r),this.unsubscribe=function(){chrome.tabs.onUpdated.removeListener(r)}}var t,n,o;return t=e,(n=[{key:"newWindow",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return chrome.windows.getCurrent(e)}));case 2:return t=e.sent,e.abrupt("return",new Promise((function(e,n){chrome.windows.create({height:t.height,left:t.left,width:t.width,top:t.top,incognito:!1,type:"normal",url:u.ABOUT_BLANK_URL},(function(r){if(chrome.runtime.lastError||!r){var o=chrome.runtime.lastError,i=(void 0===o?{}:o).message,a=void 0===i?"Unknown error":i;return l.exceptionLog({funcName:"newWindow",fileName:d,code:c.ExceptionCode.Error,message:"Error while creating new window: ".concat(a),type:"extensionException"}),n(new Error("WindowCreationError"))}chrome.windows.update(t.id,{focused:!0}),e(r)}))})));case 4:case"end":return e.stop()}}),e)})))}},{key:"newTab",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,i,a,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.window){e.next=4;break}return e.next=3,this.newWindow();case 3:this.window=e.sent;case 4:return t=this.window,n=this.tabs,o=new Set(Object.keys(this.options.httpHeaders).map((function(e){return e.toLowerCase()}))),i=Object.keys(this.options.httpHeaders).map((function(e){return{name:e,value:f.options.httpHeaders[e]}})),a=this.options.bannedAddress,e.abrupt("return",new Promise((function(e,f){chrome.tabs.create({url:u.ABOUT_BLANK_URL,windowId:t.id},(function(t){if(chrome.runtime.lastError||!t.id){var u=chrome.runtime.lastError,p=(void 0===u?{}:u).message,g=void 0===p?"Unknown error":p;return l.exceptionLog({funcName:"newTab",fileName:d,code:c.ExceptionCode.Error,message:"Could not create tab: ".concat(g),type:"extensionException"}),f(new Error("TabCreationFail"))}var h={urls:["http://*/*","https://*/*"],tabId:t.id};chrome.webRequest.onBeforeRequest.addListener((function(e){if(a.some((function(t){return t.exec(e.url)})))return{cancel:!0}}),h,["blocking"]),chrome.webRequest.onBeforeSendHeaders.addListener((function(e){var t,n=(null!==(t=e.requestHeaders)&&void 0!==t?t:[]).filter((function(e){return!o.has(e.name.toLocaleLowerCase())}));return{requestHeaders:[].concat(r(n),r(i))}}),h,["requestHeaders","blocking"]);var m=new s.BrowserTab(t.id,t);n.push(m),e(m)}))})));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.unsubscribe(),t=this.tabs.map((function(e){return e.tabId})),e.next=4,new Promise((function(e){chrome.tabs.remove(t,e)}));case 4:if(!this.window){e.next=8;break}return n=this.window.id,e.next=8,new Promise((function(e){return chrome.windows.remove(n,e)}));case 8:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),o&&i(t,o),e}();t.BrowserTabsFactory=p},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserTab=void 0;var i=n(1),a=n(6),s=n(398),u=2e4,c="ChromeExtension/background/passwordChange/browserTab.ts",l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tabId=t,this.tab=n,this.requestInterception=!1}var t,n,l;return t=e,(n=[{key:"cookies",value:function(e){return Promise.resolve(Object.assign(Object.assign({},e),{cookies:[]}))}},{key:"url",value:function(){var e;return null!==(e=this.tab.url)&&void 0!==e?e:""}},{key:"waitForPageChange",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.tabId,r=new Promise((function(e){chrome.tabs.onUpdated.addListener((function t(r){r===n&&(chrome.tabs.onUpdated.removeListener(t),e())}))})),t.next=4,Promise.race([r,new Promise((function(t){return setTimeout(t,e)}))]);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=this.tabId;return new Promise((function(r,o){var u=setTimeout((function(){return d(),a.exceptionLog({funcName:"goto",fileName:c,code:i.ExceptionCode.Error,message:"Could not navigate to ".concat(e," before the timeout of ").concat(t),type:"extensionException"}),o(new Error("Timeout goto at ".concat(e)))}),t),l=function(e,t){t.url!==s.ABOUT_BLANK_URL&&(r(),d())},d=function(){clearTimeout(u),chrome.tabs.onUpdated.removeListener(l)};chrome.tabs.update(n,{url:e},(function(){chrome.tabs.onUpdated.addListener(l)}))}))}},{key:"screenshot",value:function(e){return Promise.resolve(Object.assign(Object.assign({},e),{error:"Not yet implemented"}))}}])&&r(t.prototype,n),l&&r(t,l),e}();t.BrowserTab=l},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.temporarilySuspendDashlaneOnDomains=void 0;var a=n(11);t.temporarilySuspendDashlaneOnDomains=function(e){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,s,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],o=r(e),t.prev=2,o.s();case 4:if((s=o.n()).done){t.next=14;break}return u=s.value,t.next=8,a.carbon().askWebsiteInfo({fullUrl:u});case 8:return c=t.sent,n.push({url:u,autofill:!c.disabledAutofillOnDomain,autologin:!c.disabledAutologinOnDomain}),t.next=12,a.carbon().toggleDashlaneOnSite({url:u,autofill:!1,autologin:!1});case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(2),o.e(t.t0);case 19:return t.prev=19,o.f(),t.finish(19);case 22:return t.abrupt("return",(function(){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r(n),e.prev=1,t.s();case 3:if((o=t.n()).done){e.next=9;break}return i=o.value,e.next=7,a.carbon().toggleDashlaneOnSite(i);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))}));case 23:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDisplayPaymentFailureNotification=t.isDismissedForOneDay=void 0;var o=n(113),i=n(40),a=n(11),s=function(e){if(void 0!==e){var t=(n=e,(r=new Date(0)).setUTCSeconds(n),r.getTime());return t-Date.now()<6048e5&&t-Date.now()>0}var n,r;return!1};t.isDismissedForOneDay=function(e){return Date.now()-e>864e5};t.shouldDisplayPaymentFailureNotification=function(e){var n=e.hasPaymentFailure,u=e.paymentFailureChurningAlertDismissDate,c=e.premiumEndDate,l=e.premiumStatusCode;return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,a.extensionCarbonConnector.getNotificationStatus(null);case 4:if(r=e.sent,l!==i.PremiumStatusCode.PREMIUM_CANCELLED&&l!==i.PremiumStatusCode.PREMIUM||!s(c)){e.next=11;break}if(r.paymentFailureChurning===o.NotificationStatus.Interacted){e.next=10;break}return e.abrupt("return",!0);case 10:return e.abrupt("return","number"==typeof u&&t.isDismissedForOneDay(u));case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeLeelooRedirectionHandler=t.shouldRedirectLeelooUrl=t.makeExternalLeelooPatterns=t.makeInternalLeelooPatterns=void 0;var r=n(159),o=n(1);function i(e){return"string"==typeof e&&!e.includes("noredirect")}t.makeInternalLeelooPatterns=function(){return["credentials/*","darkweb-monitoring","login","onboarding/*","password-health/*","payments/*","personal-info/*","premium-plus","secure-notes/*","signup","sso?*"].map((function(e){return chrome.runtime.getURL(e)}))},t.makeExternalLeelooPatterns=function(){return["https://app.dashlane.com/*"]},t.shouldRedirectLeelooUrl=i,t.makeLeelooRedirectionHandler=function(){return function(e){if(!chrome.runtime.lastError)return i(e.url)?function(e){var t={active:!0,url:r.makeExtensionUrl(e.url)};return chrome.tabs.update(e.tabId,t,(function(){if(chrome.runtime.lastError){var e=chrome.runtime.lastError,t=(void 0===e?{}:e).message,n=void 0===t?"Unknown error":t;o.default({code:o.ExceptionCode.Error,fileName:"ChromeExtension/background/controller/redirection.ts",funcName:"redirectToLeeloo",message:"Problem updating tab: ".concat(n)})}else;})),{}}(e):{};var t=chrome.runtime.lastError,n=(void 0===t?{}:t).message,a=void 0===n?"Unknown error":n;o.default({code:o.ExceptionCode.Error,fileName:"ChromeExtension/background/controller/redirection.ts",funcName:"makeLeelooRedirectionHandler",message:"Problem setting webRequest.onBeforeRequest listener: ".concat(a)})}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(324),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){return o(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"getBinaryAssetAsBase64",value:function(e){if(!e)throw new Error("No asset name provided");return new Promise((function(t,n){var r=new XMLHttpRequest;r.open("GET",chrome.runtime.getURL(e),!0),r.responseType="arraybuffer",r.onload=function(){if(200===r.status){for(var e=new Uint8Array(r.response),n=e.length,o=new Array(n);n--;)o[n]=String.fromCharCode(e[n]);var i=o.join("");t(window.btoa(i))}},r.onerror=function(){return n(new Error("An error occured while loading asset ".concat(e)))},r.send()}))}}])&&i(t.prototype,n),r&&i(t,r),c}(l.AssetsController);t.default=function(){return l.setInstance(new d)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeController=void 0;var l=n(10),d=n(395),f=n(396),p=n(1028),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,n,r,u=s(c);function c(){var e;return o(this,c),(e=u.apply(this,arguments))._eventBus=void 0,e.postCheckVisibilityResponseMessage=function(t){var n;return null===(n=e._eventBus)||void 0===n?void 0:n.checkVisibilityResponse(t)},e.postInitialStateResponseMessage=function(t){var n;return null===(n=e._eventBus)||void 0===n?void 0:n.initialStateResponse(t)},e.postCloseWebcardMessage=function(t){var n;return null===(n=e._eventBus)||void 0===n?void 0:n.closeWebcard(t)},e.postUpdateStateMessage=function(t){var n;return null===(n=e._eventBus)||void 0===n?void 0:n.updateState(t)},e}return t=c,(n=[{key:"createEventBusForWebui",value:function(e){return l.createEventBus({events:p.ExtensionWebcardsConnector,channels:[new f.PortInstanceChannel(e)]})}},{key:"initCommunication",value:function(e){var t=this;this._eventBus=e,this._eventBus.initialStateRequest.on((function(){t.onInitialStateRequest()})),this._eventBus.checkVisibilityRequest.on((function(e){t.onCheckVisibility(e)})),this._eventBus.webcardClosed.on((function(){t.onWebcardClosed()})),this._eventBus.sendWebcardOutcome.on((function(e){t.onSendWebcardOutcome(e)})),this._eventBus.sendUsageLog.on((function(e){t.onSendUsageLog(e)})),this._eventBus.signalGeometry.on((function(e){t.onSignalGeometry(e)})),this._eventBus.stateChanged.on((function(e){t.onStateChanged(e)}))}}])&&i(t.prototype,n),r&&i(t,r),c}(d.WebUIController);t.ChromeController=g,d.setFactory(g)}]);